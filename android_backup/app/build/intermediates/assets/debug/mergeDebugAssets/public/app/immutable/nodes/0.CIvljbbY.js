import{c as w,a as m,t as S}from"../chunks/CGUOcUo0.js";import{i as k}from"../chunks/Dt1eVU8n.js";import{p as _,o as l,f as y,a as O,n as W}from"../chunks/CVH_N3Bp.js";import{h as N}from"../chunks/D1I8qkeV.js";import{s as R,p as A}from"../chunks/CxY14L4Y.js";import{s as x,a as C}from"../chunks/mJBMWFaA.js";import{l as P,a as j,h as B}from"../chunks/CKXrGhkk.js";import"../chunks/ChpRqV9_.js";import{g as a}from"../chunks/DF6Fe3K5.js";import{g as E}from"../chunks/BSGaGtWC.js";const I=!0,M=I;var T=S('<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover"> <meta name="theme-color" content="#4D44B3"> <link rel="manifest" href="/manifest.json"> <link rel="apple-touch-icon" href="/icons/192x192-icon.png">',1);function U(u,n){_(n,!1);const[f,p]=x(),g=()=>C(A,"$page",f),d=async()=>{if("serviceWorker"in navigator)try{const t=await navigator.serviceWorker.register("/sw.js");console.log("ServiceWorker registration successful with scope:",t.scope)}catch(t){console.error("ServiceWorker registration failed:",t)}};l(async()=>{await d(),P();const t=j.subscribe(async e=>{if(e.loading)return;const o=g().url.pathname,r=o==="/login"||o==="/signup"||o==="/forgot-password",c=o==="/onboarding",h=o==="/notification-permission";if(!e.user&&!r){a("/login");return}if(e.user){let i=localStorage.getItem("onboarding_completed")==="true";if(i||(i=await B(e.user.uid),i&&M&&localStorage.setItem("onboarding_completed","true")),!i&&!c&&!r){a("/onboarding");return}if(i){const v=await E();(r||c)&&(v==="default"&&!h?a("/notification-permission"):a("/home"))}}});return()=>t()}),l(()=>{const t=document.documentElement,e=new MutationObserver(()=>{if(t.hasAttribute("data-theme")){const r=t.getAttribute("data-theme");document.body.className=r||""}});e.observe(t,{attributes:!0,attributeFilter:["data-theme"]});const o=t.getAttribute("data-theme");return o&&(document.body.className=o),()=>e.disconnect()}),k();var s=w();N(t=>{var e=T();W(6),m(t,e)});var b=y(s);R(b,n,"default",{}),m(u,s),O(),p()}export{U as component};
