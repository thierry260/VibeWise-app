import{c as W,a as D,t as H}from"./B1TZXfti.js";import"./VBNCskEB.js";import{p as O,s as C,ac as Y,b as z,m as A,g as e,c as a,e as u,r,t as F}from"./CDb6m0PD.js";import{s as y,e as w}from"./CxWVBdvW.js";import{i as J}from"./Dm4goCkW.js";import{t as I,f as K,a as N}from"./DptaK6WB.js";import{i as U}from"./CGS7UL4d.js";import{p as X}from"./BP3oUo1A.js";import{s as Z,a as tt}from"./CbuS4uut.js";import{w as et,a as ot}from"./BOa5fj8P.js";import{g as st}from"./DXN4q5X4.js";import{x as it,n as at,l as $,k as rt,m as nt,a as lt}from"./3OU4Vcau.js";const L=[{id:"breath-1",title:"6-2-8 Breathing",type:"app",description:"A short breathing technique to calm your system.",actionLabel:"Start Breathing",route:"/library/breathing-628"},{id:"quote-1",title:"You Are Already Whole",type:"app",description:"Quote to reflect on.",actionLabel:"Read Quote",route:"/library/quote-1"},{id:"journal-prompt-1",title:"Prompt: What am I avoiding?",type:"app",description:"A journaling insight to deepen your awareness.",actionLabel:"Go to Prompt",route:"/library/prompt-1"}],V={isVisible:!1,selectedTool:null},ct=()=>{const{subscribe:l,set:s,update:n}=et(V);return{subscribe:l,showRandomTool:()=>{const i=Math.floor(Math.random()*L.length),o=L[i];return n(d=>({isVisible:!0,selectedTool:o})),o},hide:()=>{n(i=>({...i,isVisible:!1}))},reset:()=>s(V),logToolInteraction:async(i,o,d)=>{try{if(!i)return;const t={toolId:o,action:d,timestamp:new Date().toISOString()};return await it(at($,"users",i.uid,"tools","logs"),t),{success:!0}}catch(t){return console.error("Error logging tool interaction:",t),{success:!1,error:t}}}}},m=ct(),kt=async l=>{try{if(!l)return!1;const s=rt($,"users",l.uid,"private","settings"),n=await nt(s);return n.exists()?n.data().divine_timing_enabled===!0:!0}catch(s){return console.error("Error checking divine timing setting:",s),!0}};var dt=H('<div class="divine-tool-overlay svelte-1540pma"><div class="divine-tool-modal bg-white shadow-md dark:bg-gray-800 svelte-1540pma"><div class="modal-header svelte-1540pma"><h3 class="svelte-1540pma">âœ¨ A tool chose you</h3> <button class="close-button svelte-1540pma" aria-label="Close"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg></button></div> <div class="tool-content svelte-1540pma"><h2 class="svelte-1540pma"> </h2> <p class="svelte-1540pma"> </p> <div class="action-buttons svelte-1540pma"><button class="action-button svelte-1540pma"> </button> <button class="dismiss-button svelte-1540pma">Go to History</button></div></div></div></div>');function Tt(l,s){O(s,!1);const[n,i]=Z(),o=()=>tt(lt,"$authStore",n);let d=X(s,"onClose",8,()=>{}),t=A(null),_=A(!1);const j=m.subscribe(c=>{C(_,c.isVisible),C(t,c.selectedTool)});async function q(){e(t)&&(o().user&&await m.logToolInteraction(o().user,e(t).id,"clicked"),m.hide(),d()(),st(e(t).route))}async function x(){e(t)&&o().user&&await m.logToolInteraction(o().user,e(t).id,"dismissed"),m.hide(),d()()}ot(()=>{j()}),U();var k=W(),B=Y(k);{var E=c=>{var p=dt(),b=a(p),h=a(b),R=u(a(h),2);r(h);var T=u(h,2),g=a(T),G=a(g,!0);r(g);var f=u(g,2),M=a(f,!0);r(f);var S=u(f,2),v=a(S),P=a(v,!0);r(v);var Q=u(v,2);r(S),r(T),r(b),r(p),F(()=>{y(G,e(t).title),y(M,e(t).description),y(P,e(t).actionLabel)}),w("click",R,x),w("click",v,q),w("click",Q,x),I(3,b,()=>K,()=>({y:100,duration:300})),I(3,p,()=>N,()=>({duration:200})),D(c,p)};J(B,c=>{e(_)&&e(t)&&c(E)})}D(l,k),z(),i()}export{Tt as D,m as d,kt as i};
