import{c as W,a as S,t as H}from"./DwZKRegf.js";import"./B4OBRiys.js";import{p as O,s as D,f as Y,a as z,m as C,g as e,c as i,b as u,r as a,t as F}from"./BfLd7xIT.js";import{s as y,e as k}from"./D2q-kWfj.js";import{i as J}from"./CNGqELc8.js";import{t as A,a as K,f as N}from"./miMAxrrq.js";import{i as U}from"./DsaIGbBj.js";import{p as X}from"./VC9gmQBp.js";import{s as Z,a as tt}from"./Dfb5LgfT.js";import{w as et,a as ot}from"./BtKD0jUe.js";import{g as st}from"./CRbbwQ-c.js";import{d as rt,e as it,f as V,g as at,h as nt,a as lt}from"./DuaF19nW.js";const I=[{id:"breath-1",title:"6-2-8 Breathing",type:"app",description:"A short breathing technique to calm your system.",actionLabel:"Start Breathing",route:"/library/breathing-628"},{id:"quote-1",title:"You Are Already Whole",type:"app",description:"Quote to reflect on.",actionLabel:"Read Quote",route:"/library/quote-1"},{id:"journal-prompt-1",title:"Prompt: What am I avoiding?",type:"app",description:"A journaling insight to deepen your awareness.",actionLabel:"Go to Prompt",route:"/library/prompt-1"}],L={isVisible:!1,selectedTool:null},ct=()=>{const{subscribe:l,set:s,update:n}=et(L);return{subscribe:l,showRandomTool:()=>{const r=Math.floor(Math.random()*I.length),o=I[r];return n(d=>({isVisible:!0,selectedTool:o})),o},hide:()=>{n(r=>({...r,isVisible:!1}))},reset:()=>s(L),logToolInteraction:async(r,o,d)=>{try{if(!r)return;const t={toolId:o,action:d,timestamp:new Date().toISOString()};return await rt(it(V,"users",r.uid,"tools","logs"),t),{success:!0}}catch(t){return console.error("Error logging tool interaction:",t),{success:!1,error:t}}}}},v=ct(),qt=async l=>{try{if(!l)return!1;const s=at(V,"users",l.uid,"private","settings"),n=await nt(s);return n.exists()?n.data().divine_timing_enabled===!0:!0}catch(s){return console.error("Error checking divine timing setting:",s),!0}};var dt=H('<div class="divine-tool-overlay svelte-rlkg7q"><div class="divine-tool-modal bg-white shadow-md dark:bg-gray-800 svelte-rlkg7q"><div class="modal-header svelte-rlkg7q"><h3 class="svelte-rlkg7q">âœ¨ A tool chose you</h3> <button class="close-button svelte-rlkg7q" aria-label="Close"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg></button></div> <div class="tool-content svelte-rlkg7q"><h2 class="svelte-rlkg7q"> </h2> <p class="svelte-rlkg7q"> </p> <div class="action-buttons svelte-rlkg7q"><button class="action-button svelte-rlkg7q"> </button> <button class="dismiss-button svelte-rlkg7q">Go to History</button></div></div></div></div>');function xt(l,s){O(s,!1);const[n,r]=Z(),o=()=>tt(lt,"$authStore",n);let d=X(s,"onClose",8,()=>{}),t=C(null),w=C(!1);const $=v.subscribe(c=>{D(w,c.isVisible),D(t,c.selectedTool)});async function j(){e(t)&&(o().user&&await v.logToolInteraction(o().user,e(t).id,"clicked"),v.hide(),d()(),st(e(t).route))}async function _(){e(t)&&o().user&&await v.logToolInteraction(o().user,e(t).id,"dismissed"),v.hide(),d()()}ot(()=>{$()}),U();var q=W(),B=Y(q);{var E=c=>{var g=dt(),m=i(g),h=i(m),R=u(i(h),2);a(h);var x=u(h,2),b=i(x),G=i(b,!0);a(b);var f=u(b,2),M=i(f,!0);a(f);var T=u(f,2),p=i(T),P=i(p,!0);a(p);var Q=u(p,2);a(T),a(x),a(m),a(g),F(()=>{y(G,e(t).title),y(M,e(t).description),y(P,e(t).actionLabel)}),k("click",R,_),k("click",p,j),k("click",Q,_),A(3,m,()=>K,()=>({y:100,duration:300})),A(3,g,()=>N,()=>({duration:200})),S(c,g)};J(B,c=>{e(w)&&e(t)&&c(E)})}S(l,q),z(),r()}export{xt as D,v as d,qt as i};
