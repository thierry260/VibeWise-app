import{t as vl,a as Ut,b as ss}from"../chunks/CBOLqkOR.js";import{i as Do}from"../chunks/DYliPJ25.js";import{h as Si,Z as Ms,X as ms,p as To,o as Mo,as as Eo,af as Ao,ag as Po,b as Lo,g as X,m as Vt,e as _e,c as ue,r as fe,s as Ce,n as is,t as gn,d as wi}from"../chunks/Gd2MJtJw.js";import{e as vn,s as xt}from"../chunks/6F2tKI9t.js";import{i as ul}from"../chunks/DEjGzwbK.js";import{t as Ro,s as Co}from"../chunks/C1Vzq84y.js";import{b as Vo}from"../chunks/C9yVFITH.js";import{s as zo,a as yn}from"../chunks/7oYGK_Th.js";import{g as _i}from"../chunks/odb1_Vw7.js";import{a as Fo}from"../chunks/BPWvYGMB.js";import{e as Ho}from"../chunks/x9z02Rao.js";function Io(e,l,i,n){var r=e.__style;if(Si||r!==l){var c=Ro(l);(!Si||c!==e.getAttribute("style"))&&(c==null?e.removeAttribute("style"):e.style.cssText=c),e.__style=l}return n}const pl=Ms({connected:!1,deviceName:"",deviceId:"",error:null,scanning:!1}),Tn=Ms({heartRate:0,rmssd:0,vibeScore:0,rrIntervals:[],chartData:[]}),Hl=Ms({startTime:0,currentTime:0,elapsedSeconds:0,isRunning:!1}),ds=()=>typeof navigator<"u"&&"bluetooth"in navigator,No=async()=>{var e;try{if(!ds())throw new Error("Web Bluetooth is not supported in this browser");pl.update(c=>({...c,scanning:!0,error:null}));const l=await navigator.bluetooth.requestDevice({filters:[{services:["heart_rate"]},{namePrefix:"Polar"}],optionalServices:["heart_rate"]});pl.update(c=>({...c,deviceName:l.name||"Unknown Device",deviceId:l.id}));const i=await((e=l.gatt)==null?void 0:e.connect());if(!i)throw new Error("Failed to connect to GATT server");const r=await(await i.getPrimaryService("heart_rate")).getCharacteristic("heart_rate_measurement");return await r.startNotifications(),r.addEventListener("characteristicvaluechanged",Oo),pl.update(c=>({...c,connected:!0,scanning:!1})),l.addEventListener("gattserverdisconnected",()=>{pl.update(u=>({...u,connected:!1,error:new Error("Device disconnected")})),ms(Hl).isRunning&&Es()}),{success:!0}}catch(l){return console.error("BLE scan error:",l),pl.update(i=>({...i,scanning:!1,error:l instanceof Error?l:new Error("Unknown BLE error")})),{success:!1,error:l instanceof Error?l:new Error("Unknown BLE error")}}},Oo=e=>{const l=e.target.value;if(!l)return;const i=l.getUint8(0),n=i&1,r=n?l.getUint16(1,!0):l.getUint8(1),c=[];if(i&16){const u=n?3:2;for(let h=u;h<l.byteLength;h+=2){const p=l.getUint16(h,!0)/1024*1e3;c.push(p)}}Wo(r,c)},Wo=(e,l)=>{Tn.update(i=>{const r=[...i.rrIntervals,...l].slice(-64);let c=0;if(r.length>1){let g=0;for(let v=1;v<r.length;v++){const P=r[v]-r[v-1];g+=P*P}c=Math.sqrt(g/(r.length-1))}const u=Math.min(100,Math.max(0,c/100*100)),h=Math.round(u),p=new Date().toISOString(),S=[...i.chartData,{timestamp:p,hr:e,rmssd:c,vibe:h}].slice(-300);return{heartRate:e,rmssd:c,vibeScore:h,rrIntervals:r,chartData:S}})},rs=async()=>{try{return pl.set({connected:!1,deviceName:"",deviceId:"",error:null,scanning:!1}),gs(),Es(),{success:!0}}catch(e){return console.error("BLE disconnect error:",e),{success:!1,error:e instanceof Error?e:new Error("Unknown BLE error")}}},gs=()=>{Tn.set({heartRate:0,rmssd:0,vibeScore:0,rrIntervals:[],chartData:[]})},Bo=()=>{const e=Date.now();Hl.set({startTime:e,currentTime:e,elapsedSeconds:0,isRunning:!0});const l=setInterval(()=>{Hl.update(i=>{if(!i.isRunning)return clearInterval(l),i;const n=Date.now(),r=Math.floor((n-i.startTime)/1e3);return{...i,currentTime:n,elapsedSeconds:r}})},1e3)},Es=()=>{Hl.update(e=>({...e,isRunning:!1}))},Go=()=>{const e=ms(Tn),l=ms(Hl),i=e.chartData;let n=0,r=0,c=0;i.forEach(m=>{n+=m.hr,r+=m.rmssd,c+=m.vibe});const u=i.length?Math.round(n/i.length):0,h=i.length?Math.round(r/i.length*10)/10:0,p=i.length?Math.round(c/i.length):0;return{startTime:new Date(l.startTime).toISOString(),endTime:new Date(l.currentTime).toISOString(),durationSeconds:l.elapsedSeconds,avgHR:u,avgRMSSD:h,avgVibe:p,chartData:i,rrIntervals:e.rrIntervals}},Uo=!0,Ne="u-",Yo="uplot",$o=Ne+"hz",Ko=Ne+"vt",jo=Ne+"title",qo=Ne+"wrap",Jo=Ne+"under",Zo=Ne+"over",Qo=Ne+"axis",ml=Ne+"off",Xo=Ne+"select",ea=Ne+"cursor-x",ta=Ne+"cursor-y",la=Ne+"cursor-pt",na=Ne+"legend",sa=Ne+"live",ia=Ne+"inline",ra=Ne+"series",oa=Ne+"marker",bi=Ne+"label",aa=Ne+"value",en="width",tn="height",Ql="top",xi="bottom",Vl="left",os="right",As="#000",ki=As+"0",as="mousemove",Di="mousedown",cs="mouseup",Ti="mouseenter",Mi="mouseleave",Ei="dblclick",ca="resize",ua="scroll",Ai="change",xn="dppxchange",Ps="--",Bl=typeof window<"u",vs=Bl?document:null,Fl=Bl?window:null,fa=Bl?navigator:null;let me,Sn;function ys(){let e=devicePixelRatio;me!=e&&(me=e,Sn&&ws(Ai,Sn,ys),Sn=matchMedia(`(min-resolution: ${me-.001}dppx) and (max-resolution: ${me+.001}dppx)`),dl(Ai,Sn,ys),Fl.dispatchEvent(new CustomEvent(xn)))}function ht(e,l){if(l!=null){let i=e.classList;!i.contains(l)&&i.add(l)}}function Ss(e,l){let i=e.classList;i.contains(l)&&i.remove(l)}function Te(e,l,i){e.style[l]=i+"px"}function zt(e,l,i,n){let r=vs.createElement(e);return l!=null&&ht(r,l),i!=null&&i.insertBefore(r,n),r}function kt(e,l){return zt("div",e,l)}const Pi=new WeakMap;function Yt(e,l,i,n,r){let c="translate("+l+"px,"+i+"px)",u=Pi.get(e);c!=u&&(e.style.transform=c,Pi.set(e,c),l<0||i<0||l>n||i>r?ht(e,ml):Ss(e,ml))}const Li=new WeakMap;function Ri(e,l,i){let n=l+i,r=Li.get(e);n!=r&&(Li.set(e,n),e.style.background=l,e.style.borderColor=i)}const Ci=new WeakMap;function Vi(e,l,i,n){let r=l+""+i,c=Ci.get(e);r!=c&&(Ci.set(e,r),e.style.height=i+"px",e.style.width=l+"px",e.style.marginLeft=n?-l/2+"px":0,e.style.marginTop=n?-i/2+"px":0)}const Ls={passive:!0},ha={...Ls,capture:!0};function dl(e,l,i,n){l.addEventListener(e,i,n?ha:Ls)}function ws(e,l,i,n){l.removeEventListener(e,i,Ls)}Bl&&ys();function Ft(e,l,i,n){let r;i=i||0,n=n||l.length-1;let c=n<=2147483647;for(;n-i>1;)r=c?i+n>>1:pt((i+n)/2),l[r]<e?i=r:n=r;return e-l[i]<=l[n]-e?i:n}function ar(e){return(i,n,r)=>{let c=-1,u=-1;for(let h=n;h<=r;h++)if(e(i[h])){c=h;break}for(let h=r;h>=n;h--)if(e(i[h])){u=h;break}return[c,u]}}const cr=e=>e!=null,ur=e=>e!=null&&e>0,Mn=ar(cr),pa=ar(ur);function ma(e,l,i,n=0,r=!1){let c=r?pa:Mn,u=r?ur:cr;[l,i]=c(e,l,i);let h=e[l],p=e[l];if(l>-1)if(n==1)h=e[l],p=e[i];else if(n==-1)h=e[i],p=e[l];else for(let m=l;m<=i;m++){let S=e[m];u(S)&&(S<h?h=S:S>p&&(p=S))}return[h??Se,p??-Se]}function En(e,l,i,n){let r=Hi(e),c=Hi(l);e==l&&(r==-1?(e*=i,l/=i):(e/=i,l*=i));let u=i==10?Kt:fr,h=r==1?pt:Dt,p=c==1?Dt:pt,m=h(u(Ie(e))),S=p(u(Ie(l))),g=Il(i,m),v=Il(i,S);return i==10&&(m<0&&(g=we(g,-m)),S<0&&(v=we(v,-S))),n||i==2?(e=g*r,l=v*c):(e=dr(e,g),l=An(l,v)),[e,l]}function Rs(e,l,i,n){let r=En(e,l,i,n);return e==0&&(r[0]=0),l==0&&(r[1]=0),r}const Cs=.1,zi={mode:3,pad:Cs},nn={pad:0,soft:null,mode:0},da={min:nn,max:nn};function kn(e,l,i,n){return Pn(i)?Fi(e,l,i):(nn.pad=i,nn.soft=n?0:null,nn.mode=n?3:0,Fi(e,l,da))}function he(e,l){return e??l}function ga(e,l,i){for(l=he(l,0),i=he(i,e.length-1);l<=i;){if(e[l]!=null)return!0;l++}return!1}function Fi(e,l,i){let n=i.min,r=i.max,c=he(n.pad,0),u=he(r.pad,0),h=he(n.hard,-Se),p=he(r.hard,Se),m=he(n.soft,Se),S=he(r.soft,-Se),g=he(n.mode,0),v=he(r.mode,0),P=l-e,L=Kt(P),E=nt(Ie(e),Ie(l)),W=Kt(E),U=Ie(W-L);(P<1e-24||U>10)&&(P=0,(e==0||l==0)&&(P=1e-24,g==2&&m!=Se&&(c=0),v==2&&S!=-Se&&(u=0)));let _=P||E||1e3,H=Kt(_),x=Il(10,pt(H)),ee=_*(P==0?e==0?.1:1:c),R=we(dr(e-ee,x/10),24),te=e>=m&&(g==1||g==3&&R<=m||g==2&&R>=m)?m:Se,J=nt(h,R<te&&e>=te?te:Ht(te,R)),ne=_*(P==0?l==0?.1:1:u),j=we(An(l+ne,x/10),24),k=l<=S&&(v==1||v==3&&j>=S||v==2&&j<=S)?S:-Se,Q=Ht(p,j>k&&l<=k?k:nt(k,j));return J==Q&&J==0&&(Q=100),[J,Q]}const va=new Intl.NumberFormat(Bl?fa.language:"en-US"),Vs=e=>va.format(e),mt=Math,bn=mt.PI,Ie=mt.abs,pt=mt.floor,He=mt.round,Dt=mt.ceil,Ht=mt.min,nt=mt.max,Il=mt.pow,Hi=mt.sign,Kt=mt.log10,fr=mt.log2,ya=(e,l=1)=>mt.sinh(e)*l,us=(e,l=1)=>mt.asinh(e/l),Se=1/0;function Ii(e){return(Kt((e^e>>31)-(e>>31))|0)+1}function _s(e,l,i){return Ht(nt(e,l),i)}function hr(e){return typeof e=="function"}function oe(e){return hr(e)?e:()=>e}const Sa=()=>{},pr=e=>e,mr=(e,l)=>l,wa=e=>null,Ni=e=>!0,Oi=(e,l)=>e==l,_a=/\.\d*?(?=9{6,}|0{6,})/gm,gl=e=>{if(vr(e)||tl.has(e))return e;const l=`${e}`,i=l.match(_a);if(i==null)return e;let n=i[0].length-1;if(l.indexOf("e-")!=-1){let[r,c]=l.split("e");return+`${gl(r)}e${c}`}return we(e,n)};function fl(e,l){return gl(we(gl(e/l))*l)}function An(e,l){return gl(Dt(gl(e/l))*l)}function dr(e,l){return gl(pt(gl(e/l))*l)}function we(e,l=0){if(vr(e))return e;let i=10**l,n=e*i*(1+Number.EPSILON);return He(n)/i}const tl=new Map;function gr(e){return((""+e).split(".")[1]||"").length}function rn(e,l,i,n){let r=[],c=n.map(gr);for(let u=l;u<i;u++){let h=Ie(u),p=we(Il(e,u),h);for(let m=0;m<n.length;m++){let S=e==10?+`${n[m]}e${u}`:n[m]*p,g=(u>=0?0:h)+(u>=c[m]?0:c[m]),v=e==10?S:we(S,g);r.push(v),tl.set(v,g)}}return r}const sn={},zs=[],Nl=[null,null],el=Array.isArray,vr=Number.isInteger,ba=e=>e===void 0;function Wi(e){return typeof e=="string"}function Pn(e){let l=!1;if(e!=null){let i=e.constructor;l=i==null||i==Object}return l}function xa(e){return e!=null&&typeof e=="object"}const ka=Object.getPrototypeOf(Uint8Array),yr="__proto__";function Ol(e,l=Pn){let i;if(el(e)){let n=e.find(r=>r!=null);if(el(n)||l(n)){i=Array(e.length);for(let r=0;r<e.length;r++)i[r]=Ol(e[r],l)}else i=e.slice()}else if(e instanceof ka)i=e.slice();else if(l(e)){i={};for(let n in e)n!=yr&&(i[n]=Ol(e[n],l))}else i=e;return i}function ze(e){let l=arguments;for(let i=1;i<l.length;i++){let n=l[i];for(let r in n)r!=yr&&(Pn(e[r])?ze(e[r],Ol(n[r])):e[r]=Ol(n[r]))}return e}const Da=0,Ta=1,Ma=2;function Ea(e,l,i){for(let n=0,r,c=-1;n<l.length;n++){let u=l[n];if(u>c){for(r=u-1;r>=0&&e[r]==null;)e[r--]=null;for(r=u+1;r<i&&e[r]==null;)e[c=r++]=null}}}function Aa(e,l){if(Ra(e)){let u=e[0].slice();for(let h=1;h<e.length;h++)u.push(...e[h].slice(1));return Ca(u[0])||(u=La(u)),u}let i=new Set;for(let u=0;u<e.length;u++){let p=e[u][0],m=p.length;for(let S=0;S<m;S++)i.add(p[S])}let n=[Array.from(i).sort((u,h)=>u-h)],r=n[0].length,c=new Map;for(let u=0;u<r;u++)c.set(n[0][u],u);for(let u=0;u<e.length;u++){let h=e[u],p=h[0];for(let m=1;m<h.length;m++){let S=h[m],g=Array(r).fill(void 0),v=l?l[u][m]:Ta,P=[];for(let L=0;L<S.length;L++){let E=S[L],W=c.get(p[L]);E===null?v!=Da&&(g[W]=E,v==Ma&&P.push(W)):g[W]=E}Ea(g,P,r),n.push(g)}}return n}const Pa=typeof queueMicrotask>"u"?e=>Promise.resolve().then(e):queueMicrotask;function La(e){let l=e[0],i=l.length,n=Array(i);for(let c=0;c<n.length;c++)n[c]=c;n.sort((c,u)=>l[c]-l[u]);let r=[];for(let c=0;c<e.length;c++){let u=e[c],h=Array(i);for(let p=0;p<i;p++)h[p]=u[n[p]];r.push(h)}return r}function Ra(e){let l=e[0][0],i=l.length;for(let n=1;n<e.length;n++){let r=e[n][0];if(r.length!=i)return!1;if(r!=l){for(let c=0;c<i;c++)if(r[c]!=l[c])return!1}}return!0}function Ca(e,l=100){const i=e.length;if(i<=1)return!0;let n=0,r=i-1;for(;n<=r&&e[n]==null;)n++;for(;r>=n&&e[r]==null;)r--;if(r<=n)return!0;const c=nt(1,pt((r-n+1)/l));for(let u=e[n],h=n+c;h<=r;h+=c){const p=e[h];if(p!=null){if(p<=u)return!1;u=p}}return!0}const Sr=["January","February","March","April","May","June","July","August","September","October","November","December"],wr=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];function _r(e){return e.slice(0,3)}const Va=wr.map(_r),za=Sr.map(_r),Fa={MMMM:Sr,MMM:za,WWWW:wr,WWW:Va};function Xl(e){return(e<10?"0":"")+e}function Ha(e){return(e<10?"00":e<100?"0":"")+e}const Ia={YYYY:e=>e.getFullYear(),YY:e=>(e.getFullYear()+"").slice(2),MMMM:(e,l)=>l.MMMM[e.getMonth()],MMM:(e,l)=>l.MMM[e.getMonth()],MM:e=>Xl(e.getMonth()+1),M:e=>e.getMonth()+1,DD:e=>Xl(e.getDate()),D:e=>e.getDate(),WWWW:(e,l)=>l.WWWW[e.getDay()],WWW:(e,l)=>l.WWW[e.getDay()],HH:e=>Xl(e.getHours()),H:e=>e.getHours(),h:e=>{let l=e.getHours();return l==0?12:l>12?l-12:l},AA:e=>e.getHours()>=12?"PM":"AM",aa:e=>e.getHours()>=12?"pm":"am",a:e=>e.getHours()>=12?"p":"a",mm:e=>Xl(e.getMinutes()),m:e=>e.getMinutes(),ss:e=>Xl(e.getSeconds()),s:e=>e.getSeconds(),fff:e=>Ha(e.getMilliseconds())};function Fs(e,l){l=l||Fa;let i=[],n=/\{([a-z]+)\}|[^{]+/gi,r;for(;r=n.exec(e);)i.push(r[0][0]=="{"?Ia[r[1]]:r[0]);return c=>{let u="";for(let h=0;h<i.length;h++)u+=typeof i[h]=="string"?i[h]:i[h](c,l);return u}}const Na=new Intl.DateTimeFormat().resolvedOptions().timeZone;function Oa(e,l){let i;return l=="UTC"||l=="Etc/UTC"?i=new Date(+e+e.getTimezoneOffset()*6e4):l==Na?i=e:(i=new Date(e.toLocaleString("en-US",{timeZone:l})),i.setMilliseconds(e.getMilliseconds())),i}const br=e=>e%1==0,Dn=[1,2,2.5,5],Wa=rn(10,-32,0,Dn),xr=rn(10,0,32,Dn),Ba=xr.filter(br),hl=Wa.concat(xr),Hs=`
`,kr="{YYYY}",Bi=Hs+kr,Dr="{M}/{D}",ln=Hs+Dr,wn=ln+"/{YY}",Tr="{aa}",Ga="{h}:{mm}",zl=Ga+Tr,Gi=Hs+zl,Ui=":{ss}",ge=null;function Mr(e){let l=e*1e3,i=l*60,n=i*60,r=n*24,c=r*30,u=r*365,p=(e==1?rn(10,0,3,Dn).filter(br):rn(10,-3,0,Dn)).concat([l,l*5,l*10,l*15,l*30,i,i*5,i*10,i*15,i*30,n,n*2,n*3,n*4,n*6,n*8,n*12,r,r*2,r*3,r*4,r*5,r*6,r*7,r*8,r*9,r*10,r*15,c,c*2,c*3,c*4,c*6,u,u*2,u*5,u*10,u*25,u*50,u*100]);const m=[[u,kr,ge,ge,ge,ge,ge,ge,1],[r*28,"{MMM}",Bi,ge,ge,ge,ge,ge,1],[r,Dr,Bi,ge,ge,ge,ge,ge,1],[n,"{h}"+Tr,wn,ge,ln,ge,ge,ge,1],[i,zl,wn,ge,ln,ge,ge,ge,1],[l,Ui,wn+" "+zl,ge,ln+" "+zl,ge,Gi,ge,1],[e,Ui+".{fff}",wn+" "+zl,ge,ln+" "+zl,ge,Gi,ge,1]];function S(g){return(v,P,L,E,W,U)=>{let _=[],H=W>=u,x=W>=c&&W<u,ee=g(L),R=we(ee*e,3),te=fs(ee.getFullYear(),H?0:ee.getMonth(),x||H?1:ee.getDate()),J=we(te*e,3);if(x||H){let ne=x?W/c:0,j=H?W/u:0,k=R==J?R:we(fs(te.getFullYear()+j,te.getMonth()+ne,1)*e,3),Q=new Date(He(k/e)),V=Q.getFullYear(),K=Q.getMonth();for(let B=0;k<=E;B++){let ie=fs(V+j*B,K+ne*B,1),N=ie-g(we(ie*e,3));k=we((+ie+N)*e,3),k<=E&&_.push(k)}}else{let ne=W>=r?r:W,j=pt(L)-pt(R),k=J+j+An(R-J,ne);_.push(k);let Q=g(k),V=Q.getHours()+Q.getMinutes()/i+Q.getSeconds()/n,K=W/n,B=v.axes[P]._space,ie=U/B;for(;k=we(k+W,e==1?0:3),!(k>E);)if(K>1){let N=pt(we(V+K,6))%24,F=g(k).getHours()-N;F>1&&(F=-1),k-=F*n,V=(V+K)%24;let Y=_[_.length-1];we((k-Y)/W,3)*ie>=.7&&_.push(k)}else _.push(k)}return _}}return[p,m,S]}const[Ua,Ya,$a]=Mr(1),[Ka,ja,qa]=Mr(.001);rn(2,-53,53,[1]);function Yi(e,l){return e.map(i=>i.map((n,r)=>r==0||r==8||n==null?n:l(r==1||i[8]==0?n:i[1]+n)))}function $i(e,l){return(i,n,r,c,u)=>{let h=l.find(L=>u>=L[0])||l[l.length-1],p,m,S,g,v,P;return n.map(L=>{let E=e(L),W=E.getFullYear(),U=E.getMonth(),_=E.getDate(),H=E.getHours(),x=E.getMinutes(),ee=E.getSeconds(),R=W!=p&&h[2]||U!=m&&h[3]||_!=S&&h[4]||H!=g&&h[5]||x!=v&&h[6]||ee!=P&&h[7]||h[1];return p=W,m=U,S=_,g=H,v=x,P=ee,R(E)})}}function Ja(e,l){let i=Fs(l);return(n,r,c,u,h)=>r.map(p=>i(e(p)))}function fs(e,l,i){return new Date(e,l,i)}function Ki(e,l){return l(e)}const Za="{YYYY}-{MM}-{DD} {h}:{mm}{aa}";function ji(e,l){return(i,n,r,c)=>c==null?Ps:l(e(n))}function Qa(e,l){let i=e.series[l];return i.width?i.stroke(e,l):i.points.width?i.points.stroke(e,l):null}function Xa(e,l){return e.series[l].fill(e,l)}const ec={show:!0,live:!0,isolate:!1,mount:Sa,markers:{show:!0,width:2,stroke:Qa,fill:Xa,dash:"solid"},idx:null,idxs:null,values:[]};function tc(e,l){let i=e.cursor.points,n=kt(),r=i.size(e,l);Te(n,en,r),Te(n,tn,r);let c=r/-2;Te(n,"marginLeft",c),Te(n,"marginTop",c);let u=i.width(e,l,r);return u&&Te(n,"borderWidth",u),n}function lc(e,l){let i=e.series[l].points;return i._fill||i._stroke}function nc(e,l){let i=e.series[l].points;return i._stroke||i._fill}function sc(e,l){return e.series[l].points.size}const hs=[0,0];function ic(e,l,i){return hs[0]=l,hs[1]=i,hs}function _n(e,l,i,n=!0){return r=>{r.button==0&&(!n||r.target==l)&&i(r)}}function ps(e,l,i,n=!0){return r=>{(!n||r.target==l)&&i(r)}}const rc={show:!0,x:!0,y:!0,lock:!1,move:ic,points:{one:!1,show:tc,size:sc,width:0,stroke:nc,fill:lc},bind:{mousedown:_n,mouseup:_n,click:_n,dblclick:_n,mousemove:ps,mouseleave:ps,mouseenter:ps},drag:{setScale:!0,x:!0,y:!1,dist:0,uni:null,click:(e,l)=>{l.stopPropagation(),l.stopImmediatePropagation()},_x:!1,_y:!1},focus:{dist:(e,l,i,n,r)=>n-r,prox:-1,bias:0},hover:{skip:[void 0],prox:null,bias:0},left:-10,top:-10,idx:null,dataIdx:null,idxs:null,event:null},Er={show:!0,stroke:"rgba(0,0,0,0.07)",width:2},Is=ze({},Er,{filter:mr}),Ar=ze({},Is,{size:10}),Pr=ze({},Er,{show:!1}),Ns='12px system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji"',Lr="bold "+Ns,Rr=1.5,qi={show:!0,scale:"x",stroke:As,space:50,gap:5,alignTo:1,size:50,labelGap:0,labelSize:30,labelFont:Lr,side:2,grid:Is,ticks:Ar,border:Pr,font:Ns,lineGap:Rr,rotate:0},oc="Value",ac="Time",Ji={show:!0,scale:"x",auto:!1,sorted:1,min:Se,max:-Se,idxs:[]};function cc(e,l,i,n,r){return l.map(c=>c==null?"":Vs(c))}function uc(e,l,i,n,r,c,u){let h=[],p=tl.get(r)||0;i=u?i:we(An(i,r),p);for(let m=i;m<=n;m=we(m+r,p))h.push(Object.is(m,-0)?0:m);return h}function bs(e,l,i,n,r,c,u){const h=[],p=e.scales[e.axes[l].scale].log,m=p==10?Kt:fr,S=pt(m(i));r=Il(p,S),p==10&&(r=hl[Ft(r,hl)]);let g=i,v=r*p;p==10&&(v=hl[Ft(v,hl)]);do h.push(g),g=g+r,p==10&&!tl.has(g)&&(g=we(g,tl.get(r))),g>=v&&(r=g,v=r*p,p==10&&(v=hl[Ft(v,hl)]));while(g<=n);return h}function fc(e,l,i,n,r,c,u){let p=e.scales[e.axes[l].scale].asinh,m=n>p?bs(e,l,nt(p,i),n,r):[p],S=n>=0&&i<=0?[0]:[];return(i<-p?bs(e,l,nt(p,-n),-i,r):[p]).reverse().map(v=>-v).concat(S,m)}const Cr=/./,hc=/[12357]/,pc=/[125]/,Zi=/1/,xs=(e,l,i,n)=>e.map((r,c)=>l==4&&r==0||c%n==0&&i.test(r.toExponential()[r<0?1:0])?r:null);function mc(e,l,i,n,r){let c=e.axes[i],u=c.scale,h=e.scales[u],p=e.valToPos,m=c._space,S=p(10,u),g=p(9,u)-S>=m?Cr:p(7,u)-S>=m?hc:p(5,u)-S>=m?pc:Zi;if(g==Zi){let v=Ie(p(1,u)-S);if(v<m)return xs(l.slice().reverse(),h.distr,g,Dt(m/v)).reverse()}return xs(l,h.distr,g,1)}function dc(e,l,i,n,r){let c=e.axes[i],u=c.scale,h=c._space,p=e.valToPos,m=Ie(p(1,u)-p(2,u));return m<h?xs(l.slice().reverse(),3,Cr,Dt(h/m)).reverse():l}function gc(e,l,i,n){return n==null?Ps:l==null?"":Vs(l)}const Qi={show:!0,scale:"y",stroke:As,space:30,gap:5,alignTo:1,size:50,labelGap:0,labelSize:30,labelFont:Lr,side:3,grid:Is,ticks:Ar,border:Pr,font:Ns,lineGap:Rr,rotate:0};function vc(e,l){let i=3+(e||1)*2;return we(i*l,3)}function yc(e,l){let{scale:i,idxs:n}=e.series[0],r=e._data[0],c=e.valToPos(r[n[0]],i,!0),u=e.valToPos(r[n[1]],i,!0),h=Ie(u-c),p=e.series[l],m=h/(p.points.space*me);return n[1]-n[0]<=m}const Xi={scale:null,auto:!0,sorted:0,min:Se,max:-Se},Vr=(e,l,i,n,r)=>r,er={show:!0,auto:!0,sorted:0,gaps:Vr,alpha:1,facets:[ze({},Xi,{scale:"x"}),ze({},Xi,{scale:"y"})]},tr={scale:"y",auto:!0,sorted:0,show:!0,spanGaps:!1,gaps:Vr,alpha:1,points:{show:yc,filter:null},values:null,min:Se,max:-Se,idxs:[],path:null,clip:null};function Sc(e,l,i,n,r){return i/10}const zr={time:Uo,auto:!0,distr:1,log:10,asinh:1,min:null,max:null,dir:1,ori:0},wc=ze({},zr,{time:!1,ori:1}),lr={};function Fr(e,l){let i=lr[e];return i||(i={key:e,plots:[],sub(n){i.plots.push(n)},unsub(n){i.plots=i.plots.filter(r=>r!=n)},pub(n,r,c,u,h,p,m){for(let S=0;S<i.plots.length;S++)i.plots[S]!=r&&i.plots[S].pub(n,r,c,u,h,p,m)}},e!=null&&(lr[e]=i)),i}const Wl=1,ks=2;function yl(e,l,i){const n=e.mode,r=e.series[l],c=n==2?e._data[l]:e._data,u=e.scales,h=e.bbox;let p=c[0],m=n==2?c[1]:c[l],S=n==2?u[r.facets[0].scale]:u[e.series[0].scale],g=n==2?u[r.facets[1].scale]:u[r.scale],v=h.left,P=h.top,L=h.width,E=h.height,W=e.valToPosH,U=e.valToPosV;return S.ori==0?i(r,p,m,S,g,W,U,v,P,L,E,Rn,Gl,Vn,Ir,Or):i(r,p,m,S,g,U,W,P,v,E,L,Cn,Ul,Bs,Nr,Wr)}function Os(e,l){let i=0,n=0,r=he(e.bands,zs);for(let c=0;c<r.length;c++){let u=r[c];u.series[0]==l?i=u.dir:u.series[1]==l&&(u.dir==1?n|=1:n|=2)}return[i,n==1?-1:n==2?1:n==3?2:0]}function _c(e,l,i,n,r){let c=e.mode,u=e.series[l],h=c==2?u.facets[1].scale:u.scale,p=e.scales[h];return r==-1?p.min:r==1?p.max:p.distr==3?p.dir==1?p.min:p.max:0}function jt(e,l,i,n,r,c){return yl(e,l,(u,h,p,m,S,g,v,P,L,E,W)=>{let U=u.pxRound;const _=m.dir*(m.ori==0?1:-1),H=m.ori==0?Gl:Ul;let x,ee;_==1?(x=i,ee=n):(x=n,ee=i);let R=U(g(h[x],m,E,P)),te=U(v(p[x],S,W,L)),J=U(g(h[ee],m,E,P)),ne=U(v(c==1?S.max:S.min,S,W,L)),j=new Path2D(r);return H(j,J,ne),H(j,R,ne),H(j,R,te),j})}function Ln(e,l,i,n,r,c){let u=null;if(e.length>0){u=new Path2D;const h=l==0?Vn:Bs;let p=i;for(let g=0;g<e.length;g++){let v=e[g];if(v[1]>v[0]){let P=v[0]-p;P>0&&h(u,p,n,P,n+c),p=v[1]}}let m=i+r-p,S=10;m>0&&h(u,p,n-S/2,m,n+c+S)}return u}function bc(e,l,i){let n=e[e.length-1];n&&n[0]==l?n[1]=i:e.push([l,i])}function Ws(e,l,i,n,r,c,u){let h=[],p=e.length;for(let m=r==1?i:n;m>=i&&m<=n;m+=r)if(l[m]===null){let g=m,v=m;if(r==1)for(;++m<=n&&l[m]===null;)v=m;else for(;--m>=i&&l[m]===null;)v=m;let P=c(e[g]),L=v==g?P:c(e[v]),E=g-r;P=u<=0&&E>=0&&E<p?c(e[E]):P;let U=v+r;L=u>=0&&U>=0&&U<p?c(e[U]):L,L>=P&&h.push([P,L])}return h}function nr(e){return e==0?pr:e==1?He:l=>fl(l,e)}function Hr(e){let l=e==0?Rn:Cn,i=e==0?(r,c,u,h,p,m)=>{r.arcTo(c,u,h,p,m)}:(r,c,u,h,p,m)=>{r.arcTo(u,c,p,h,m)},n=e==0?(r,c,u,h,p)=>{r.rect(c,u,h,p)}:(r,c,u,h,p)=>{r.rect(u,c,p,h)};return(r,c,u,h,p,m=0,S=0)=>{m==0&&S==0?n(r,c,u,h,p):(m=Ht(m,h/2,p/2),S=Ht(S,h/2,p/2),l(r,c+m,u),i(r,c+h,u,c+h,u+p,m),i(r,c+h,u+p,c,u+p,S),i(r,c,u+p,c,u,S),i(r,c,u,c+h,u,m),r.closePath())}}const Rn=(e,l,i)=>{e.moveTo(l,i)},Cn=(e,l,i)=>{e.moveTo(i,l)},Gl=(e,l,i)=>{e.lineTo(l,i)},Ul=(e,l,i)=>{e.lineTo(i,l)},Vn=Hr(0),Bs=Hr(1),Ir=(e,l,i,n,r,c)=>{e.arc(l,i,n,r,c)},Nr=(e,l,i,n,r,c)=>{e.arc(i,l,n,r,c)},Or=(e,l,i,n,r,c,u)=>{e.bezierCurveTo(l,i,n,r,c,u)},Wr=(e,l,i,n,r,c,u)=>{e.bezierCurveTo(i,l,r,n,u,c)};function Br(e){return(l,i,n,r,c)=>yl(l,i,(u,h,p,m,S,g,v,P,L,E,W)=>{let{pxRound:U,points:_}=u,H,x;m.ori==0?(H=Rn,x=Ir):(H=Cn,x=Nr);const ee=we(_.width*me,3);let R=(_.size-_.width)/2*me,te=we(R*2,3),J=new Path2D,ne=new Path2D,{left:j,top:k,width:Q,height:V}=l.bbox;Vn(ne,j-te,k-te,Q+te*2,V+te*2);const K=B=>{if(p[B]!=null){let ie=U(g(h[B],m,E,P)),N=U(v(p[B],S,W,L));H(J,ie+R,N),x(J,ie,N,R,0,bn*2)}};if(c)c.forEach(K);else for(let B=n;B<=r;B++)K(B);return{stroke:ee>0?J:null,fill:J,clip:ne,flags:Wl|ks}})}function Gr(e){return(l,i,n,r,c,u)=>{n!=r&&(c!=n&&u!=n&&e(l,i,n),c!=r&&u!=r&&e(l,i,r),e(l,i,u))}}const xc=Gr(Gl),kc=Gr(Ul);function Ur(e){const l=he(e==null?void 0:e.alignGaps,0);return(i,n,r,c)=>yl(i,n,(u,h,p,m,S,g,v,P,L,E,W)=>{[r,c]=Mn(p,r,c);let U=u.pxRound,_=V=>U(g(V,m,E,P)),H=V=>U(v(V,S,W,L)),x,ee;m.ori==0?(x=Gl,ee=xc):(x=Ul,ee=kc);const R=m.dir*(m.ori==0?1:-1),te={stroke:new Path2D,fill:null,clip:null,band:null,gaps:null,flags:Wl},J=te.stroke;let ne=!1;if(c-r>=E*4){let V=D=>i.posToVal(D,m.key,!0),K=null,B=null,ie,N,qe,I=_(h[R==1?r:c]),F=_(h[r]),Y=_(h[c]),z=V(R==1?F+1:Y-1);for(let D=R==1?r:c;D>=r&&D<=c;D+=R){let se=h[D],le=(R==1?se<z:se>z)?I:_(se),Z=p[D];le==I?Z!=null?(N=Z,K==null?(x(J,le,H(N)),ie=K=B=N):N<K?K=N:N>B&&(B=N)):Z===null&&(ne=!0):(K!=null&&ee(J,I,H(K),H(B),H(ie),H(N)),Z!=null?(N=Z,x(J,le,H(N)),K=B=ie=N):(K=B=null,Z===null&&(ne=!0)),I=le,z=V(I+R))}K!=null&&K!=B&&qe!=I&&ee(J,I,H(K),H(B),H(ie),H(N))}else for(let V=R==1?r:c;V>=r&&V<=c;V+=R){let K=p[V];K===null?ne=!0:K!=null&&x(J,_(h[V]),H(K))}let[k,Q]=Os(i,n);if(u.fill!=null||k!=0){let V=te.fill=new Path2D(J),K=u.fillTo(i,n,u.min,u.max,k),B=H(K),ie=_(h[r]),N=_(h[c]);R==-1&&([N,ie]=[ie,N]),x(V,N,B),x(V,ie,B)}if(!u.spanGaps){let V=[];ne&&V.push(...Ws(h,p,r,c,R,_,l)),te.gaps=V=u.gaps(i,n,r,c,V),te.clip=Ln(V,m.ori,P,L,E,W)}return Q!=0&&(te.band=Q==2?[jt(i,n,r,c,J,-1),jt(i,n,r,c,J,1)]:jt(i,n,r,c,J,Q)),te})}function Dc(e){const l=he(e.align,1),i=he(e.ascDesc,!1),n=he(e.alignGaps,0),r=he(e.extend,!1);return(c,u,h,p)=>yl(c,u,(m,S,g,v,P,L,E,W,U,_,H)=>{[h,p]=Mn(g,h,p);let x=m.pxRound,{left:ee,width:R}=c.bbox,te=F=>x(L(F,v,_,W)),J=F=>x(E(F,P,H,U)),ne=v.ori==0?Gl:Ul;const j={stroke:new Path2D,fill:null,clip:null,band:null,gaps:null,flags:Wl},k=j.stroke,Q=v.dir*(v.ori==0?1:-1);let V=J(g[Q==1?h:p]),K=te(S[Q==1?h:p]),B=K,ie=K;r&&l==-1&&(ie=ee,ne(k,ie,V)),ne(k,K,V);for(let F=Q==1?h:p;F>=h&&F<=p;F+=Q){let Y=g[F];if(Y==null)continue;let z=te(S[F]),D=J(Y);l==1?ne(k,z,V):ne(k,B,D),ne(k,z,D),V=D,B=z}let N=B;r&&l==1&&(N=ee+R,ne(k,N,V));let[qe,I]=Os(c,u);if(m.fill!=null||qe!=0){let F=j.fill=new Path2D(k),Y=m.fillTo(c,u,m.min,m.max,qe),z=J(Y);ne(F,N,z),ne(F,ie,z)}if(!m.spanGaps){let F=[];F.push(...Ws(S,g,h,p,Q,te,n));let Y=m.width*me/2,z=i||l==1?Y:-Y,D=i||l==-1?-Y:Y;F.forEach(se=>{se[0]+=z,se[1]+=D}),j.gaps=F=m.gaps(c,u,h,p,F),j.clip=Ln(F,v.ori,W,U,_,H)}return I!=0&&(j.band=I==2?[jt(c,u,h,p,k,-1),jt(c,u,h,p,k,1)]:jt(c,u,h,p,k,I)),j})}function sr(e,l,i,n,r,c,u=Se){if(e.length>1){let h=null;for(let p=0,m=1/0;p<e.length;p++)if(l[p]!==void 0){if(h!=null){let S=Ie(e[p]-e[h]);S<m&&(m=S,u=Ie(i(e[p],n,r,c)-i(e[h],n,r,c)))}h=p}}return u}function Tc(e){e=e||sn;const l=he(e.size,[.6,Se,1]),i=e.align||0,n=e.gap||0;let r=e.radius;r=r==null?[0,0]:typeof r=="number"?[r,0]:r;const c=oe(r),u=1-l[0],h=he(l[1],Se),p=he(l[2],1),m=he(e.disp,sn),S=he(e.each,P=>{}),{fill:g,stroke:v}=m;return(P,L,E,W)=>yl(P,L,(U,_,H,x,ee,R,te,J,ne,j,k)=>{let Q=U.pxRound,V=i,K=n*me,B=h*me,ie=p*me,N,qe;x.ori==0?[N,qe]=c(P,L):[qe,N]=c(P,L);const I=x.dir*(x.ori==0?1:-1);let F=x.ori==0?Vn:Bs,Y=x.ori==0?S:(T,ae,ve,vt,ll,It,nl)=>{S(T,ae,ve,ll,vt,nl,It)},z=he(P.bands,zs).find(T=>T.series[0]==L),D=z!=null?z.dir:0,se=U.fillTo(P,L,U.min,U.max,D),be=Q(te(se,ee,k,ne)),le,Z,$e,Le=j,de=Q(U.width*me),Qe=!1,st=null,Fe=null,ot=null,Tt=null;g!=null&&(de==0||v!=null)&&(Qe=!0,st=g.values(P,L,E,W),Fe=new Map,new Set(st).forEach(T=>{T!=null&&Fe.set(T,new Path2D)}),de>0&&(ot=v.values(P,L,E,W),Tt=new Map,new Set(ot).forEach(T=>{T!=null&&Tt.set(T,new Path2D)})));let{x0:Mt,size:Et}=m;if(Mt!=null&&Et!=null){V=1,_=Mt.values(P,L,E,W),Mt.unit==2&&(_=_.map(ve=>P.posToVal(J+ve*j,x.key,!0)));let T=Et.values(P,L,E,W);Et.unit==2?Z=T[0]*j:Z=R(T[0],x,j,J)-R(0,x,j,J),Le=sr(_,H,R,x,j,J,Le),$e=Le-Z+K}else Le=sr(_,H,R,x,j,J,Le),$e=Le*u+K,Z=Le-$e;$e<1&&($e=0),de>=Z/2&&(de=0),$e<5&&(Q=pr);let dt=$e>0,gt=Le-$e-(dt?de:0);Z=Q(_s(gt,ie,B)),le=(V==0?Z/2:V==I?0:Z)-V*I*((V==0?K/2:0)+(dt?de/2:0));const Re={stroke:null,fill:null,clip:null,band:null,gaps:null,flags:0},At=Qe?null:new Path2D;let Xe=null;if(z!=null)Xe=P.data[z.series[1]];else{let{y0:T,y1:ae}=m;T!=null&&ae!=null&&(H=ae.values(P,L,E,W),Xe=T.values(P,L,E,W))}let Ee=N*Z,G=qe*Z;for(let T=I==1?E:W;T>=E&&T<=W;T+=I){let ae=H[T];if(ae==null)continue;if(Xe!=null){let it=Xe[T]??0;if(ae-it==0)continue;be=te(it,ee,k,ne)}let ve=x.distr!=2||m!=null?_[T]:T,vt=R(ve,x,j,J),ll=te(he(ae,se),ee,k,ne),It=Q(vt-le),nl=Q(nt(ll,be)),at=Q(Ht(ll,be)),yt=nl-at;if(ae!=null){let it=ae<0?G:Ee,Pt=ae<0?Ee:G;Qe?(de>0&&ot[T]!=null&&F(Tt.get(ot[T]),It,at+pt(de/2),Z,nt(0,yt-de),it,Pt),st[T]!=null&&F(Fe.get(st[T]),It,at+pt(de/2),Z,nt(0,yt-de),it,Pt)):F(At,It,at+pt(de/2),Z,nt(0,yt-de),it,Pt),Y(P,L,T,It-de/2,at,Z+de,yt)}}return de>0?Re.stroke=Qe?Tt:At:Qe||(Re._fill=U.width==0?U._fill:U._stroke??U._fill,Re.width=0),Re.fill=Qe?Fe:At,Re})}function Mc(e,l){const i=he(l==null?void 0:l.alignGaps,0);return(n,r,c,u)=>yl(n,r,(h,p,m,S,g,v,P,L,E,W,U)=>{[c,u]=Mn(m,c,u);let _=h.pxRound,H=N=>_(v(N,S,W,L)),x=N=>_(P(N,g,U,E)),ee,R,te;S.ori==0?(ee=Rn,te=Gl,R=Or):(ee=Cn,te=Ul,R=Wr);const J=S.dir*(S.ori==0?1:-1);let ne=H(p[J==1?c:u]),j=ne,k=[],Q=[];for(let N=J==1?c:u;N>=c&&N<=u;N+=J)if(m[N]!=null){let I=p[N],F=H(I);k.push(j=F),Q.push(x(m[N]))}const V={stroke:e(k,Q,ee,te,R,_),fill:null,clip:null,band:null,gaps:null,flags:Wl},K=V.stroke;let[B,ie]=Os(n,r);if(h.fill!=null||B!=0){let N=V.fill=new Path2D(K),qe=h.fillTo(n,r,h.min,h.max,B),I=x(qe);te(N,j,I),te(N,ne,I)}if(!h.spanGaps){let N=[];N.push(...Ws(p,m,c,u,J,H,i)),V.gaps=N=h.gaps(n,r,c,u,N),V.clip=Ln(N,S.ori,L,E,W,U)}return ie!=0&&(V.band=ie==2?[jt(n,r,c,u,K,-1),jt(n,r,c,u,K,1)]:jt(n,r,c,u,K,ie)),V})}function Ec(e){return Mc(Ac,e)}function Ac(e,l,i,n,r,c){const u=e.length;if(u<2)return null;const h=new Path2D;if(i(h,e[0],l[0]),u==2)n(h,e[1],l[1]);else{let p=Array(u),m=Array(u-1),S=Array(u-1),g=Array(u-1);for(let v=0;v<u-1;v++)S[v]=l[v+1]-l[v],g[v]=e[v+1]-e[v],m[v]=S[v]/g[v];p[0]=m[0];for(let v=1;v<u-1;v++)m[v]===0||m[v-1]===0||m[v-1]>0!=m[v]>0?p[v]=0:(p[v]=3*(g[v-1]+g[v])/((2*g[v]+g[v-1])/m[v-1]+(g[v]+2*g[v-1])/m[v]),isFinite(p[v])||(p[v]=0));p[u-1]=m[u-2];for(let v=0;v<u-1;v++)r(h,e[v]+g[v]/3,l[v]+p[v]*g[v]/3,e[v+1]-g[v]/3,l[v+1]-p[v+1]*g[v]/3,e[v+1],l[v+1])}return h}const Ds=new Set;function ir(){for(let e of Ds)e.syncRect(!0)}Bl&&(dl(ca,Fl,ir),dl(ua,Fl,ir,!0),dl(xn,Fl,()=>{Ze.pxRatio=me}));const Pc=Ur(),Lc=Br();function rr(e,l,i,n){return(n?[e[0],e[1]].concat(e.slice(2)):[e[0]].concat(e.slice(1))).map((c,u)=>Ts(c,u,l,i))}function Rc(e,l){return e.map((i,n)=>n==0?{}:ze({},l,i))}function Ts(e,l,i,n){return ze({},l==0?i:n,e)}function Yr(e,l,i){return l==null?Nl:[l,i]}const Cc=Yr;function Vc(e,l,i){return l==null?Nl:kn(l,i,Cs,!0)}function $r(e,l,i,n){return l==null?Nl:En(l,i,e.scales[n].log,!1)}const zc=$r;function Kr(e,l,i,n){return l==null?Nl:Rs(l,i,e.scales[n].log,!1)}const Fc=Kr;function Hc(e,l,i,n,r){let c=nt(Ii(e),Ii(l)),u=l-e,h=Ft(r/n*u,i);do{let p=i[h],m=n*p/u;if(m>=r&&c+(p<5?tl.get(p):0)<=17)return[p,m]}while(++h<i.length);return[0,0]}function or(e){let l,i;return e=e.replace(/(\d+)px/,(n,r)=>(l=He((i=+r)*me))+"px"),[e,l,i]}function Ic(e){e.show&&[e.font,e.labelFont].forEach(l=>{let i=we(l[2]*me,1);l[0]=l[0].replace(/[0-9.]+px/,i+"px"),l[1]=i})}function Ze(e,l,i){const n={mode:he(e.mode,1)},r=n.mode;function c(t,s,o,a){let f=s.valToPct(t);return a+o*(s.dir==-1?1-f:f)}function u(t,s,o,a){let f=s.valToPct(t);return a+o*(s.dir==-1?f:1-f)}function h(t,s,o,a){return s.ori==0?c(t,s,o,a):u(t,s,o,a)}n.valToPosH=c,n.valToPosV=u;let p=!1;n.status=0;const m=n.root=kt(Yo);if(e.id!=null&&(m.id=e.id),ht(m,e.class),e.title){let t=kt(jo,m);t.textContent=e.title}const S=zt("canvas"),g=n.ctx=S.getContext("2d"),v=kt(qo,m);dl("click",v,t=>{t.target===L&&(xe!=Al||Me!=Pl)&&je.click(n,t)},!0);const P=n.under=kt(Jo,v);v.appendChild(S);const L=n.over=kt(Zo,v);e=Ol(e);const E=+he(e.pxAlign,1),W=nr(E);(e.plugins||[]).forEach(t=>{t.opts&&(e=t.opts(n,e)||e)});const U=e.ms||.001,_=n.series=r==1?rr(e.series||[],Ji,tr,!1):Rc(e.series||[null],er),H=n.axes=rr(e.axes||[],qi,Qi,!0),x=n.scales={},ee=n.bands=e.bands||[];ee.forEach(t=>{t.fill=oe(t.fill||null),t.dir=he(t.dir,-1)});const R=r==2?_[1].facets[0].scale:_[0].scale,te={axes:co,series:so},J=(e.drawOrder||["axes","series"]).map(t=>te[t]);function ne(t){const s=t.distr==3?o=>Kt(o>0?o:t.clamp(n,o,t.min,t.max,t.key)):t.distr==4?o=>us(o,t.asinh):t.distr==100?o=>t.fwd(o):o=>o;return o=>{let a=s(o),{_min:f,_max:d}=t,y=d-f;return(a-f)/y}}function j(t){let s=x[t];if(s==null){let o=(e.scales||sn)[t]||sn;if(o.from!=null){j(o.from);let a=ze({},x[o.from],o,{key:t});a.valToPct=ne(a),x[t]=a}else{s=x[t]=ze({},t==R?zr:wc,o),s.key=t;let a=s.time,f=s.range,d=el(f);if((t!=R||r==2&&!a)&&(d&&(f[0]==null||f[1]==null)&&(f={min:f[0]==null?zi:{mode:1,hard:f[0],soft:f[0]},max:f[1]==null?zi:{mode:1,hard:f[1],soft:f[1]}},d=!1),!d&&Pn(f))){let y=f;f=(w,b,M)=>b==null?Nl:kn(b,M,y)}s.range=oe(f||(a?Cc:t==R?s.distr==3?zc:s.distr==4?Fc:Yr:s.distr==3?$r:s.distr==4?Kr:Vc)),s.auto=oe(d?!1:s.auto),s.clamp=oe(s.clamp||Sc),s._min=s._max=null,s.valToPct=ne(s)}}}j("x"),j("y"),r==1&&_.forEach(t=>{j(t.scale)}),H.forEach(t=>{j(t.scale)});for(let t in e.scales)j(t);const k=x[R],Q=k.distr;let V,K;k.ori==0?(ht(m,$o),V=c,K=u):(ht(m,Ko),V=u,K=c);const B={};for(let t in x){let s=x[t];(s.min!=null||s.max!=null)&&(B[t]={min:s.min,max:s.max},s.min=s.max=null)}const ie=e.tzDate||(t=>new Date(He(t/U))),N=e.fmtDate||Fs,qe=U==1?$a(ie):qa(ie),I=$i(ie,Yi(U==1?Ya:ja,N)),F=ji(ie,Ki(Za,N)),Y=[],z=n.legend=ze({},ec,e.legend),D=n.cursor=ze({},rc,{drag:{y:r==2}},e.cursor),se=z.show,be=D.show,le=z.markers;z.idxs=Y,le.width=oe(le.width),le.dash=oe(le.dash),le.stroke=oe(le.stroke),le.fill=oe(le.fill);let Z,$e,Le,de=[],Qe=[],st,Fe=!1,ot={};if(z.live){const t=_[1]?_[1].values:null;Fe=t!=null,st=Fe?t(n,1,0):{_:0};for(let s in st)ot[s]=Ps}if(se)if(Z=zt("table",na,m),Le=zt("tbody",null,Z),z.mount(n,Z),Fe){$e=zt("thead",null,Z,Le);let t=zt("tr",null,$e);zt("th",null,t);for(var Tt in st)zt("th",bi,t).textContent=Tt}else ht(Z,ia),z.live&&ht(Z,sa);const Mt={show:!0},Et={show:!1};function dt(t,s){if(s==0&&(Fe||!z.live||r==2))return Nl;let o=[],a=zt("tr",ra,Le,Le.childNodes[s]);ht(a,t.class),t.show||ht(a,ml);let f=zt("th",null,a);if(le.show){let w=kt(oa,f);if(s>0){let b=le.width(n,s);b&&(w.style.border=b+"px "+le.dash(n,s)+" "+le.stroke(n,s)),w.style.background=le.fill(n,s)}}let d=kt(bi,f);t.label instanceof HTMLElement?d.appendChild(t.label):d.textContent=t.label,s>0&&(le.show||(d.style.color=t.width>0?le.stroke(n,s):le.fill(n,s)),Re("click",f,w=>{if(D._lock)return;il(w);let b=_.indexOf(t);if((w.ctrlKey||w.metaKey)!=z.isolate){let M=_.some((A,C)=>C>0&&C!=b&&A.show);_.forEach((A,C)=>{C>0&&Ot(C,M?C==b?Mt:Et:Mt,!0,Ve.setSeries)})}else Ot(b,{show:!t.show},!0,Ve.setSeries)},!1),wl&&Re(Ti,f,w=>{D._lock||(il(w),Ot(_.indexOf(t),Rl,!0,Ve.setSeries))},!1));for(var y in st){let w=zt("td",aa,a);w.textContent="--",o.push(w)}return[a,o]}const gt=new Map;function Re(t,s,o,a=!0){const f=gt.get(s)||{},d=D.bind[t](n,s,o,a);d&&(dl(t,s,f[t]=d),gt.set(s,f))}function At(t,s,o){const a=gt.get(s)||{};for(let f in a)(t==null||f==t)&&(ws(f,s,a[f]),delete a[f]);t==null&&gt.delete(s)}let Xe=0,Ee=0,G=0,T=0,ae=0,ve=0,vt=ae,ll=ve,It=G,nl=T,at=0,yt=0,it=0,Pt=0;n.bbox={};let zn=!1,on=!1,Sl=!1,sl=!1,an=!1,St=!1;function Fn(t,s,o){(o||t!=n.width||s!=n.height)&&Gs(t,s),Dl(!1),Sl=!0,on=!0,Tl()}function Gs(t,s){n.width=Xe=G=t,n.height=Ee=T=s,ae=ve=0,Zr(),Qr();let o=n.bbox;at=o.left=fl(ae*me,.5),yt=o.top=fl(ve*me,.5),it=o.width=fl(G*me,.5),Pt=o.height=fl(T*me,.5)}const jr=3;function qr(){let t=!1,s=0;for(;!t;){s++;let o=oo(s),a=ao(s);t=s==jr||o&&a,t||(Gs(n.width,n.height),on=!0)}}function Jr({width:t,height:s}){Fn(t,s)}n.setSize=Jr;function Zr(){let t=!1,s=!1,o=!1,a=!1;H.forEach((f,d)=>{if(f.show&&f._show){let{side:y,_size:w}=f,b=y%2,M=f.label!=null?f.labelSize:0,A=w+M;A>0&&(b?(G-=A,y==3?(ae+=A,a=!0):o=!0):(T-=A,y==0?(ve+=A,t=!0):s=!0))}}),rl[0]=t,rl[1]=o,rl[2]=s,rl[3]=a,G-=qt[1]+qt[3],ae+=qt[3],T-=qt[2]+qt[0],ve+=qt[0]}function Qr(){let t=ae+G,s=ve+T,o=ae,a=ve;function f(d,y){switch(d){case 1:return t+=y,t-y;case 2:return s+=y,s-y;case 3:return o-=y,o+y;case 0:return a-=y,a+y}}H.forEach((d,y)=>{if(d.show&&d._show){let w=d.side;d._pos=f(w,d._size),d.label!=null&&(d._lpos=f(w,d.labelSize))}})}if(D.dataIdx==null){let t=D.hover,s=t.skip=new Set(t.skip??[]);s.add(void 0);let o=t.prox=oe(t.prox),a=t.bias??(t.bias=0);D.dataIdx=(f,d,y,w)=>{if(d==0)return y;let b=y,M=o(f,d,y,w)??Se,A=M>=0&&M<Se,C=k.ori==0?G:T,q=D.left,pe=l[0],ce=l[d];if(s.has(ce[y])){b=null;let re=null,$=null,O;if(a==0||a==-1)for(O=y;re==null&&O-- >0;)s.has(ce[O])||(re=O);if(a==0||a==1)for(O=y;$==null&&O++<ce.length;)s.has(ce[O])||($=O);if(re!=null||$!=null)if(A){let De=re==null?-1/0:V(pe[re],k,C,0),Ae=$==null?1/0:V(pe[$],k,C,0),Ye=q-De,ye=Ae-q;Ye<=ye?Ye<=M&&(b=re):ye<=M&&(b=$)}else b=$==null?re:re==null?$:y-re<=$-y?re:$}else A&&Ie(q-V(pe[y],k,C,0))>M&&(b=null);return b}}const il=t=>{D.event=t};D.idxs=Y,D._lock=!1;let Je=D.points;Je.show=oe(Je.show),Je.size=oe(Je.size),Je.stroke=oe(Je.stroke),Je.width=oe(Je.width),Je.fill=oe(Je.fill);const Nt=n.focus=ze({},e.focus||{alpha:.3},D.focus),wl=Nt.prox>=0,_l=wl&&Je.one;let wt=[],bl=[],xl=[];function Us(t,s){let o=Je.show(n,s);if(o instanceof HTMLElement)return ht(o,la),ht(o,t.class),Yt(o,-10,-10,G,T),L.insertBefore(o,wt[s]),o}function Ys(t,s){if(r==1||s>0){let o=r==1&&x[t.scale].time,a=t.value;t.value=o?Wi(a)?ji(ie,Ki(a,N)):a||F:a||gc,t.label=t.label||(o?ac:oc)}if(_l||s>0){t.width=t.width==null?1:t.width,t.paths=t.paths||Pc||wa,t.fillTo=oe(t.fillTo||_c),t.pxAlign=+he(t.pxAlign,E),t.pxRound=nr(t.pxAlign),t.stroke=oe(t.stroke||null),t.fill=oe(t.fill||null),t._stroke=t._fill=t._paths=t._focus=null;let o=vc(nt(1,t.width),1),a=t.points=ze({},{size:o,width:nt(1,o*.2),stroke:t.stroke,space:o*2,paths:Lc,_stroke:null,_fill:null},t.points);a.show=oe(a.show),a.filter=oe(a.filter),a.fill=oe(a.fill),a.stroke=oe(a.stroke),a.paths=oe(a.paths),a.pxAlign=t.pxAlign}if(se){let o=dt(t,s);de.splice(s,0,o[0]),Qe.splice(s,0,o[1]),z.values.push(null)}if(be){Y.splice(s,0,null);let o=null;_l?s==0&&(o=Us(t,s)):s>0&&(o=Us(t,s)),wt.splice(s,0,o),bl.splice(s,0,0),xl.splice(s,0,0)}Ue("addSeries",s)}function Xr(t,s){s=s??_.length,t=r==1?Ts(t,s,Ji,tr):Ts(t,s,{},er),_.splice(s,0,t),Ys(_[s],s)}n.addSeries=Xr;function eo(t){if(_.splice(t,1),se){z.values.splice(t,1),Qe.splice(t,1);let s=de.splice(t,1)[0];At(null,s.firstChild),s.remove()}be&&(Y.splice(t,1),wt.splice(t,1)[0].remove(),bl.splice(t,1),xl.splice(t,1)),Ue("delSeries",t)}n.delSeries=eo;const rl=[!1,!1,!1,!1];function to(t,s){if(t._show=t.show,t.show){let o=t.side%2,a=x[t.scale];a==null&&(t.scale=o?_[1].scale:R,a=x[t.scale]);let f=a.time;t.size=oe(t.size),t.space=oe(t.space),t.rotate=oe(t.rotate),el(t.incrs)&&t.incrs.forEach(y=>{!tl.has(y)&&tl.set(y,gr(y))}),t.incrs=oe(t.incrs||(a.distr==2?Ba:f?U==1?Ua:Ka:hl)),t.splits=oe(t.splits||(f&&a.distr==1?qe:a.distr==3?bs:a.distr==4?fc:uc)),t.stroke=oe(t.stroke),t.grid.stroke=oe(t.grid.stroke),t.ticks.stroke=oe(t.ticks.stroke),t.border.stroke=oe(t.border.stroke);let d=t.values;t.values=el(d)&&!el(d[0])?oe(d):f?el(d)?$i(ie,Yi(d,N)):Wi(d)?Ja(ie,d):d||I:d||cc,t.filter=oe(t.filter||(a.distr>=3&&a.log==10?mc:a.distr==3&&a.log==2?dc:mr)),t.font=or(t.font),t.labelFont=or(t.labelFont),t._size=t.size(n,null,s,0),t._space=t._rotate=t._incrs=t._found=t._splits=t._values=null,t._size>0&&(rl[s]=!0,t._el=kt(Qo,v))}}function Yl(t,s,o,a){let[f,d,y,w]=o,b=s%2,M=0;return b==0&&(w||d)&&(M=s==0&&!f||s==2&&!y?He(qi.size/3):0),b==1&&(f||y)&&(M=s==1&&!d||s==3&&!w?He(Qi.size/2):0),M}const $s=n.padding=(e.padding||[Yl,Yl,Yl,Yl]).map(t=>oe(he(t,Yl))),qt=n._padding=$s.map((t,s)=>t(n,s,rl,0));let Ke,Oe=null,We=null;const cn=r==1?_[0].idxs:null;let Lt=null,$l=!1;function Ks(t,s){if(l=t??[],n.data=n._data=l,r==2){Ke=0;for(let o=1;o<_.length;o++)Ke+=l[o][0].length}else{l.length==0&&(n.data=n._data=l=[[]]),Lt=l[0],Ke=Lt.length;let o=l;if(Q==2){o=l.slice();let a=o[0]=Array(Ke);for(let f=0;f<Ke;f++)a[f]=f}n._data=l=o}if(Dl(!0),Ue("setData"),Q==2&&(Sl=!0),s!==!1){let o=k;o.auto(n,$l)?Hn():Zt(R,o.min,o.max),sl=sl||D.left>=0,St=!0,Tl()}}n.setData=Ks;function Hn(){$l=!0;let t,s;r==1&&(Ke>0?(Oe=cn[0]=0,We=cn[1]=Ke-1,t=l[0][Oe],s=l[0][We],Q==2?(t=Oe,s=We):t==s&&(Q==3?[t,s]=En(t,t,k.log,!1):Q==4?[t,s]=Rs(t,t,k.log,!1):k.time?s=t+He(86400/U):[t,s]=kn(t,s,Cs,!0))):(Oe=cn[0]=t=null,We=cn[1]=s=null)),Zt(R,t,s)}let un,kl,In,Nn,On,Wn,Bn,Gn,Un,rt;function js(t,s,o,a,f,d){t??(t=ki),o??(o=zs),a??(a="butt"),f??(f=ki),d??(d="round"),t!=un&&(g.strokeStyle=un=t),f!=kl&&(g.fillStyle=kl=f),s!=In&&(g.lineWidth=In=s),d!=On&&(g.lineJoin=On=d),a!=Wn&&(g.lineCap=Wn=a),o!=Nn&&g.setLineDash(Nn=o)}function qs(t,s,o,a){s!=kl&&(g.fillStyle=kl=s),t!=Bn&&(g.font=Bn=t),o!=Gn&&(g.textAlign=Gn=o),a!=Un&&(g.textBaseline=Un=a)}function Yn(t,s,o,a,f=0){if(a.length>0&&t.auto(n,$l)&&(s==null||s.min==null)){let d=he(Oe,0),y=he(We,a.length-1),w=o.min==null?ma(a,d,y,f,t.distr==3):[o.min,o.max];t.min=Ht(t.min,o.min=w[0]),t.max=nt(t.max,o.max=w[1])}}const Js={min:null,max:null};function lo(){for(let a in x){let f=x[a];B[a]==null&&(f.min==null||B[R]!=null&&f.auto(n,$l))&&(B[a]=Js)}for(let a in x){let f=x[a];B[a]==null&&f.from!=null&&B[f.from]!=null&&(B[a]=Js)}B[R]!=null&&Dl(!0);let t={};for(let a in B){let f=B[a];if(f!=null){let d=t[a]=Ol(x[a],xa);if(f.min!=null)ze(d,f);else if(a!=R||r==2)if(Ke==0&&d.from==null){let y=d.range(n,null,null,a);d.min=y[0],d.max=y[1]}else d.min=Se,d.max=-Se}}if(Ke>0){_.forEach((a,f)=>{if(r==1){let d=a.scale,y=B[d];if(y==null)return;let w=t[d];if(f==0){let b=w.range(n,w.min,w.max,d);w.min=b[0],w.max=b[1],Oe=Ft(w.min,l[0]),We=Ft(w.max,l[0]),We-Oe>1&&(l[0][Oe]<w.min&&Oe++,l[0][We]>w.max&&We--),a.min=Lt[Oe],a.max=Lt[We]}else a.show&&a.auto&&Yn(w,y,a,l[f],a.sorted);a.idxs[0]=Oe,a.idxs[1]=We}else if(f>0&&a.show&&a.auto){let[d,y]=a.facets,w=d.scale,b=y.scale,[M,A]=l[f],C=t[w],q=t[b];C!=null&&Yn(C,B[w],d,M,d.sorted),q!=null&&Yn(q,B[b],y,A,y.sorted),a.min=y.min,a.max=y.max}});for(let a in t){let f=t[a],d=B[a];if(f.from==null&&(d==null||d.min==null)){let y=f.range(n,f.min==Se?null:f.min,f.max==-Se?null:f.max,a);f.min=y[0],f.max=y[1]}}}for(let a in t){let f=t[a];if(f.from!=null){let d=t[f.from];if(d.min==null)f.min=f.max=null;else{let y=f.range(n,d.min,d.max,a);f.min=y[0],f.max=y[1]}}}let s={},o=!1;for(let a in t){let f=t[a],d=x[a];if(d.min!=f.min||d.max!=f.max){d.min=f.min,d.max=f.max;let y=d.distr;d._min=y==3?Kt(d.min):y==4?us(d.min,d.asinh):y==100?d.fwd(d.min):d.min,d._max=y==3?Kt(d.max):y==4?us(d.max,d.asinh):y==100?d.fwd(d.max):d.max,s[a]=o=!0}}if(o){_.forEach((a,f)=>{r==2?f>0&&s.y&&(a._paths=null):s[a.scale]&&(a._paths=null)});for(let a in s)Sl=!0,Ue("setScale",a);be&&D.left>=0&&(sl=St=!0)}for(let a in B)B[a]=null}function no(t){let s=_s(Oe-1,0,Ke-1),o=_s(We+1,0,Ke-1);for(;t[s]==null&&s>0;)s--;for(;t[o]==null&&o<Ke-1;)o++;return[s,o]}function so(){if(Ke>0){let t=_.some(s=>s._focus)&&rt!=Nt.alpha;t&&(g.globalAlpha=rt=Nt.alpha),_.forEach((s,o)=>{if(o>0&&s.show&&(Zs(o,!1),Zs(o,!0),s._paths==null)){let a=rt;rt!=s.alpha&&(g.globalAlpha=rt=s.alpha);let f=r==2?[0,l[o][0].length-1]:no(l[o]);s._paths=s.paths(n,o,f[0],f[1]),rt!=a&&(g.globalAlpha=rt=a)}}),_.forEach((s,o)=>{if(o>0&&s.show){let a=rt;rt!=s.alpha&&(g.globalAlpha=rt=s.alpha),s._paths!=null&&Qs(o,!1);{let f=s._paths!=null?s._paths.gaps:null,d=s.points.show(n,o,Oe,We,f),y=s.points.filter(n,o,d,f);(d||y)&&(s.points._paths=s.points.paths(n,o,Oe,We,y),Qs(o,!0))}rt!=a&&(g.globalAlpha=rt=a),Ue("drawSeries",o)}}),t&&(g.globalAlpha=rt=1)}}function Zs(t,s){let o=s?_[t].points:_[t];o._stroke=o.stroke(n,t),o._fill=o.fill(n,t)}function Qs(t,s){let o=s?_[t].points:_[t],{stroke:a,fill:f,clip:d,flags:y,_stroke:w=o._stroke,_fill:b=o._fill,_width:M=o.width}=o._paths;M=we(M*me,3);let A=null,C=M%2/2;s&&b==null&&(b=M>0?"#fff":w);let q=o.pxAlign==1&&C>0;if(q&&g.translate(C,C),!s){let pe=at-M/2,ce=yt-M/2,re=it+M,$=Pt+M;A=new Path2D,A.rect(pe,ce,re,$)}s?$n(w,M,o.dash,o.cap,b,a,f,y,d):io(t,w,M,o.dash,o.cap,b,a,f,y,A,d),q&&g.translate(-C,-C)}function io(t,s,o,a,f,d,y,w,b,M,A){let C=!1;b!=0&&ee.forEach((q,pe)=>{if(q.series[0]==t){let ce=_[q.series[1]],re=l[q.series[1]],$=(ce._paths||sn).band;el($)&&($=q.dir==1?$[0]:$[1]);let O,De=null;ce.show&&$&&ga(re,Oe,We)?(De=q.fill(n,pe)||d,O=ce._paths.clip):$=null,$n(s,o,a,f,De,y,w,b,M,A,O,$),C=!0}}),C||$n(s,o,a,f,d,y,w,b,M,A)}const Xs=Wl|ks;function $n(t,s,o,a,f,d,y,w,b,M,A,C){js(t,s,o,a,f),(b||M||C)&&(g.save(),b&&g.clip(b),M&&g.clip(M)),C?(w&Xs)==Xs?(g.clip(C),A&&g.clip(A),hn(f,y),fn(t,d,s)):w&ks?(hn(f,y),g.clip(C),fn(t,d,s)):w&Wl&&(g.save(),g.clip(C),A&&g.clip(A),hn(f,y),g.restore(),fn(t,d,s)):(hn(f,y),fn(t,d,s)),(b||M||C)&&g.restore()}function fn(t,s,o){o>0&&(s instanceof Map?s.forEach((a,f)=>{g.strokeStyle=un=f,g.stroke(a)}):s!=null&&t&&g.stroke(s))}function hn(t,s){s instanceof Map?s.forEach((o,a)=>{g.fillStyle=kl=a,g.fill(o)}):s!=null&&t&&g.fill(s)}function ro(t,s,o,a){let f=H[t],d;if(a<=0)d=[0,0];else{let y=f._space=f.space(n,t,s,o,a),w=f._incrs=f.incrs(n,t,s,o,a,y);d=Hc(s,o,w,a,y)}return f._found=d}function Kn(t,s,o,a,f,d,y,w,b,M){let A=y%2/2;E==1&&g.translate(A,A),js(w,y,b,M,w),g.beginPath();let C,q,pe,ce,re=f+(a==0||a==3?-d:d);o==0?(q=f,ce=re):(C=f,pe=re);for(let $=0;$<t.length;$++)s[$]!=null&&(o==0?C=pe=t[$]:q=ce=t[$],g.moveTo(C,q),g.lineTo(pe,ce));g.stroke(),E==1&&g.translate(-A,-A)}function oo(t){let s=!0;return H.forEach((o,a)=>{if(!o.show)return;let f=x[o.scale];if(f.min==null){o._show&&(s=!1,o._show=!1,Dl(!1));return}else o._show||(s=!1,o._show=!0,Dl(!1));let d=o.side,y=d%2,{min:w,max:b}=f,[M,A]=ro(a,w,b,y==0?G:T);if(A==0)return;let C=f.distr==2,q=o._splits=o.splits(n,a,w,b,M,A,C),pe=f.distr==2?q.map(O=>Lt[O]):q,ce=f.distr==2?Lt[q[1]]-Lt[q[0]]:M,re=o._values=o.values(n,o.filter(n,pe,a,A,ce),a,A,ce);o._rotate=d==2?o.rotate(n,re,a,A):0;let $=o._size;o._size=Dt(o.size(n,re,a,t)),$!=null&&o._size!=$&&(s=!1)}),s}function ao(t){let s=!0;return $s.forEach((o,a)=>{let f=o(n,a,rl,t);f!=qt[a]&&(s=!1),qt[a]=f}),s}function co(){for(let t=0;t<H.length;t++){let s=H[t];if(!s.show||!s._show)continue;let o=s.side,a=o%2,f,d,y=s.stroke(n,t),w=o==0||o==3?-1:1,[b,M]=s._found;if(s.label!=null){let tt=s.labelGap*w,ft=He((s._lpos+tt)*me);qs(s.labelFont[0],y,"center",o==2?Ql:xi),g.save(),a==1?(f=d=0,g.translate(ft,He(yt+Pt/2)),g.rotate((o==3?-bn:bn)/2)):(f=He(at+it/2),d=ft);let cl=hr(s.label)?s.label(n,t,b,M):s.label;g.fillText(cl,f,d),g.restore()}if(M==0)continue;let A=x[s.scale],C=a==0?it:Pt,q=a==0?at:yt,pe=s._splits,ce=A.distr==2?pe.map(tt=>Lt[tt]):pe,re=A.distr==2?Lt[pe[1]]-Lt[pe[0]]:b,$=s.ticks,O=s.border,De=$.show?$.size:0,Ae=He(De*me),Ye=He((s.alignTo==2?s._size-De-s.gap:s.gap)*me),ye=s._rotate*-bn/180,Pe=W(s._pos*me),ct=(Ae+Ye)*w,et=Pe+ct;d=a==0?et:0,f=a==1?et:0;let _t=s.font[0],Rt=s.align==1?Vl:s.align==2?os:ye>0?Vl:ye<0?os:a==0?"center":o==3?os:Vl,Bt=ye||a==1?"middle":o==2?Ql:xi;qs(_t,y,Rt,Bt);let ut=s.font[1]*s.lineGap,bt=pe.map(tt=>W(h(tt,A,C,q))),Ct=s._values;for(let tt=0;tt<Ct.length;tt++){let ft=Ct[tt];if(ft!=null){a==0?f=bt[tt]:d=bt[tt],ft=""+ft;let cl=ft.indexOf(`
`)==-1?[ft]:ft.split(/\n/gm);for(let lt=0;lt<cl.length;lt++){let yi=cl[lt];ye?(g.save(),g.translate(f,d+lt*ut),g.rotate(ye),g.fillText(yi,0,0),g.restore()):g.fillText(yi,f,d+lt*ut)}}}$.show&&Kn(bt,$.filter(n,ce,t,M,re),a,o,Pe,Ae,we($.width*me,3),$.stroke(n,t),$.dash,$.cap);let Gt=s.grid;Gt.show&&Kn(bt,Gt.filter(n,ce,t,M,re),a,a==0?2:1,a==0?yt:at,a==0?Pt:it,we(Gt.width*me,3),Gt.stroke(n,t),Gt.dash,Gt.cap),O.show&&Kn([Pe],[1],a==0?1:0,a==0?1:2,a==1?yt:at,a==1?Pt:it,we(O.width*me,3),O.stroke(n,t),O.dash,O.cap)}Ue("drawAxes")}function Dl(t){_.forEach((s,o)=>{o>0&&(s._paths=null,t&&(r==1?(s.min=null,s.max=null):s.facets.forEach(a=>{a.min=null,a.max=null})))})}let pn=!1,jn=!1,Kl=[];function uo(){jn=!1;for(let t=0;t<Kl.length;t++)Ue(...Kl[t]);Kl.length=0}function Tl(){pn||(Pa(ei),pn=!0)}function fo(t,s=!1){pn=!0,jn=s,t(n),ei(),s&&Kl.length>0&&queueMicrotask(uo)}n.batch=fo;function ei(){if(zn&&(lo(),zn=!1),Sl&&(qr(),Sl=!1),on){if(Te(P,Vl,ae),Te(P,Ql,ve),Te(P,en,G),Te(P,tn,T),Te(L,Vl,ae),Te(L,Ql,ve),Te(L,en,G),Te(L,tn,T),Te(v,en,Xe),Te(v,tn,Ee),S.width=He(Xe*me),S.height=He(Ee*me),H.forEach(({_el:t,_show:s,_size:o,_pos:a,side:f})=>{if(t!=null)if(s){let d=f===3||f===0?o:0,y=f%2==1;Te(t,y?"left":"top",a-d),Te(t,y?"width":"height",o),Te(t,y?"top":"left",y?ve:ae),Te(t,y?"height":"width",y?T:G),Ss(t,ml)}else ht(t,ml)}),un=kl=In=On=Wn=Bn=Gn=Un=Nn=null,rt=1,Jl(!0),ae!=vt||ve!=ll||G!=It||T!=nl){Dl(!1);let t=G/It,s=T/nl;if(be&&!sl&&D.left>=0){D.left*=t,D.top*=s,Ml&&Yt(Ml,He(D.left),0,G,T),El&&Yt(El,0,He(D.top),G,T);for(let o=0;o<wt.length;o++){let a=wt[o];a!=null&&(bl[o]*=t,xl[o]*=s,Yt(a,Dt(bl[o]),Dt(xl[o]),G,T))}}if(ke.show&&!an&&ke.left>=0&&ke.width>0){ke.left*=t,ke.width*=t,ke.top*=s,ke.height*=s;for(let o in es)Te(Ll,o,ke[o])}vt=ae,ll=ve,It=G,nl=T}Ue("setSize"),on=!1}Xe>0&&Ee>0&&(g.clearRect(0,0,S.width,S.height),Ue("drawClear"),J.forEach(t=>t()),Ue("draw")),ke.show&&an&&(mn(ke),an=!1),be&&sl&&(al(null,!0,!1),sl=!1),z.show&&z.live&&St&&(Qn(),St=!1),p||(p=!0,n.status=1,Ue("ready")),$l=!1,pn=!1}n.redraw=(t,s)=>{Sl=s||!1,t!==!1?Zt(R,k.min,k.max):Tl()};function qn(t,s){let o=x[t];if(o.from==null){if(Ke==0){let a=o.range(n,s.min,s.max,t);s.min=a[0],s.max=a[1]}if(s.min>s.max){let a=s.min;s.min=s.max,s.max=a}if(Ke>1&&s.min!=null&&s.max!=null&&s.max-s.min<1e-16)return;t==R&&o.distr==2&&Ke>0&&(s.min=Ft(s.min,l[0]),s.max=Ft(s.max,l[0]),s.min==s.max&&s.max++),B[t]=s,zn=!0,Tl()}}n.setScale=qn;let Jn,Zn,Ml,El,ti,li,Al,Pl,ni,si,xe,Me,Jt=!1;const je=D.drag;let Be=je.x,Ge=je.y;be&&(D.x&&(Jn=kt(ea,L)),D.y&&(Zn=kt(ta,L)),k.ori==0?(Ml=Jn,El=Zn):(Ml=Zn,El=Jn),xe=D.left,Me=D.top);const ke=n.select=ze({show:!0,over:!0,left:0,width:0,top:0,height:0},e.select),Ll=ke.show?kt(Xo,ke.over?L:P):null;function mn(t,s){if(ke.show){for(let o in t)ke[o]=t[o],o in es&&Te(Ll,o,t[o]);s!==!1&&Ue("setSelect")}}n.setSelect=mn;function ho(t){if(_[t].show)se&&Ss(de[t],ml);else if(se&&ht(de[t],ml),be){let o=_l?wt[0]:wt[t];o!=null&&Yt(o,-10,-10,G,T)}}function Zt(t,s,o){qn(t,{min:s,max:o})}function Ot(t,s,o,a){s.focus!=null&&yo(t),s.show!=null&&_.forEach((f,d)=>{d>0&&(t==d||t==null)&&(f.show=s.show,ho(d),r==2?(Zt(f.facets[0].scale,null,null),Zt(f.facets[1].scale,null,null)):Zt(f.scale,null,null),Tl())}),o!==!1&&Ue("setSeries",t,s),a&&Zl("setSeries",n,t,s)}n.setSeries=Ot;function po(t,s){ze(ee[t],s)}function mo(t,s){t.fill=oe(t.fill||null),t.dir=he(t.dir,-1),s=s??ee.length,ee.splice(s,0,t)}function go(t){t==null?ee.length=0:ee.splice(t,1)}n.addBand=mo,n.setBand=po,n.delBand=go;function vo(t,s){_[t].alpha=s,be&&wt[t]!=null&&(wt[t].style.opacity=s),se&&de[t]&&(de[t].style.opacity=s)}let $t,Qt,ol;const Rl={focus:!0};function yo(t){if(t!=ol){let s=t==null,o=Nt.alpha!=1;_.forEach((a,f)=>{if(r==1||f>0){let d=s||f==0||f==t;a._focus=s?null:d,o&&vo(f,d?1:Nt.alpha)}}),ol=t,o&&Tl()}}se&&wl&&Re(Mi,Z,t=>{D._lock||(il(t),ol!=null&&Ot(null,Rl,!0,Ve.setSeries))});function Wt(t,s,o){let a=x[s];o&&(t=t/me-(a.ori==1?ve:ae));let f=G;a.ori==1&&(f=T,t=f-t),a.dir==-1&&(t=f-t);let d=a._min,y=a._max,w=t/f,b=d+(y-d)*w,M=a.distr;return M==3?Il(10,b):M==4?ya(b,a.asinh):M==100?a.bwd(b):b}function So(t,s){let o=Wt(t,R,s);return Ft(o,l[0],Oe,We)}n.valToIdx=t=>Ft(t,l[0]),n.posToIdx=So,n.posToVal=Wt,n.valToPos=(t,s,o)=>x[s].ori==0?c(t,x[s],o?it:G,o?at:0):u(t,x[s],o?Pt:T,o?yt:0),n.setCursor=(t,s,o)=>{xe=t.left,Me=t.top,al(null,s,o)};function ii(t,s){Te(Ll,Vl,ke.left=t),Te(Ll,en,ke.width=s)}function ri(t,s){Te(Ll,Ql,ke.top=t),Te(Ll,tn,ke.height=s)}let jl=k.ori==0?ii:ri,ql=k.ori==1?ii:ri;function wo(){if(se&&z.live)for(let t=r==2?1:0;t<_.length;t++){if(t==0&&Fe)continue;let s=z.values[t],o=0;for(let a in s)Qe[t][o++].firstChild.nodeValue=s[a]}}function Qn(t,s){if(t!=null&&(t.idxs?t.idxs.forEach((o,a)=>{Y[a]=o}):ba(t.idx)||Y.fill(t.idx),z.idx=Y[0]),se&&z.live){for(let o=0;o<_.length;o++)(o>0||r==1&&!Fe)&&_o(o,Y[o]);wo()}St=!1,s!==!1&&Ue("setLegend")}n.setLegend=Qn;function _o(t,s){let o=_[t],a=t==0&&Q==2?Lt:l[t],f;Fe?f=o.values(n,t,s)??ot:(f=o.value(n,s==null?null:a[s],t,s),f=f==null?ot:{_:f}),z.values[t]=f}function al(t,s,o){ni=xe,si=Me,[xe,Me]=D.move(n,xe,Me),D.left=xe,D.top=Me,be&&(Ml&&Yt(Ml,He(xe),0,G,T),El&&Yt(El,0,He(Me),G,T));let a,f=Oe>We;$t=Se,Qt=null;let d=k.ori==0?G:T,y=k.ori==1?G:T;if(xe<0||Ke==0||f){a=D.idx=null;for(let w=0;w<_.length;w++){let b=wt[w];b!=null&&Yt(b,-10,-10,G,T)}wl&&Ot(null,Rl,!0,t==null&&Ve.setSeries),z.live&&(Y.fill(a),St=!0)}else{let w,b,M;r==1&&(w=k.ori==0?xe:Me,b=Wt(w,R),a=D.idx=Ft(b,l[0],Oe,We),M=V(l[0][a],k,d,0));let A=-10,C=-10,q=0,pe=0,ce=!0,re="",$="";for(let O=r==2?1:0;O<_.length;O++){let De=_[O],Ae=Y[O],Ye=Ae==null?null:r==1?l[O][Ae]:l[O][1][Ae],ye=D.dataIdx(n,O,a,b),Pe=ye==null?null:r==1?l[O][ye]:l[O][1][ye];if(St=St||Pe!=Ye||ye!=Ae,Y[O]=ye,O>0&&De.show){let ct=ye==null?-10:ye==a?M:V(r==1?l[0][ye]:l[O][0][ye],k,d,0),et=Pe==null?-10:K(Pe,r==1?x[De.scale]:x[De.facets[1].scale],y,0);if(wl&&Pe!=null){let _t=k.ori==1?xe:Me,Rt=Ie(Nt.dist(n,O,ye,et,_t));if(Rt<$t){let Bt=Nt.bias;if(Bt!=0){let ut=Wt(_t,De.scale),bt=Pe>=0?1:-1,Ct=ut>=0?1:-1;Ct==bt&&(Ct==1?Bt==1?Pe>=ut:Pe<=ut:Bt==1?Pe<=ut:Pe>=ut)&&($t=Rt,Qt=O)}else $t=Rt,Qt=O}}if(St||_l){let _t,Rt;k.ori==0?(_t=ct,Rt=et):(_t=et,Rt=ct);let Bt,ut,bt,Ct,Gt,tt,ft=!0,cl=Je.bbox;if(cl!=null){ft=!1;let lt=cl(n,O);bt=lt.left,Ct=lt.top,Bt=lt.width,ut=lt.height}else bt=_t,Ct=Rt,Bt=ut=Je.size(n,O);if(tt=Je.fill(n,O),Gt=Je.stroke(n,O),_l)O==Qt&&$t<=Nt.prox&&(A=bt,C=Ct,q=Bt,pe=ut,ce=ft,re=tt,$=Gt);else{let lt=wt[O];lt!=null&&(bl[O]=bt,xl[O]=Ct,Vi(lt,Bt,ut,ft),Ri(lt,tt,Gt),Yt(lt,Dt(bt),Dt(Ct),G,T))}}}}if(_l){let O=Nt.prox,De=ol==null?$t<=O:$t>O||Qt!=ol;if(St||De){let Ae=wt[0];Ae!=null&&(bl[0]=A,xl[0]=C,Vi(Ae,q,pe,ce),Ri(Ae,re,$),Yt(Ae,Dt(A),Dt(C),G,T))}}}if(ke.show&&Jt)if(t!=null){let[w,b]=Ve.scales,[M,A]=Ve.match,[C,q]=t.cursor.sync.scales,pe=t.cursor.drag;if(Be=pe._x,Ge=pe._y,Be||Ge){let{left:ce,top:re,width:$,height:O}=t.select,De=t.scales[C].ori,Ae=t.posToVal,Ye,ye,Pe,ct,et,_t=w!=null&&M(w,C),Rt=b!=null&&A(b,q);_t&&Be?(De==0?(Ye=ce,ye=$):(Ye=re,ye=O),Pe=x[w],ct=V(Ae(Ye,C),Pe,d,0),et=V(Ae(Ye+ye,C),Pe,d,0),jl(Ht(ct,et),Ie(et-ct))):jl(0,d),Rt&&Ge?(De==1?(Ye=ce,ye=$):(Ye=re,ye=O),Pe=x[b],ct=K(Ae(Ye,q),Pe,y,0),et=K(Ae(Ye+ye,q),Pe,y,0),ql(Ht(ct,et),Ie(et-ct))):ql(0,y)}else ts()}else{let w=Ie(ni-ti),b=Ie(si-li);if(k.ori==1){let q=w;w=b,b=q}Be=je.x&&w>=je.dist,Ge=je.y&&b>=je.dist;let M=je.uni;M!=null?Be&&Ge&&(Be=w>=M,Ge=b>=M,!Be&&!Ge&&(b>w?Ge=!0:Be=!0)):je.x&&je.y&&(Be||Ge)&&(Be=Ge=!0);let A,C;Be&&(k.ori==0?(A=Al,C=xe):(A=Pl,C=Me),jl(Ht(A,C),Ie(C-A)),Ge||ql(0,y)),Ge&&(k.ori==1?(A=Al,C=xe):(A=Pl,C=Me),ql(Ht(A,C),Ie(C-A)),Be||jl(0,d)),!Be&&!Ge&&(jl(0,0),ql(0,0))}if(je._x=Be,je._y=Ge,t==null){if(o){if(vi!=null){let[w,b]=Ve.scales;Ve.values[0]=w!=null?Wt(k.ori==0?xe:Me,w):null,Ve.values[1]=b!=null?Wt(k.ori==1?xe:Me,b):null}Zl(as,n,xe,Me,G,T,a)}if(wl){let w=o&&Ve.setSeries,b=Nt.prox;ol==null?$t<=b&&Ot(Qt,Rl,!0,w):$t>b?Ot(null,Rl,!0,w):Qt!=ol&&Ot(Qt,Rl,!0,w)}}St&&(z.idx=a,Qn()),s!==!1&&Ue("setCursor")}let Xt=null;Object.defineProperty(n,"rect",{get(){return Xt==null&&Jl(!1),Xt}});function Jl(t=!1){t?Xt=null:(Xt=L.getBoundingClientRect(),Ue("syncRect",Xt))}function oi(t,s,o,a,f,d,y){D._lock||Jt&&t!=null&&t.movementX==0&&t.movementY==0||(Xn(t,s,o,a,f,d,y,!1,t!=null),t!=null?al(null,!0,!0):al(s,!0,!1))}function Xn(t,s,o,a,f,d,y,w,b){if(Xt==null&&Jl(!1),il(t),t!=null)o=t.clientX-Xt.left,a=t.clientY-Xt.top;else{if(o<0||a<0){xe=-10,Me=-10;return}let[M,A]=Ve.scales,C=s.cursor.sync,[q,pe]=C.values,[ce,re]=C.scales,[$,O]=Ve.match,De=s.axes[0].side%2==1,Ae=k.ori==0?G:T,Ye=k.ori==1?G:T,ye=De?d:f,Pe=De?f:d,ct=De?a:o,et=De?o:a;if(ce!=null?o=$(M,ce)?h(q,x[M],Ae,0):-10:o=Ae*(ct/ye),re!=null?a=O(A,re)?h(pe,x[A],Ye,0):-10:a=Ye*(et/Pe),k.ori==1){let _t=o;o=a,a=_t}}b&&(s==null||s.cursor.event.type==as)&&((o<=1||o>=G-1)&&(o=fl(o,G)),(a<=1||a>=T-1)&&(a=fl(a,T))),w?(ti=o,li=a,[Al,Pl]=D.move(n,o,a)):(xe=o,Me=a)}const es={width:0,height:0,left:0,top:0};function ts(){mn(es,!1)}let ai,ci,ui,fi;function hi(t,s,o,a,f,d,y){Jt=!0,Be=Ge=je._x=je._y=!1,Xn(t,s,o,a,f,d,y,!0,!1),t!=null&&(Re(cs,vs,pi,!1),Zl(Di,n,Al,Pl,G,T,null));let{left:w,top:b,width:M,height:A}=ke;ai=w,ci=b,ui=M,fi=A}function pi(t,s,o,a,f,d,y){Jt=je._x=je._y=!1,Xn(t,s,o,a,f,d,y,!1,!0);let{left:w,top:b,width:M,height:A}=ke,C=M>0||A>0,q=ai!=w||ci!=b||ui!=M||fi!=A;if(C&&q&&mn(ke),je.setScale&&C&&q){let pe=w,ce=M,re=b,$=A;if(k.ori==1&&(pe=b,ce=A,re=w,$=M),Be&&Zt(R,Wt(pe,R),Wt(pe+ce,R)),Ge)for(let O in x){let De=x[O];O!=R&&De.from==null&&De.min!=Se&&Zt(O,Wt(re+$,O),Wt(re,O))}ts()}else D.lock&&(D._lock=!D._lock,al(s,!0,t!=null));t!=null&&(At(cs,vs),Zl(cs,n,xe,Me,G,T,null))}function bo(t,s,o,a,f,d,y){if(D._lock)return;il(t);let w=Jt;if(Jt){let b=!0,M=!0,A=10,C,q;k.ori==0?(C=Be,q=Ge):(C=Ge,q=Be),C&&q&&(b=xe<=A||xe>=G-A,M=Me<=A||Me>=T-A),C&&b&&(xe=xe<Al?0:G),q&&M&&(Me=Me<Pl?0:T),al(null,!0,!0),Jt=!1}xe=-10,Me=-10,Y.fill(null),al(null,!0,!0),w&&(Jt=w)}function mi(t,s,o,a,f,d,y){D._lock||(il(t),Hn(),ts(),t!=null&&Zl(Ei,n,xe,Me,G,T,null))}function di(){H.forEach(Ic),Fn(n.width,n.height,!0)}dl(xn,Fl,di);const Cl={};Cl.mousedown=hi,Cl.mousemove=oi,Cl.mouseup=pi,Cl.dblclick=mi,Cl.setSeries=(t,s,o,a)=>{let f=Ve.match[2];o=f(n,s,o),o!=-1&&Ot(o,a,!0,!1)},be&&(Re(Di,L,hi),Re(as,L,oi),Re(Ti,L,t=>{il(t),Jl(!1)}),Re(Mi,L,bo),Re(Ei,L,mi),Ds.add(n),n.syncRect=Jl);const dn=n.hooks=e.hooks||{};function Ue(t,s,o){jn?Kl.push([t,s,o]):t in dn&&dn[t].forEach(a=>{a.call(null,n,s,o)})}(e.plugins||[]).forEach(t=>{for(let s in t.hooks)dn[s]=(dn[s]||[]).concat(t.hooks[s])});const gi=(t,s,o)=>o,Ve=ze({key:null,setSeries:!1,filters:{pub:Ni,sub:Ni},scales:[R,_[1]?_[1].scale:null],match:[Oi,Oi,gi],values:[null,null]},D.sync);Ve.match.length==2&&Ve.match.push(gi),D.sync=Ve;const vi=Ve.key,ls=Fr(vi);function Zl(t,s,o,a,f,d,y){Ve.filters.pub(t,s,o,a,f,d,y)&&ls.pub(t,s,o,a,f,d,y)}ls.sub(n);function xo(t,s,o,a,f,d,y){Ve.filters.sub(t,s,o,a,f,d,y)&&Cl[t](null,s,o,a,f,d,y)}n.pub=xo;function ko(){ls.unsub(n),Ds.delete(n),gt.clear(),ws(xn,Fl,di),m.remove(),Z==null||Z.remove(),Ue("destroy")}n.destroy=ko;function ns(){Ue("init",e,l),Ks(l||e.data,!1),B[R]?qn(R,B[R]):Hn(),an=ke.show&&(ke.width>0||ke.height>0),sl=St=!0,Fn(e.width,e.height)}return _.forEach(Ys),H.forEach(to),i?i instanceof HTMLElement?(i.appendChild(m),ns()):i(n,ns):ns(),n}Ze.assign=ze;Ze.fmtNum=Vs;Ze.rangeNum=kn;Ze.rangeLog=En;Ze.rangeAsinh=Rs;Ze.orient=yl;Ze.pxRatio=me;Ze.join=Aa;Ze.fmtDate=Fs,Ze.tzDate=Oa;Ze.sync=Fr;{Ze.addGap=bc,Ze.clipGaps=Ln;let e=Ze.paths={points:Br};e.linear=Ur,e.stepped=Dc,e.bars=Tc,e.spline=Ec}var Nc=vl('<div class="error-message svelte-1gmyyn0"> </div>'),Oc=vl('<div class="compatibility-warning svelte-1gmyyn0"><p>Web Bluetooth is not supported in this browser.</p> <p>Please use the mobile app or a supported browser like Chrome.</p></div>'),Wc=vl(`<div class="start-session svelte-1gmyyn0"><p class="instructions svelte-1gmyyn0">Connect your Polar H10 heart rate monitor to begin tracking your heart rate variability (HRV).
        This will help calculate your Vibe Score and track your physiological balance.</p> <!> <button class="start-button svelte-1gmyyn0">Connect to Polar H10</button> <!></div>`),Bc=vl('<div class="session-active svelte-1gmyyn0"><div class="status-bar svelte-1gmyyn0"><div class="connection-status svelte-1gmyyn0"><span></span> <span> </span></div> <div class="session-timer svelte-1gmyyn0"> </div></div> <div class="metrics-summary svelte-1gmyyn0"><div class="metric svelte-1gmyyn0"><span class="metric-value svelte-1gmyyn0"> </span> <span class="metric-label svelte-1gmyyn0">Heart Rate</span></div> <div class="metric svelte-1gmyyn0"><span class="metric-value svelte-1gmyyn0"> </span> <span class="metric-label svelte-1gmyyn0">Balance</span></div> <div class="metric svelte-1gmyyn0"><span class="metric-value svelte-1gmyyn0"> </span> <span class="metric-label svelte-1gmyyn0">Vibe Score</span></div></div> <div class="chart-container svelte-1gmyyn0"></div> <div class="breathing-guide svelte-1gmyyn0"><h3 class="svelte-1gmyyn0">Breathing Guide</h3> <div class="breath-animation svelte-1gmyyn0"><div class="breath-circle svelte-1gmyyn0"></div> <div class="breath-text svelte-1gmyyn0"> </div></div></div> <button class="stop-button svelte-1gmyyn0">Stop Session</button></div>'),Gc=vl('<div class="error-message svelte-1gmyyn0"> </div>'),Uc=vl('<div class="modal-overlay svelte-1gmyyn0"><div class="summary-modal svelte-1gmyyn0"><h2 class="svelte-1gmyyn0">Session Summary</h2> <div class="summary-stats svelte-1gmyyn0"><div class="summary-stat svelte-1gmyyn0"><span class="stat-label svelte-1gmyyn0">Duration</span> <span class="stat-value svelte-1gmyyn0"> </span></div> <div class="summary-stat svelte-1gmyyn0"><span class="stat-label svelte-1gmyyn0">Avg Heart Rate</span> <span class="stat-value svelte-1gmyyn0"> </span></div> <div class="summary-stat svelte-1gmyyn0"><span class="stat-label svelte-1gmyyn0">Avg Balance (RMSSD)</span> <span class="stat-value svelte-1gmyyn0"> </span></div> <div class="summary-stat svelte-1gmyyn0"><span class="stat-label svelte-1gmyyn0">Vibe Score</span> <span class="stat-value svelte-1gmyyn0"> </span></div></div> <!> <div class="summary-actions svelte-1gmyyn0"><button class="save-button svelte-1gmyyn0"><!></button> <button class="discard-button svelte-1gmyyn0">Discard Session</button></div></div></div>'),Yc=vl('<div class="hrv-session-container svelte-1gmyyn0"><h1 class="svelte-1gmyyn0">HRV Session</h1> <!> <!></div>');function nu(e,l){To(l,!1);const[i,n]=zo(),r=()=>yn(Tn,"$hrvData",i),c=()=>yn(Fo,"$authStore",i),u=()=>yn(pl,"$bleConnectionStatus",i),h=()=>yn(Hl,"$sessionTimer",i);let p=Vt(),m=Vt(null),S=Vt("inhale"),g=Vt(0),v=null,P=Vt(!1),L=Vt(!1),E=Vt(null),W=Vt(null),U=Vt(null),_=Vt(!1),H=Vt(!1);function x(){if(!X(p))return;const I={width:X(p).clientWidth,height:300,series:[{label:"Time",value:"{YYYY}-{MM}-{DD} {HH}:{mm}:{ss}"},{label:"Heart Rate",scale:"hr",value:(Y,z)=>z.toFixed(0)+" bpm",stroke:"#E53935",width:2},{label:"Balance (RMSSD)",scale:"rmssd",value:(Y,z)=>z.toFixed(1)+" ms",stroke:"#4D44B3",width:2},{label:"Vibe Score",scale:"vibe",value:(Y,z)=>z.toFixed(0),stroke:"#BF469A",width:2}],scales:{x:{},hr:{auto:!1,range:[40,160]},rmssd:{auto:!1,range:[0,100]},vibe:{auto:!1,range:[0,100]}},axes:[{label:"Time",labelSize:20,grid:{show:!1}},{scale:"hr",label:"Heart Rate",labelSize:20,size:50,stroke:"#E53935",grid:{show:!0}},{scale:"rmssd",label:"Balance",labelSize:20,size:50,stroke:"#4D44B3",side:1,grid:{show:!1}},{scale:"vibe",label:"Vibe",labelSize:20,size:50,stroke:"#BF469A",side:1,grid:{show:!1}}]};Ce(m,new Ze(I,[[],[],[],[]],X(p)));const F=new ResizeObserver(Y=>{X(m)&&Y[0]&&X(m).setSize({width:Y[0].contentRect.width,height:300})});return F.observe(X(p)),()=>{X(m)&&(X(m).destroy(),Ce(m,null)),F.disconnect()}}function ee(){if(!X(m))return;const I=r().chartData;if(I.length===0)return;const F=I.map(se=>new Date(se.timestamp).getTime()/1e3),Y=I.map(se=>se.hr),z=I.map(se=>se.rmssd),D=I.map(se=>se.vibe);X(m).setData([F,Y,z,D])}function R(){let z="inhale",D=0,se=Date.now();v=setInterval(()=>{const be=Date.now(),le=be-se;se=be,z==="inhale"?(D+=le/4e3*100,D>=100&&(D=0,z="exhale")):(D+=le/6e3*100,D>=100&&(D=0,z="inhale")),Ce(S,z),Ce(g,D)},50)}function te(){v&&(clearInterval(v),v=null)}async function J(){var I;if(Ce(W,null),!ds()){Ce(W,"Web Bluetooth is not supported in this browser. Please use the mobile app or a supported browser like Chrome.");return}try{const F=await No();F.success?(Bo(),R(),gs(),Ce(P,!0)):Ce(W,((I=F.error)==null?void 0:I.message)||"Failed to connect to device.")}catch(F){console.error("Error starting session:",F),Ce(W,F instanceof Error?F.message:"An unknown error occurred.")}}function ne(){Es(),te(),Ce(E,Go()),Ce(L,!0)}async function j(){if(!(!c().user||!X(E))){Ce(_,!0),Ce(U,null);try{const I={timestamp:new Date().toISOString(),start:X(E).startTime,end:X(E).endTime,duration_seconds:X(E).durationSeconds,avg_hr:X(E).avgHR,avg_rmssd:X(E).avgRMSSD,vibe_score:X(E).avgVibe,chart_data:X(E).chartData,rr_intervals:X(E).rrIntervals};(await Ho(c().user,I)).success?(Ce(H,!0),setTimeout(()=>{_i("/home")},2e3)):Ce(U,"Failed to save HRV session. Please try again.")}catch(I){console.error("Error saving HRV session:",I),Ce(U,"An unexpected error occurred. Please try again.")}finally{Ce(_,!1)}}}function k(){gs(),Ce(P,!1),Ce(L,!1),Ce(E,null),rs(),_i("/home")}function Q(I){const F=Math.floor(I/60),Y=I%60;return`${F}:${Y.toString().padStart(2,"0")}`}Mo(()=>{const I=x();return()=>{I==null||I(),te(),rs()}}),Eo(()=>{v&&clearInterval(v),rs()}),Ao(()=>(X(m),r()),()=>{X(m)&&r().chartData.length>0&&ee()}),Po(),Do();var V=Yc(),K=_e(ue(V),2);{var B=I=>{var F=Wc(),Y=_e(ue(F),2);{var z=le=>{var Z=Nc(),$e=ue(Z,!0);fe(Z),gn(()=>xt($e,X(W))),Ut(le,Z)};ul(Y,le=>{X(W)&&le(z)})}var D=_e(Y,2),se=_e(D,2);{var be=le=>{var Z=Oc();Ut(le,Z)};ul(se,le=>{ds()||le(be)})}fe(F),vn("click",D,J),Ut(I,F)},ie=I=>{var F=Bc(),Y=ue(F),z=ue(Y),D=ue(z);let se;var be=_e(D,2),le=ue(be,!0);fe(be),fe(z);var Z=_e(z,2),$e=ue(Z,!0);fe(Z),fe(Y);var Le=_e(Y,2),de=ue(Le),Qe=ue(de),st=ue(Qe,!0);fe(Qe),is(2),fe(de);var Fe=_e(de,2),ot=ue(Fe),Tt=ue(ot,!0);fe(ot),is(2),fe(Fe);var Mt=_e(Fe,2),Et=ue(Mt),dt=ue(Et,!0);fe(Et),is(2),fe(Mt),fe(Le);var gt=_e(Le,2);Vo(gt,ae=>Ce(p,ae),()=>X(p));var Re=_e(gt,2),At=_e(ue(Re),2),Xe=ue(At),Ee=_e(Xe,2),G=ue(Ee,!0);fe(Ee),fe(At),fe(Re);var T=_e(Re,2);fe(F),gn((ae,ve,vt)=>{se=Co(D,1,"status-indicator svelte-1gmyyn0",null,se,ae),xt(le,u().connected?`Connected to ${u().deviceName}`:"Disconnected"),xt($e,ve),xt(st,r().heartRate),xt(Tt,vt),xt(dt,r().vibeScore),Io(Xe,`transform: scale(${X(S)==="inhale"?.8+X(g)/100*.4:1.2-X(g)/100*.4});`),xt(G,X(S)==="inhale"?"Inhale":"Exhale")},[()=>({connected:u().connected}),()=>Q(h().elapsedSeconds),()=>r().rmssd.toFixed(1)],wi),vn("click",T,ne),Ut(I,F)};ul(K,I=>{X(P)?I(ie,!1):I(B)})}var N=_e(K,2);{var qe=I=>{var F=Uc(),Y=ue(F),z=_e(ue(Y),2),D=ue(z),se=_e(ue(D),2),be=ue(se,!0);fe(se),fe(D);var le=_e(D,2),Z=_e(ue(le),2),$e=ue(Z);fe(Z),fe(le);var Le=_e(le,2),de=_e(ue(Le),2),Qe=ue(de);fe(de),fe(Le);var st=_e(Le,2),Fe=_e(ue(st),2),ot=ue(Fe,!0);fe(Fe),fe(st),fe(z);var Tt=_e(z,2);{var Mt=Ee=>{var G=Gc(),T=ue(G,!0);fe(G),gn(()=>xt(T,X(U))),Ut(Ee,G)};ul(Tt,Ee=>{X(U)&&Ee(Mt)})}var Et=_e(Tt,2),dt=ue(Et),gt=ue(dt);{var Re=Ee=>{var G=ss("Saving...");Ut(Ee,G)},At=(Ee,G)=>{{var T=ve=>{var vt=ss("Saved!");Ut(ve,vt)},ae=ve=>{var vt=ss("Save Session");Ut(ve,vt)};ul(Ee,ve=>{X(H)?ve(T):ve(ae,!1)},G)}};ul(gt,Ee=>{X(_)?Ee(Re):Ee(At,!1)})}fe(dt);var Xe=_e(dt,2);fe(Et),fe(Y),fe(F),gn((Ee,G)=>{xt(be,Ee),xt($e,`${X(E).avgHR??""} bpm`),xt(Qe,`${G??""} ms`),xt(ot,X(E).avgVibe),dt.disabled=X(_)||X(H),Xe.disabled=X(_)||X(H)},[()=>Q(X(E).durationSeconds),()=>X(E).avgRMSSD.toFixed(1)],wi),vn("click",dt,j),vn("click",Xe,k),Ut(I,F)};ul(N,I=>{X(L)&&X(E)&&I(qe)})}fe(V),Ut(e,V),Lo(),n()}export{nu as component};
