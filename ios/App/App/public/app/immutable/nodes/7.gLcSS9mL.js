const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["../chunks/D7Jg-ab8.js","../chunks/B1jByD-r.js","../chunks/Dp1pzeXC.js"])))=>i.map(i=>d[i]);
import{t as wl,a as Yt,b as os}from"../chunks/CSgteSvS.js";import"../chunks/D2hW0EMZ.js";import{n as bi,q as Pr,ao as Rr,ap as Lr,r as Cr,x as me,v as se,b as ne,m as $t,w as ie,y as rs,i as He,t as vn,d as yi}from"../chunks/jbLWzUtC.js";import{e as wn,s as ft}from"../chunks/SNwGAtB4.js";import{i as hl}from"../chunks/DK1W6Ej9.js";import{t as Vr,s as xi}from"../chunks/CvgfbjKt.js";import{b as Hr}from"../chunks/jUTo_GiH.js";import{i as zr}from"../chunks/sG7jKqtR.js";import{s as Fr,a as _n}from"../chunks/Ul0UnCso.js";import{g as En,w as Ms,o as Ir,a as Br}from"../chunks/CFgcPMXS.js";import{g as Ei}from"../chunks/BAvhnk5Z.js";import{a as Nr}from"../chunks/C36XmJx2.js";import{h as Or}from"../chunks/BjEy9C_A.js";import{_ as As}from"../chunks/Dp1pzeXC.js";function Gr(e,l,i,n){var o=e.__style;if(bi||o!==l){var c=Vr(l);(!bi||c!==e.getAttribute("style"))&&(c==null?e.removeAttribute("style"):e.style.cssText=c),e.__style=l}return n}const Mn=()=>typeof window.Capacitor<"u";console.log("Environment check:",{isCapacitor:Mn(),hasWebBluetooth:typeof navigator<"u"&&"bluetooth"in navigator});const qt=Ms({connected:!1,deviceName:"",deviceId:"",error:null,scanning:!1}),An=Ms({heartRate:0,rmssd:0,vibeScore:0,rrIntervals:[],chartData:[]}),Il=Ms({startTime:0,currentTime:0,elapsedSeconds:0,isRunning:!1}),gs=()=>Mn()?!0:typeof navigator<"u"&&"bluetooth"in navigator,Wr=async()=>{var e;try{if(!gs())throw new Error("Bluetooth is not supported on this device");if(qt.update(l=>({...l,scanning:!0,error:null})),console.log("Starting BLE scan..."),Mn()){console.log("Using Capacitor BLE implementation");try{const{BleClient:l}=await As(async()=>{const{BleClient:o}=await import("../chunks/D7Jg-ab8.js");return{BleClient:o}},__vite__mapDeps([0,1,2]),import.meta.url);console.log("Initializing BLE client..."),await l.initialize();const i=await l.isEnabled();if(console.log("Bluetooth enabled:",i),!i)try{await l.enable(),console.log("Bluetooth enabled successfully")}catch(o){throw console.error("Failed to enable Bluetooth:",o),new Error("Please enable Bluetooth to connect to your device")}console.log("Requesting device...");const n=await l.requestDevice({services:["0000180d-0000-1000-8000-00805f9b34fb"],namePrefix:"Polar"});return console.log("Device selected:",n),await Ur(n.deviceId,n.name||"Polar Device"),{success:!0}}catch(l){throw console.error("Capacitor BLE error:",l),l}}else{if(console.log("Using Web Bluetooth API implementation"),!("bluetooth"in navigator))throw new Error("Web Bluetooth is not supported in this browser");console.log("Requesting device...");const l=await navigator.bluetooth.requestDevice({filters:[{services:["heart_rate"]},{namePrefix:"Polar"}],optionalServices:["heart_rate"]});console.log("Device selected:",l.name),qt.update(c=>({...c,deviceName:l.name||"Unknown Device",deviceId:l.id})),console.log("Connecting to GATT server...");const i=await((e=l.gatt)==null?void 0:e.connect());if(!i)throw new Error("Failed to connect to GATT server");console.log("Getting Heart Rate service...");const n=await i.getPrimaryService("heart_rate");console.log("Getting Heart Rate Measurement characteristic...");const o=await n.getCharacteristic("heart_rate_measurement");return console.log("Starting notifications..."),await o.startNotifications(),console.log("Adding event listener for heart rate measurements..."),o.addEventListener("characteristicvaluechanged",$r),qt.update(c=>({...c,connected:!0,scanning:!1})),l.addEventListener("gattserverdisconnected",()=>{console.log("Device disconnected"),qt.update(u=>({...u,connected:!1,error:new Error("Device disconnected")})),En(Il).isRunning&&Ps()}),{success:!0}}}catch(l){return console.error("BLE scan error:",l),qt.update(i=>({...i,scanning:!1,error:l instanceof Error?l:new Error("Unknown BLE error")})),{success:!1,error:l instanceof Error?l:new Error("Unknown BLE error")}}};async function Ur(e,l){try{console.log("Connecting to Capacitor device:",e,l);const{BleClient:i}=await As(async()=>{const{BleClient:c}=await import("../chunks/D7Jg-ab8.js");return{BleClient:c}},__vite__mapDeps([0,1,2]),import.meta.url);console.log("Establishing connection..."),await i.connect(e),console.log("Connected successfully"),qt.update(c=>({...c,deviceName:l,deviceId:e,connected:!0,scanning:!1}));const n="0000180d-0000-1000-8000-00805f9b34fb",o="00002a37-0000-1000-8000-00805f9b34fb";console.log("Starting notifications for heart rate..."),await i.startNotifications(e,n,o,c=>{const u=new DataView(c.buffer);Yr(u)}),console.log("Notifications started successfully"),ho()}catch(i){console.error("Error connecting to Capacitor device:",i),qt.update(n=>({...n,connected:!1,scanning:!1,error:i instanceof Error?i:new Error("Failed to connect to device")}))}}function Yr(e){const l=e.getUint8(0),i=l&1,n=i?e.getUint16(1,!0):e.getUint8(1),o=[];if(l&16){const c=i?3:2;for(let u=c;u<e.byteLength;u+=2){const h=e.getUint16(u,!0)/1024*1e3;o.push(h)}}fo(n,o)}const $r=e=>{const l=e.target.value;if(!l)return;const i=l.getUint8(0),n=i&1,o=n?l.getUint16(1,!0):l.getUint8(1),c=[];if(i&16){const u=n?3:2;for(let h=u;h<l.byteLength;h+=2){const p=l.getUint16(h,!0)/1024*1e3;c.push(p)}}fo(o,c)},fo=(e,l)=>{An.update(i=>{const o=[...i.rrIntervals,...l].slice(-64);let c=0;if(o.length>1){let g=0;for(let v=1;v<o.length;v++){const P=o[v]-o[v-1];g+=P*P}c=Math.sqrt(g/(o.length-1))}const u=Math.min(100,Math.max(0,c/100*100)),h=Math.round(u),p=new Date().toISOString(),_=[...i.chartData,{timestamp:p,hr:e,rmssd:c,vibe:h}].slice(-300);return{heartRate:e,rmssd:c,vibeScore:h,rrIntervals:o,chartData:_}})},as=async()=>{try{const e=En(qt).deviceId;if(e&&Mn())try{const{BleClient:l}=await As(async()=>{const{BleClient:i}=await import("../chunks/D7Jg-ab8.js");return{BleClient:i}},__vite__mapDeps([0,1,2]),import.meta.url);await l.disconnect(e)}catch(l){console.error("Error disconnecting from Capacitor device:",l)}return qt.set({connected:!1,deviceName:"",deviceId:"",error:null,scanning:!1}),vs(),Ps(),{success:!0}}catch(e){return console.error("BLE disconnect error:",e),{success:!1,error:e instanceof Error?e:new Error("Unknown BLE error")}}},vs=()=>{An.set({heartRate:0,rmssd:0,vibeScore:0,rrIntervals:[],chartData:[]})},ho=()=>{const e=Date.now();Il.set({startTime:e,currentTime:e,elapsedSeconds:0,isRunning:!0});const l=setInterval(()=>{Il.update(i=>{if(!i.isRunning)return clearInterval(l),i;const n=Date.now(),o=Math.floor((n-i.startTime)/1e3);return{...i,currentTime:n,elapsedSeconds:o}})},1e3)},Ps=()=>{Il.update(e=>({...e,isRunning:!1}))},Kr=()=>{const e=En(An),l=En(Il),i=e.chartData;let n=0,o=0,c=0;i.forEach(d=>{n+=d.hr,o+=d.rmssd,c+=d.vibe});const u=i.length?Math.round(n/i.length):0,h=i.length?Math.round(o/i.length*10)/10:0,p=i.length?Math.round(c/i.length):0;return{startTime:new Date(l.startTime).toISOString(),endTime:new Date(l.currentTime).toISOString(),durationSeconds:l.elapsedSeconds,avgHR:u,avgRMSSD:h,avgVibe:p,chartData:i,rrIntervals:e.rrIntervals}},qr=!0,Ie="u-",jr="uplot",Jr=Ie+"hz",Zr=Ie+"vt",Qr=Ie+"title",Xr=Ie+"wrap",ea=Ie+"under",ta=Ie+"over",la=Ie+"axis",ml=Ie+"off",na=Ie+"select",sa=Ie+"cursor-x",ia=Ie+"cursor-y",oa=Ie+"cursor-pt",ra=Ie+"legend",aa=Ie+"live",ca=Ie+"inline",ua=Ie+"series",fa=Ie+"marker",Ti=Ie+"label",ha=Ie+"value",ln="width",nn="height",en="top",Di="bottom",Hl="left",cs="right",Rs="#000",ki=Rs+"0",us="mousemove",Mi="mousedown",fs="mouseup",Ai="mouseenter",Pi="mouseleave",Ri="dblclick",pa="resize",da="scroll",Li="change",Tn="dppxchange",Ls="--",Wl=typeof window<"u",ws=Wl?document:null,Fl=Wl?window:null,ma=Wl?navigator:null;let ge,Sn;function _s(){let e=devicePixelRatio;ge!=e&&(ge=e,Sn&&bs(Li,Sn,_s),Sn=matchMedia(`(min-resolution: ${ge-.001}dppx) and (max-resolution: ${ge+.001}dppx)`),gl(Li,Sn,_s),Fl.dispatchEvent(new CustomEvent(Tn)))}function vt(e,l){if(l!=null){let i=e.classList;!i.contains(l)&&i.add(l)}}function Ss(e,l){let i=e.classList;i.contains(l)&&i.remove(l)}function De(e,l,i){e.style[l]=i+"px"}function Ht(e,l,i,n){let o=ws.createElement(e);return l!=null&&vt(o,l),i!=null&&i.insertBefore(o,n),o}function Dt(e,l){return Ht("div",e,l)}const Ci=new WeakMap;function Kt(e,l,i,n,o){let c="translate("+l+"px,"+i+"px)",u=Ci.get(e);c!=u&&(e.style.transform=c,Ci.set(e,c),l<0||i<0||l>n||i>o?vt(e,ml):Ss(e,ml))}const Vi=new WeakMap;function Hi(e,l,i){let n=l+i,o=Vi.get(e);n!=o&&(Vi.set(e,n),e.style.background=l,e.style.borderColor=i)}const zi=new WeakMap;function Fi(e,l,i,n){let o=l+""+i,c=zi.get(e);o!=c&&(zi.set(e,o),e.style.height=i+"px",e.style.width=l+"px",e.style.marginLeft=n?-l/2+"px":0,e.style.marginTop=n?-i/2+"px":0)}const Cs={passive:!0},ga={...Cs,capture:!0};function gl(e,l,i,n){l.addEventListener(e,i,n?ga:Cs)}function bs(e,l,i,n){l.removeEventListener(e,i,Cs)}Wl&&_s();function zt(e,l,i,n){let o;i=i||0,n=n||l.length-1;let c=n<=2147483647;for(;n-i>1;)o=c?i+n>>1:wt((i+n)/2),l[o]<e?i=o:n=o;return e-l[i]<=l[n]-e?i:n}function po(e){return(i,n,o)=>{let c=-1,u=-1;for(let h=n;h<=o;h++)if(e(i[h])){c=h;break}for(let h=o;h>=n;h--)if(e(i[h])){u=h;break}return[c,u]}}const mo=e=>e!=null,go=e=>e!=null&&e>0,Pn=po(mo),va=po(go);function wa(e,l,i,n=0,o=!1){let c=o?va:Pn,u=o?go:mo;[l,i]=c(e,l,i);let h=e[l],p=e[l];if(l>-1)if(n==1)h=e[l],p=e[i];else if(n==-1)h=e[i],p=e[l];else for(let d=l;d<=i;d++){let _=e[d];u(_)&&(_<h?h=_:_>p&&(p=_))}return[h??Se,p??-Se]}function Rn(e,l,i,n){let o=Ni(e),c=Ni(l);e==l&&(o==-1?(e*=i,l/=i):(e/=i,l*=i));let u=i==10?Zt:vo,h=o==1?wt:kt,p=c==1?kt:wt,d=h(u(Fe(e))),_=p(u(Fe(l))),g=Bl(i,d),v=Bl(i,_);return i==10&&(d<0&&(g=be(g,-d)),_<0&&(v=be(v,-_))),n||i==2?(e=g*o,l=v*c):(e=bo(e,g),l=Ln(l,v)),[e,l]}function Vs(e,l,i,n){let o=Rn(e,l,i,n);return e==0&&(o[0]=0),l==0&&(o[1]=0),o}const Hs=.1,Ii={mode:3,pad:Hs},on={pad:0,soft:null,mode:0},_a={min:on,max:on};function Dn(e,l,i,n){return Cn(i)?Bi(e,l,i):(on.pad=i,on.soft=n?0:null,on.mode=n?3:0,Bi(e,l,_a))}function fe(e,l){return e??l}function Sa(e,l,i){for(l=fe(l,0),i=fe(i,e.length-1);l<=i;){if(e[l]!=null)return!0;l++}return!1}function Bi(e,l,i){let n=i.min,o=i.max,c=fe(n.pad,0),u=fe(o.pad,0),h=fe(n.hard,-Se),p=fe(o.hard,Se),d=fe(n.soft,Se),_=fe(o.soft,-Se),g=fe(n.mode,0),v=fe(o.mode,0),P=l-e,R=Zt(P),M=rt(Fe(e),Fe(l)),O=Zt(M),U=Fe(O-R);(P<1e-24||U>10)&&(P=0,(e==0||l==0)&&(P=1e-24,g==2&&d!=Se&&(c=0),v==2&&_!=-Se&&(u=0)));let b=P||M||1e3,I=Zt(b),x=Bl(10,wt(I)),X=b*(P==0?e==0?.1:1:c),L=be(bo(e-X,x/10),24),ee=e>=d&&(g==1||g==3&&L<=d||g==2&&L>=d)?d:Se,J=rt(h,L<ee&&e>=ee?ee:Ft(ee,L)),oe=b*(P==0?l==0?.1:1:u),q=be(Ln(l+oe,x/10),24),E=l<=_&&(v==1||v==3&&q>=_||v==2&&q<=_)?_:-Se,Z=Ft(p,q>E&&l<=E?E:rt(E,q));return J==Z&&J==0&&(Z=100),[J,Z]}const ba=new Intl.NumberFormat(Wl?ma.language:"en-US"),zs=e=>ba.format(e),_t=Math,xn=_t.PI,Fe=_t.abs,wt=_t.floor,ze=_t.round,kt=_t.ceil,Ft=_t.min,rt=_t.max,Bl=_t.pow,Ni=_t.sign,Zt=_t.log10,vo=_t.log2,ya=(e,l=1)=>_t.sinh(e)*l,hs=(e,l=1)=>_t.asinh(e/l),Se=1/0;function Oi(e){return(Zt((e^e>>31)-(e>>31))|0)+1}function ys(e,l,i){return Ft(rt(e,l),i)}function wo(e){return typeof e=="function"}function ce(e){return wo(e)?e:()=>e}const xa=()=>{},_o=e=>e,So=(e,l)=>l,Ea=e=>null,Gi=e=>!0,Wi=(e,l)=>e==l,Ta=/\.\d*?(?=9{6,}|0{6,})/gm,vl=e=>{if(xo(e)||ol.has(e))return e;const l=`${e}`,i=l.match(Ta);if(i==null)return e;let n=i[0].length-1;if(l.indexOf("e-")!=-1){let[o,c]=l.split("e");return+`${vl(o)}e${c}`}return be(e,n)};function pl(e,l){return vl(be(vl(e/l))*l)}function Ln(e,l){return vl(kt(vl(e/l))*l)}function bo(e,l){return vl(wt(vl(e/l))*l)}function be(e,l=0){if(xo(e))return e;let i=10**l,n=e*i*(1+Number.EPSILON);return ze(n)/i}const ol=new Map;function yo(e){return((""+e).split(".")[1]||"").length}function an(e,l,i,n){let o=[],c=n.map(yo);for(let u=l;u<i;u++){let h=Fe(u),p=be(Bl(e,u),h);for(let d=0;d<n.length;d++){let _=e==10?+`${n[d]}e${u}`:n[d]*p,g=(u>=0?0:h)+(u>=c[d]?0:c[d]),v=e==10?_:be(_,g);o.push(v),ol.set(v,g)}}return o}const rn={},Fs=[],Nl=[null,null],il=Array.isArray,xo=Number.isInteger,Da=e=>e===void 0;function Ui(e){return typeof e=="string"}function Cn(e){let l=!1;if(e!=null){let i=e.constructor;l=i==null||i==Object}return l}function ka(e){return e!=null&&typeof e=="object"}const Ma=Object.getPrototypeOf(Uint8Array),Eo="__proto__";function Ol(e,l=Cn){let i;if(il(e)){let n=e.find(o=>o!=null);if(il(n)||l(n)){i=Array(e.length);for(let o=0;o<e.length;o++)i[o]=Ol(e[o],l)}else i=e.slice()}else if(e instanceof Ma)i=e.slice();else if(l(e)){i={};for(let n in e)n!=Eo&&(i[n]=Ol(e[n],l))}else i=e;return i}function Ve(e){let l=arguments;for(let i=1;i<l.length;i++){let n=l[i];for(let o in n)o!=Eo&&(Cn(e[o])?Ve(e[o],Ol(n[o])):e[o]=Ol(n[o]))}return e}const Aa=0,Pa=1,Ra=2;function La(e,l,i){for(let n=0,o,c=-1;n<l.length;n++){let u=l[n];if(u>c){for(o=u-1;o>=0&&e[o]==null;)e[o--]=null;for(o=u+1;o<i&&e[o]==null;)e[c=o++]=null}}}function Ca(e,l){if(za(e)){let u=e[0].slice();for(let h=1;h<e.length;h++)u.push(...e[h].slice(1));return Fa(u[0])||(u=Ha(u)),u}let i=new Set;for(let u=0;u<e.length;u++){let p=e[u][0],d=p.length;for(let _=0;_<d;_++)i.add(p[_])}let n=[Array.from(i).sort((u,h)=>u-h)],o=n[0].length,c=new Map;for(let u=0;u<o;u++)c.set(n[0][u],u);for(let u=0;u<e.length;u++){let h=e[u],p=h[0];for(let d=1;d<h.length;d++){let _=h[d],g=Array(o).fill(void 0),v=l?l[u][d]:Pa,P=[];for(let R=0;R<_.length;R++){let M=_[R],O=c.get(p[R]);M===null?v!=Aa&&(g[O]=M,v==Ra&&P.push(O)):g[O]=M}La(g,P,o),n.push(g)}}return n}const Va=typeof queueMicrotask>"u"?e=>Promise.resolve().then(e):queueMicrotask;function Ha(e){let l=e[0],i=l.length,n=Array(i);for(let c=0;c<n.length;c++)n[c]=c;n.sort((c,u)=>l[c]-l[u]);let o=[];for(let c=0;c<e.length;c++){let u=e[c],h=Array(i);for(let p=0;p<i;p++)h[p]=u[n[p]];o.push(h)}return o}function za(e){let l=e[0][0],i=l.length;for(let n=1;n<e.length;n++){let o=e[n][0];if(o.length!=i)return!1;if(o!=l){for(let c=0;c<i;c++)if(o[c]!=l[c])return!1}}return!0}function Fa(e,l=100){const i=e.length;if(i<=1)return!0;let n=0,o=i-1;for(;n<=o&&e[n]==null;)n++;for(;o>=n&&e[o]==null;)o--;if(o<=n)return!0;const c=rt(1,wt((o-n+1)/l));for(let u=e[n],h=n+c;h<=o;h+=c){const p=e[h];if(p!=null){if(p<=u)return!1;u=p}}return!0}const To=["January","February","March","April","May","June","July","August","September","October","November","December"],Do=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];function ko(e){return e.slice(0,3)}const Ia=Do.map(ko),Ba=To.map(ko),Na={MMMM:To,MMM:Ba,WWWW:Do,WWW:Ia};function tn(e){return(e<10?"0":"")+e}function Oa(e){return(e<10?"00":e<100?"0":"")+e}const Ga={YYYY:e=>e.getFullYear(),YY:e=>(e.getFullYear()+"").slice(2),MMMM:(e,l)=>l.MMMM[e.getMonth()],MMM:(e,l)=>l.MMM[e.getMonth()],MM:e=>tn(e.getMonth()+1),M:e=>e.getMonth()+1,DD:e=>tn(e.getDate()),D:e=>e.getDate(),WWWW:(e,l)=>l.WWWW[e.getDay()],WWW:(e,l)=>l.WWW[e.getDay()],HH:e=>tn(e.getHours()),H:e=>e.getHours(),h:e=>{let l=e.getHours();return l==0?12:l>12?l-12:l},AA:e=>e.getHours()>=12?"PM":"AM",aa:e=>e.getHours()>=12?"pm":"am",a:e=>e.getHours()>=12?"p":"a",mm:e=>tn(e.getMinutes()),m:e=>e.getMinutes(),ss:e=>tn(e.getSeconds()),s:e=>e.getSeconds(),fff:e=>Oa(e.getMilliseconds())};function Is(e,l){l=l||Na;let i=[],n=/\{([a-z]+)\}|[^{]+/gi,o;for(;o=n.exec(e);)i.push(o[0][0]=="{"?Ga[o[1]]:o[0]);return c=>{let u="";for(let h=0;h<i.length;h++)u+=typeof i[h]=="string"?i[h]:i[h](c,l);return u}}const Wa=new Intl.DateTimeFormat().resolvedOptions().timeZone;function Ua(e,l){let i;return l=="UTC"||l=="Etc/UTC"?i=new Date(+e+e.getTimezoneOffset()*6e4):l==Wa?i=e:(i=new Date(e.toLocaleString("en-US",{timeZone:l})),i.setMilliseconds(e.getMilliseconds())),i}const Mo=e=>e%1==0,kn=[1,2,2.5,5],Ya=an(10,-32,0,kn),Ao=an(10,0,32,kn),$a=Ao.filter(Mo),dl=Ya.concat(Ao),Bs=`
`,Po="{YYYY}",Yi=Bs+Po,Ro="{M}/{D}",sn=Bs+Ro,bn=sn+"/{YY}",Lo="{aa}",Ka="{h}:{mm}",zl=Ka+Lo,$i=Bs+zl,Ki=":{ss}",we=null;function Co(e){let l=e*1e3,i=l*60,n=i*60,o=n*24,c=o*30,u=o*365,p=(e==1?an(10,0,3,kn).filter(Mo):an(10,-3,0,kn)).concat([l,l*5,l*10,l*15,l*30,i,i*5,i*10,i*15,i*30,n,n*2,n*3,n*4,n*6,n*8,n*12,o,o*2,o*3,o*4,o*5,o*6,o*7,o*8,o*9,o*10,o*15,c,c*2,c*3,c*4,c*6,u,u*2,u*5,u*10,u*25,u*50,u*100]);const d=[[u,Po,we,we,we,we,we,we,1],[o*28,"{MMM}",Yi,we,we,we,we,we,1],[o,Ro,Yi,we,we,we,we,we,1],[n,"{h}"+Lo,bn,we,sn,we,we,we,1],[i,zl,bn,we,sn,we,we,we,1],[l,Ki,bn+" "+zl,we,sn+" "+zl,we,$i,we,1],[e,Ki+".{fff}",bn+" "+zl,we,sn+" "+zl,we,$i,we,1]];function _(g){return(v,P,R,M,O,U)=>{let b=[],I=O>=u,x=O>=c&&O<u,X=g(R),L=be(X*e,3),ee=ps(X.getFullYear(),I?0:X.getMonth(),x||I?1:X.getDate()),J=be(ee*e,3);if(x||I){let oe=x?O/c:0,q=I?O/u:0,E=L==J?L:be(ps(ee.getFullYear()+q,ee.getMonth()+oe,1)*e,3),Z=new Date(ze(E/e)),H=Z.getFullYear(),K=Z.getMonth();for(let G=0;E<=M;G++){let re=ps(H+q*G,K+oe*G,1),B=re-g(be(re*e,3));E=be((+re+B)*e,3),E<=M&&b.push(E)}}else{let oe=O>=o?o:O,q=wt(R)-wt(L),E=J+q+Ln(L-J,oe);b.push(E);let Z=g(E),H=Z.getHours()+Z.getMinutes()/i+Z.getSeconds()/n,K=O/n,G=v.axes[P]._space,re=U/G;for(;E=be(E+O,e==1?0:3),!(E>M);)if(K>1){let B=wt(be(H+K,6))%24,F=g(E).getHours()-B;F>1&&(F=-1),E-=F*n,H=(H+K)%24;let Y=b[b.length-1];be((E-Y)/O,3)*re>=.7&&b.push(E)}else b.push(E)}return b}}return[p,d,_]}const[qa,ja,Ja]=Co(1),[Za,Qa,Xa]=Co(.001);an(2,-53,53,[1]);function qi(e,l){return e.map(i=>i.map((n,o)=>o==0||o==8||n==null?n:l(o==1||i[8]==0?n:i[1]+n)))}function ji(e,l){return(i,n,o,c,u)=>{let h=l.find(R=>u>=R[0])||l[l.length-1],p,d,_,g,v,P;return n.map(R=>{let M=e(R),O=M.getFullYear(),U=M.getMonth(),b=M.getDate(),I=M.getHours(),x=M.getMinutes(),X=M.getSeconds(),L=O!=p&&h[2]||U!=d&&h[3]||b!=_&&h[4]||I!=g&&h[5]||x!=v&&h[6]||X!=P&&h[7]||h[1];return p=O,d=U,_=b,g=I,v=x,P=X,L(M)})}}function ec(e,l){let i=Is(l);return(n,o,c,u,h)=>o.map(p=>i(e(p)))}function ps(e,l,i){return new Date(e,l,i)}function Ji(e,l){return l(e)}const tc="{YYYY}-{MM}-{DD} {h}:{mm}{aa}";function Zi(e,l){return(i,n,o,c)=>c==null?Ls:l(e(n))}function lc(e,l){let i=e.series[l];return i.width?i.stroke(e,l):i.points.width?i.points.stroke(e,l):null}function nc(e,l){return e.series[l].fill(e,l)}const sc={show:!0,live:!0,isolate:!1,mount:xa,markers:{show:!0,width:2,stroke:lc,fill:nc,dash:"solid"},idx:null,idxs:null,values:[]};function ic(e,l){let i=e.cursor.points,n=Dt(),o=i.size(e,l);De(n,ln,o),De(n,nn,o);let c=o/-2;De(n,"marginLeft",c),De(n,"marginTop",c);let u=i.width(e,l,o);return u&&De(n,"borderWidth",u),n}function oc(e,l){let i=e.series[l].points;return i._fill||i._stroke}function rc(e,l){let i=e.series[l].points;return i._stroke||i._fill}function ac(e,l){return e.series[l].points.size}const ds=[0,0];function cc(e,l,i){return ds[0]=l,ds[1]=i,ds}function yn(e,l,i,n=!0){return o=>{o.button==0&&(!n||o.target==l)&&i(o)}}function ms(e,l,i,n=!0){return o=>{(!n||o.target==l)&&i(o)}}const uc={show:!0,x:!0,y:!0,lock:!1,move:cc,points:{one:!1,show:ic,size:ac,width:0,stroke:rc,fill:oc},bind:{mousedown:yn,mouseup:yn,click:yn,dblclick:yn,mousemove:ms,mouseleave:ms,mouseenter:ms},drag:{setScale:!0,x:!0,y:!1,dist:0,uni:null,click:(e,l)=>{l.stopPropagation(),l.stopImmediatePropagation()},_x:!1,_y:!1},focus:{dist:(e,l,i,n,o)=>n-o,prox:-1,bias:0},hover:{skip:[void 0],prox:null,bias:0},left:-10,top:-10,idx:null,dataIdx:null,idxs:null,event:null},Vo={show:!0,stroke:"rgba(0,0,0,0.07)",width:2},Ns=Ve({},Vo,{filter:So}),Ho=Ve({},Ns,{size:10}),zo=Ve({},Vo,{show:!1}),Os='12px system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji"',Fo="bold "+Os,Io=1.5,Qi={show:!0,scale:"x",stroke:Rs,space:50,gap:5,alignTo:1,size:50,labelGap:0,labelSize:30,labelFont:Fo,side:2,grid:Ns,ticks:Ho,border:zo,font:Os,lineGap:Io,rotate:0},fc="Value",hc="Time",Xi={show:!0,scale:"x",auto:!1,sorted:1,min:Se,max:-Se,idxs:[]};function pc(e,l,i,n,o){return l.map(c=>c==null?"":zs(c))}function dc(e,l,i,n,o,c,u){let h=[],p=ol.get(o)||0;i=u?i:be(Ln(i,o),p);for(let d=i;d<=n;d=be(d+o,p))h.push(Object.is(d,-0)?0:d);return h}function xs(e,l,i,n,o,c,u){const h=[],p=e.scales[e.axes[l].scale].log,d=p==10?Zt:vo,_=wt(d(i));o=Bl(p,_),p==10&&(o=dl[zt(o,dl)]);let g=i,v=o*p;p==10&&(v=dl[zt(v,dl)]);do h.push(g),g=g+o,p==10&&!ol.has(g)&&(g=be(g,ol.get(o))),g>=v&&(o=g,v=o*p,p==10&&(v=dl[zt(v,dl)]));while(g<=n);return h}function mc(e,l,i,n,o,c,u){let p=e.scales[e.axes[l].scale].asinh,d=n>p?xs(e,l,rt(p,i),n,o):[p],_=n>=0&&i<=0?[0]:[];return(i<-p?xs(e,l,rt(p,-n),-i,o):[p]).reverse().map(v=>-v).concat(_,d)}const Bo=/./,gc=/[12357]/,vc=/[125]/,eo=/1/,Es=(e,l,i,n)=>e.map((o,c)=>l==4&&o==0||c%n==0&&i.test(o.toExponential()[o<0?1:0])?o:null);function wc(e,l,i,n,o){let c=e.axes[i],u=c.scale,h=e.scales[u],p=e.valToPos,d=c._space,_=p(10,u),g=p(9,u)-_>=d?Bo:p(7,u)-_>=d?gc:p(5,u)-_>=d?vc:eo;if(g==eo){let v=Fe(p(1,u)-_);if(v<d)return Es(l.slice().reverse(),h.distr,g,kt(d/v)).reverse()}return Es(l,h.distr,g,1)}function _c(e,l,i,n,o){let c=e.axes[i],u=c.scale,h=c._space,p=e.valToPos,d=Fe(p(1,u)-p(2,u));return d<h?Es(l.slice().reverse(),3,Bo,kt(h/d)).reverse():l}function Sc(e,l,i,n){return n==null?Ls:l==null?"":zs(l)}const to={show:!0,scale:"y",stroke:Rs,space:30,gap:5,alignTo:1,size:50,labelGap:0,labelSize:30,labelFont:Fo,side:3,grid:Ns,ticks:Ho,border:zo,font:Os,lineGap:Io,rotate:0};function bc(e,l){let i=3+(e||1)*2;return be(i*l,3)}function yc(e,l){let{scale:i,idxs:n}=e.series[0],o=e._data[0],c=e.valToPos(o[n[0]],i,!0),u=e.valToPos(o[n[1]],i,!0),h=Fe(u-c),p=e.series[l],d=h/(p.points.space*ge);return n[1]-n[0]<=d}const lo={scale:null,auto:!0,sorted:0,min:Se,max:-Se},No=(e,l,i,n,o)=>o,no={show:!0,auto:!0,sorted:0,gaps:No,alpha:1,facets:[Ve({},lo,{scale:"x"}),Ve({},lo,{scale:"y"})]},so={scale:"y",auto:!0,sorted:0,show:!0,spanGaps:!1,gaps:No,alpha:1,points:{show:yc,filter:null},values:null,min:Se,max:-Se,idxs:[],path:null,clip:null};function xc(e,l,i,n,o){return i/10}const Oo={time:qr,auto:!0,distr:1,log:10,asinh:1,min:null,max:null,dir:1,ori:0},Ec=Ve({},Oo,{time:!1,ori:1}),io={};function Go(e,l){let i=io[e];return i||(i={key:e,plots:[],sub(n){i.plots.push(n)},unsub(n){i.plots=i.plots.filter(o=>o!=n)},pub(n,o,c,u,h,p,d){for(let _=0;_<i.plots.length;_++)i.plots[_]!=o&&i.plots[_].pub(n,o,c,u,h,p,d)}},e!=null&&(io[e]=i)),i}const Gl=1,Ts=2;function _l(e,l,i){const n=e.mode,o=e.series[l],c=n==2?e._data[l]:e._data,u=e.scales,h=e.bbox;let p=c[0],d=n==2?c[1]:c[l],_=n==2?u[o.facets[0].scale]:u[e.series[0].scale],g=n==2?u[o.facets[1].scale]:u[o.scale],v=h.left,P=h.top,R=h.width,M=h.height,O=e.valToPosH,U=e.valToPosV;return _.ori==0?i(o,p,d,_,g,O,U,v,P,R,M,Hn,Ul,Fn,Uo,$o):i(o,p,d,_,g,U,O,P,v,M,R,zn,Yl,Us,Yo,Ko)}function Gs(e,l){let i=0,n=0,o=fe(e.bands,Fs);for(let c=0;c<o.length;c++){let u=o[c];u.series[0]==l?i=u.dir:u.series[1]==l&&(u.dir==1?n|=1:n|=2)}return[i,n==1?-1:n==2?1:n==3?2:0]}function Tc(e,l,i,n,o){let c=e.mode,u=e.series[l],h=c==2?u.facets[1].scale:u.scale,p=e.scales[h];return o==-1?p.min:o==1?p.max:p.distr==3?p.dir==1?p.min:p.max:0}function Qt(e,l,i,n,o,c){return _l(e,l,(u,h,p,d,_,g,v,P,R,M,O)=>{let U=u.pxRound;const b=d.dir*(d.ori==0?1:-1),I=d.ori==0?Ul:Yl;let x,X;b==1?(x=i,X=n):(x=n,X=i);let L=U(g(h[x],d,M,P)),ee=U(v(p[x],_,O,R)),J=U(g(h[X],d,M,P)),oe=U(v(c==1?_.max:_.min,_,O,R)),q=new Path2D(o);return I(q,J,oe),I(q,L,oe),I(q,L,ee),q})}function Vn(e,l,i,n,o,c){let u=null;if(e.length>0){u=new Path2D;const h=l==0?Fn:Us;let p=i;for(let g=0;g<e.length;g++){let v=e[g];if(v[1]>v[0]){let P=v[0]-p;P>0&&h(u,p,n,P,n+c),p=v[1]}}let d=i+o-p,_=10;d>0&&h(u,p,n-_/2,d,n+c+_)}return u}function Dc(e,l,i){let n=e[e.length-1];n&&n[0]==l?n[1]=i:e.push([l,i])}function Ws(e,l,i,n,o,c,u){let h=[],p=e.length;for(let d=o==1?i:n;d>=i&&d<=n;d+=o)if(l[d]===null){let g=d,v=d;if(o==1)for(;++d<=n&&l[d]===null;)v=d;else for(;--d>=i&&l[d]===null;)v=d;let P=c(e[g]),R=v==g?P:c(e[v]),M=g-o;P=u<=0&&M>=0&&M<p?c(e[M]):P;let U=v+o;R=u>=0&&U>=0&&U<p?c(e[U]):R,R>=P&&h.push([P,R])}return h}function oo(e){return e==0?_o:e==1?ze:l=>pl(l,e)}function Wo(e){let l=e==0?Hn:zn,i=e==0?(o,c,u,h,p,d)=>{o.arcTo(c,u,h,p,d)}:(o,c,u,h,p,d)=>{o.arcTo(u,c,p,h,d)},n=e==0?(o,c,u,h,p)=>{o.rect(c,u,h,p)}:(o,c,u,h,p)=>{o.rect(u,c,p,h)};return(o,c,u,h,p,d=0,_=0)=>{d==0&&_==0?n(o,c,u,h,p):(d=Ft(d,h/2,p/2),_=Ft(_,h/2,p/2),l(o,c+d,u),i(o,c+h,u,c+h,u+p,d),i(o,c+h,u+p,c,u+p,_),i(o,c,u+p,c,u,_),i(o,c,u,c+h,u,d),o.closePath())}}const Hn=(e,l,i)=>{e.moveTo(l,i)},zn=(e,l,i)=>{e.moveTo(i,l)},Ul=(e,l,i)=>{e.lineTo(l,i)},Yl=(e,l,i)=>{e.lineTo(i,l)},Fn=Wo(0),Us=Wo(1),Uo=(e,l,i,n,o,c)=>{e.arc(l,i,n,o,c)},Yo=(e,l,i,n,o,c)=>{e.arc(i,l,n,o,c)},$o=(e,l,i,n,o,c,u)=>{e.bezierCurveTo(l,i,n,o,c,u)},Ko=(e,l,i,n,o,c,u)=>{e.bezierCurveTo(i,l,o,n,u,c)};function qo(e){return(l,i,n,o,c)=>_l(l,i,(u,h,p,d,_,g,v,P,R,M,O)=>{let{pxRound:U,points:b}=u,I,x;d.ori==0?(I=Hn,x=Uo):(I=zn,x=Yo);const X=be(b.width*ge,3);let L=(b.size-b.width)/2*ge,ee=be(L*2,3),J=new Path2D,oe=new Path2D,{left:q,top:E,width:Z,height:H}=l.bbox;Fn(oe,q-ee,E-ee,Z+ee*2,H+ee*2);const K=G=>{if(p[G]!=null){let re=U(g(h[G],d,M,P)),B=U(v(p[G],_,O,R));I(J,re+L,B),x(J,re,B,L,0,xn*2)}};if(c)c.forEach(K);else for(let G=n;G<=o;G++)K(G);return{stroke:X>0?J:null,fill:J,clip:oe,flags:Gl|Ts}})}function jo(e){return(l,i,n,o,c,u)=>{n!=o&&(c!=n&&u!=n&&e(l,i,n),c!=o&&u!=o&&e(l,i,o),e(l,i,u))}}const kc=jo(Ul),Mc=jo(Yl);function Jo(e){const l=fe(e==null?void 0:e.alignGaps,0);return(i,n,o,c)=>_l(i,n,(u,h,p,d,_,g,v,P,R,M,O)=>{[o,c]=Pn(p,o,c);let U=u.pxRound,b=H=>U(g(H,d,M,P)),I=H=>U(v(H,_,O,R)),x,X;d.ori==0?(x=Ul,X=kc):(x=Yl,X=Mc);const L=d.dir*(d.ori==0?1:-1),ee={stroke:new Path2D,fill:null,clip:null,band:null,gaps:null,flags:Gl},J=ee.stroke;let oe=!1;if(c-o>=M*4){let H=T=>i.posToVal(T,d.key,!0),K=null,G=null,re,B,je,z=b(h[L==1?o:c]),F=b(h[o]),Y=b(h[c]),C=H(L==1?F+1:Y-1);for(let T=L==1?o:c;T>=o&&T<=c;T+=L){let le=h[T],te=(L==1?le<C:le>C)?z:b(le),Q=p[T];te==z?Q!=null?(B=Q,K==null?(x(J,te,I(B)),re=K=G=B):B<K?K=B:B>G&&(G=B)):Q===null&&(oe=!0):(K!=null&&X(J,z,I(K),I(G),I(re),I(B)),Q!=null?(B=Q,x(J,te,I(B)),K=G=re=B):(K=G=null,Q===null&&(oe=!0)),z=te,C=H(z+L))}K!=null&&K!=G&&je!=z&&X(J,z,I(K),I(G),I(re),I(B))}else for(let H=L==1?o:c;H>=o&&H<=c;H+=L){let K=p[H];K===null?oe=!0:K!=null&&x(J,b(h[H]),I(K))}let[E,Z]=Gs(i,n);if(u.fill!=null||E!=0){let H=ee.fill=new Path2D(J),K=u.fillTo(i,n,u.min,u.max,E),G=I(K),re=b(h[o]),B=b(h[c]);L==-1&&([B,re]=[re,B]),x(H,B,G),x(H,re,G)}if(!u.spanGaps){let H=[];oe&&H.push(...Ws(h,p,o,c,L,b,l)),ee.gaps=H=u.gaps(i,n,o,c,H),ee.clip=Vn(H,d.ori,P,R,M,O)}return Z!=0&&(ee.band=Z==2?[Qt(i,n,o,c,J,-1),Qt(i,n,o,c,J,1)]:Qt(i,n,o,c,J,Z)),ee})}function Ac(e){const l=fe(e.align,1),i=fe(e.ascDesc,!1),n=fe(e.alignGaps,0),o=fe(e.extend,!1);return(c,u,h,p)=>_l(c,u,(d,_,g,v,P,R,M,O,U,b,I)=>{[h,p]=Pn(g,h,p);let x=d.pxRound,{left:X,width:L}=c.bbox,ee=F=>x(R(F,v,b,O)),J=F=>x(M(F,P,I,U)),oe=v.ori==0?Ul:Yl;const q={stroke:new Path2D,fill:null,clip:null,band:null,gaps:null,flags:Gl},E=q.stroke,Z=v.dir*(v.ori==0?1:-1);let H=J(g[Z==1?h:p]),K=ee(_[Z==1?h:p]),G=K,re=K;o&&l==-1&&(re=X,oe(E,re,H)),oe(E,K,H);for(let F=Z==1?h:p;F>=h&&F<=p;F+=Z){let Y=g[F];if(Y==null)continue;let C=ee(_[F]),T=J(Y);l==1?oe(E,C,H):oe(E,G,T),oe(E,C,T),H=T,G=C}let B=G;o&&l==1&&(B=X+L,oe(E,B,H));let[je,z]=Gs(c,u);if(d.fill!=null||je!=0){let F=q.fill=new Path2D(E),Y=d.fillTo(c,u,d.min,d.max,je),C=J(Y);oe(F,B,C),oe(F,re,C)}if(!d.spanGaps){let F=[];F.push(...Ws(_,g,h,p,Z,ee,n));let Y=d.width*ge/2,C=i||l==1?Y:-Y,T=i||l==-1?-Y:Y;F.forEach(le=>{le[0]+=C,le[1]+=T}),q.gaps=F=d.gaps(c,u,h,p,F),q.clip=Vn(F,v.ori,O,U,b,I)}return z!=0&&(q.band=z==2?[Qt(c,u,h,p,E,-1),Qt(c,u,h,p,E,1)]:Qt(c,u,h,p,E,z)),q})}function ro(e,l,i,n,o,c,u=Se){if(e.length>1){let h=null;for(let p=0,d=1/0;p<e.length;p++)if(l[p]!==void 0){if(h!=null){let _=Fe(e[p]-e[h]);_<d&&(d=_,u=Fe(i(e[p],n,o,c)-i(e[h],n,o,c)))}h=p}}return u}function Pc(e){e=e||rn;const l=fe(e.size,[.6,Se,1]),i=e.align||0,n=e.gap||0;let o=e.radius;o=o==null?[0,0]:typeof o=="number"?[o,0]:o;const c=ce(o),u=1-l[0],h=fe(l[1],Se),p=fe(l[2],1),d=fe(e.disp,rn),_=fe(e.each,P=>{}),{fill:g,stroke:v}=d;return(P,R,M,O)=>_l(P,R,(U,b,I,x,X,L,ee,J,oe,q,E)=>{let Z=U.pxRound,H=i,K=n*ge,G=h*ge,re=p*ge,B,je;x.ori==0?[B,je]=c(P,R):[je,B]=c(P,R);const z=x.dir*(x.ori==0?1:-1);let F=x.ori==0?Fn:Us,Y=x.ori==0?_:(D,he,pe,pt,Rt,bt,Bt)=>{_(D,he,pe,Rt,pt,Bt,bt)},C=fe(P.bands,Fs).find(D=>D.series[0]==R),T=C!=null?C.dir:0,le=U.fillTo(P,R,U.min,U.max,T),ye=Z(ee(le,X,E,oe)),te,Q,Ye,Le=q,ve=Z(U.width*ge),Je=!1,et=null,$e=null,at=null,St=null;g!=null&&(ve==0||v!=null)&&(Je=!0,et=g.values(P,R,M,O),$e=new Map,new Set(et).forEach(D=>{D!=null&&$e.set(D,new Path2D)}),ve>0&&(at=v.values(P,R,M,O),St=new Map,new Set(at).forEach(D=>{D!=null&&St.set(D,new Path2D)})));let{x0:It,size:Mt}=d;if(It!=null&&Mt!=null){H=1,b=It.values(P,R,M,O),It.unit==2&&(b=b.map(pe=>P.posToVal(J+pe*q,x.key,!0)));let D=Mt.values(P,R,M,O);Mt.unit==2?Q=D[0]*q:Q=L(D[0],x,q,J)-L(0,x,q,J),Le=ro(b,I,L,x,q,J,Le),Ye=Le-Q+K}else Le=ro(b,I,L,x,q,J,Le),Ye=Le*u+K,Q=Le-Ye;Ye<1&&(Ye=0),ve>=Q/2&&(ve=0),Ye<5&&(Z=_o);let ht=Ye>0,At=Le-Ye-(ht?ve:0);Q=Z(ys(At,re,G)),te=(H==0?Q/2:H==z?0:Q)-H*z*((H==0?K/2:0)+(ht?ve/2:0));const Re={stroke:null,fill:null,clip:null,band:null,gaps:null,flags:0},Pt=Je?null:new Path2D;let ct=null;if(C!=null)ct=P.data[C.series[1]];else{let{y0:D,y1:he}=d;D!=null&&he!=null&&(I=he.values(P,R,M,O),ct=D.values(P,R,M,O))}let ke=B*Q,W=je*Q;for(let D=z==1?M:O;D>=M&&D<=O;D+=z){let he=I[D];if(he==null)continue;if(ct!=null){let Ze=ct[D]??0;if(he-Ze==0)continue;ye=ee(Ze,X,E,oe)}let pe=x.distr!=2||d!=null?b[D]:D,pt=L(pe,x,q,J),Rt=ee(fe(he,le),X,E,oe),bt=Z(pt-te),Bt=Z(rt(Rt,ye)),tt=Z(Ft(Rt,ye)),lt=Bt-tt;if(he!=null){let Ze=he<0?W:ke,nt=he<0?ke:W;Je?(ve>0&&at[D]!=null&&F(St.get(at[D]),bt,tt+wt(ve/2),Q,rt(0,lt-ve),Ze,nt),et[D]!=null&&F($e.get(et[D]),bt,tt+wt(ve/2),Q,rt(0,lt-ve),Ze,nt)):F(Pt,bt,tt+wt(ve/2),Q,rt(0,lt-ve),Ze,nt),Y(P,R,D,bt-ve/2,tt,Q+ve,lt)}}return ve>0?Re.stroke=Je?St:Pt:Je||(Re._fill=U.width==0?U._fill:U._stroke??U._fill,Re.width=0),Re.fill=Je?$e:Pt,Re})}function Rc(e,l){const i=fe(l==null?void 0:l.alignGaps,0);return(n,o,c,u)=>_l(n,o,(h,p,d,_,g,v,P,R,M,O,U)=>{[c,u]=Pn(d,c,u);let b=h.pxRound,I=B=>b(v(B,_,O,R)),x=B=>b(P(B,g,U,M)),X,L,ee;_.ori==0?(X=Hn,ee=Ul,L=$o):(X=zn,ee=Yl,L=Ko);const J=_.dir*(_.ori==0?1:-1);let oe=I(p[J==1?c:u]),q=oe,E=[],Z=[];for(let B=J==1?c:u;B>=c&&B<=u;B+=J)if(d[B]!=null){let z=p[B],F=I(z);E.push(q=F),Z.push(x(d[B]))}const H={stroke:e(E,Z,X,ee,L,b),fill:null,clip:null,band:null,gaps:null,flags:Gl},K=H.stroke;let[G,re]=Gs(n,o);if(h.fill!=null||G!=0){let B=H.fill=new Path2D(K),je=h.fillTo(n,o,h.min,h.max,G),z=x(je);ee(B,q,z),ee(B,oe,z)}if(!h.spanGaps){let B=[];B.push(...Ws(p,d,c,u,J,I,i)),H.gaps=B=h.gaps(n,o,c,u,B),H.clip=Vn(B,_.ori,R,M,O,U)}return re!=0&&(H.band=re==2?[Qt(n,o,c,u,K,-1),Qt(n,o,c,u,K,1)]:Qt(n,o,c,u,K,re)),H})}function Lc(e){return Rc(Cc,e)}function Cc(e,l,i,n,o,c){const u=e.length;if(u<2)return null;const h=new Path2D;if(i(h,e[0],l[0]),u==2)n(h,e[1],l[1]);else{let p=Array(u),d=Array(u-1),_=Array(u-1),g=Array(u-1);for(let v=0;v<u-1;v++)_[v]=l[v+1]-l[v],g[v]=e[v+1]-e[v],d[v]=_[v]/g[v];p[0]=d[0];for(let v=1;v<u-1;v++)d[v]===0||d[v-1]===0||d[v-1]>0!=d[v]>0?p[v]=0:(p[v]=3*(g[v-1]+g[v])/((2*g[v]+g[v-1])/d[v-1]+(g[v]+2*g[v-1])/d[v]),isFinite(p[v])||(p[v]=0));p[u-1]=d[u-2];for(let v=0;v<u-1;v++)o(h,e[v]+g[v]/3,l[v]+p[v]*g[v]/3,e[v+1]-g[v]/3,l[v+1]-p[v+1]*g[v]/3,e[v+1],l[v+1])}return h}const Ds=new Set;function ao(){for(let e of Ds)e.syncRect(!0)}Wl&&(gl(pa,Fl,ao),gl(da,Fl,ao,!0),gl(Tn,Fl,()=>{Xe.pxRatio=ge}));const Vc=Jo(),Hc=qo();function co(e,l,i,n){return(n?[e[0],e[1]].concat(e.slice(2)):[e[0]].concat(e.slice(1))).map((c,u)=>ks(c,u,l,i))}function zc(e,l){return e.map((i,n)=>n==0?{}:Ve({},l,i))}function ks(e,l,i,n){return Ve({},l==0?i:n,e)}function Zo(e,l,i){return l==null?Nl:[l,i]}const Fc=Zo;function Ic(e,l,i){return l==null?Nl:Dn(l,i,Hs,!0)}function Qo(e,l,i,n){return l==null?Nl:Rn(l,i,e.scales[n].log,!1)}const Bc=Qo;function Xo(e,l,i,n){return l==null?Nl:Vs(l,i,e.scales[n].log,!1)}const Nc=Xo;function Oc(e,l,i,n,o){let c=rt(Oi(e),Oi(l)),u=l-e,h=zt(o/n*u,i);do{let p=i[h],d=n*p/u;if(d>=o&&c+(p<5?ol.get(p):0)<=17)return[p,d]}while(++h<i.length);return[0,0]}function uo(e){let l,i;return e=e.replace(/(\d+)px/,(n,o)=>(l=ze((i=+o)*ge))+"px"),[e,l,i]}function Gc(e){e.show&&[e.font,e.labelFont].forEach(l=>{let i=be(l[2]*ge,1);l[0]=l[0].replace(/[0-9.]+px/,i+"px"),l[1]=i})}function Xe(e,l,i){const n={mode:fe(e.mode,1)},o=n.mode;function c(t,s,r,a){let f=s.valToPct(t);return a+r*(s.dir==-1?1-f:f)}function u(t,s,r,a){let f=s.valToPct(t);return a+r*(s.dir==-1?f:1-f)}function h(t,s,r,a){return s.ori==0?c(t,s,r,a):u(t,s,r,a)}n.valToPosH=c,n.valToPosV=u;let p=!1;n.status=0;const d=n.root=Dt(jr);if(e.id!=null&&(d.id=e.id),vt(d,e.class),e.title){let t=Dt(Qr,d);t.textContent=e.title}const _=Ht("canvas"),g=n.ctx=_.getContext("2d"),v=Dt(Xr,d);gl("click",v,t=>{t.target===R&&(xe!=Pl||Me!=Rl)&&qe.click(n,t)},!0);const P=n.under=Dt(ea,v);v.appendChild(_);const R=n.over=Dt(ta,v);e=Ol(e);const M=+fe(e.pxAlign,1),O=oo(M);(e.plugins||[]).forEach(t=>{t.opts&&(e=t.opts(n,e)||e)});const U=e.ms||.001,b=n.series=o==1?co(e.series||[],Xi,so,!1):zc(e.series||[null],no),I=n.axes=co(e.axes||[],Qi,to,!0),x=n.scales={},X=n.bands=e.bands||[];X.forEach(t=>{t.fill=ce(t.fill||null),t.dir=fe(t.dir,-1)});const L=o==2?b[1].facets[0].scale:b[0].scale,ee={axes:mr,series:ur},J=(e.drawOrder||["axes","series"]).map(t=>ee[t]);function oe(t){const s=t.distr==3?r=>Zt(r>0?r:t.clamp(n,r,t.min,t.max,t.key)):t.distr==4?r=>hs(r,t.asinh):t.distr==100?r=>t.fwd(r):r=>r;return r=>{let a=s(r),{_min:f,_max:m}=t,w=m-f;return(a-f)/w}}function q(t){let s=x[t];if(s==null){let r=(e.scales||rn)[t]||rn;if(r.from!=null){q(r.from);let a=Ve({},x[r.from],r,{key:t});a.valToPct=oe(a),x[t]=a}else{s=x[t]=Ve({},t==L?Oo:Ec,r),s.key=t;let a=s.time,f=s.range,m=il(f);if((t!=L||o==2&&!a)&&(m&&(f[0]==null||f[1]==null)&&(f={min:f[0]==null?Ii:{mode:1,hard:f[0],soft:f[0]},max:f[1]==null?Ii:{mode:1,hard:f[1],soft:f[1]}},m=!1),!m&&Cn(f))){let w=f;f=(S,y,k)=>y==null?Nl:Dn(y,k,w)}s.range=ce(f||(a?Fc:t==L?s.distr==3?Bc:s.distr==4?Nc:Zo:s.distr==3?Qo:s.distr==4?Xo:Ic)),s.auto=ce(m?!1:s.auto),s.clamp=ce(s.clamp||xc),s._min=s._max=null,s.valToPct=oe(s)}}}q("x"),q("y"),o==1&&b.forEach(t=>{q(t.scale)}),I.forEach(t=>{q(t.scale)});for(let t in e.scales)q(t);const E=x[L],Z=E.distr;let H,K;E.ori==0?(vt(d,Jr),H=c,K=u):(vt(d,Zr),H=u,K=c);const G={};for(let t in x){let s=x[t];(s.min!=null||s.max!=null)&&(G[t]={min:s.min,max:s.max},s.min=s.max=null)}const re=e.tzDate||(t=>new Date(ze(t/U))),B=e.fmtDate||Is,je=U==1?Ja(re):Xa(re),z=ji(re,qi(U==1?ja:Qa,B)),F=Zi(re,Ji(tc,B)),Y=[],C=n.legend=Ve({},sc,e.legend),T=n.cursor=Ve({},uc,{drag:{y:o==2}},e.cursor),le=C.show,ye=T.show,te=C.markers;C.idxs=Y,te.width=ce(te.width),te.dash=ce(te.dash),te.stroke=ce(te.stroke),te.fill=ce(te.fill);let Q,Ye,Le,ve=[],Je=[],et,$e=!1,at={};if(C.live){const t=b[1]?b[1].values:null;$e=t!=null,et=$e?t(n,1,0):{_:0};for(let s in et)at[s]=Ls}if(le)if(Q=Ht("table",ra,d),Le=Ht("tbody",null,Q),C.mount(n,Q),$e){Ye=Ht("thead",null,Q,Le);let t=Ht("tr",null,Ye);Ht("th",null,t);for(var St in et)Ht("th",Ti,t).textContent=St}else vt(Q,ca),C.live&&vt(Q,aa);const It={show:!0},Mt={show:!1};function ht(t,s){if(s==0&&($e||!C.live||o==2))return Nl;let r=[],a=Ht("tr",ua,Le,Le.childNodes[s]);vt(a,t.class),t.show||vt(a,ml);let f=Ht("th",null,a);if(te.show){let S=Dt(fa,f);if(s>0){let y=te.width(n,s);y&&(S.style.border=y+"px "+te.dash(n,s)+" "+te.stroke(n,s)),S.style.background=te.fill(n,s)}}let m=Dt(Ti,f);t.label instanceof HTMLElement?m.appendChild(t.label):m.textContent=t.label,s>0&&(te.show||(m.style.color=t.width>0?te.stroke(n,s):te.fill(n,s)),Re("click",f,S=>{if(T._lock)return;rl(S);let y=b.indexOf(t);if((S.ctrlKey||S.metaKey)!=C.isolate){let k=b.some((A,V)=>V>0&&V!=y&&A.show);b.forEach((A,V)=>{V>0&&Ot(V,k?V==y?It:Mt:It,!0,Ce.setSeries)})}else Ot(y,{show:!t.show},!0,Ce.setSeries)},!1),bl&&Re(Ai,f,S=>{T._lock||(rl(S),Ot(b.indexOf(t),Cl,!0,Ce.setSeries))},!1));for(var w in et){let S=Ht("td",ha,a);S.textContent="--",r.push(S)}return[a,r]}const At=new Map;function Re(t,s,r,a=!0){const f=At.get(s)||{},m=T.bind[t](n,s,r,a);m&&(gl(t,s,f[t]=m),At.set(s,f))}function Pt(t,s,r){const a=At.get(s)||{};for(let f in a)(t==null||f==t)&&(bs(f,s,a[f]),delete a[f]);t==null&&At.delete(s)}let ct=0,ke=0,W=0,D=0,he=0,pe=0,pt=he,Rt=pe,bt=W,Bt=D,tt=0,lt=0,Ze=0,nt=0;n.bbox={};let $l=!1,Sl=!1,Xt=!1,jt=!1,cn=!1,yt=!1;function In(t,s,r){(r||t!=n.width||s!=n.height)&&Ys(t,s),Dl(!1),Xt=!0,Sl=!0,kl()}function Ys(t,s){n.width=ct=W=t,n.height=ke=D=s,he=pe=0,nr(),sr();let r=n.bbox;tt=r.left=pl(he*ge,.5),lt=r.top=pl(pe*ge,.5),Ze=r.width=pl(W*ge,.5),nt=r.height=pl(D*ge,.5)}const er=3;function tr(){let t=!1,s=0;for(;!t;){s++;let r=pr(s),a=dr(s);t=s==er||r&&a,t||(Ys(n.width,n.height),Sl=!0)}}function lr({width:t,height:s}){In(t,s)}n.setSize=lr;function nr(){let t=!1,s=!1,r=!1,a=!1;I.forEach((f,m)=>{if(f.show&&f._show){let{side:w,_size:S}=f,y=w%2,k=f.label!=null?f.labelSize:0,A=S+k;A>0&&(y?(W-=A,w==3?(he+=A,a=!0):r=!0):(D-=A,w==0?(pe+=A,t=!0):s=!0))}}),al[0]=t,al[1]=r,al[2]=s,al[3]=a,W-=el[1]+el[3],he+=el[3],D-=el[2]+el[0],pe+=el[0]}function sr(){let t=he+W,s=pe+D,r=he,a=pe;function f(m,w){switch(m){case 1:return t+=w,t-w;case 2:return s+=w,s-w;case 3:return r-=w,r+w;case 0:return a-=w,a+w}}I.forEach((m,w)=>{if(m.show&&m._show){let S=m.side;m._pos=f(S,m._size),m.label!=null&&(m._lpos=f(S,m.labelSize))}})}if(T.dataIdx==null){let t=T.hover,s=t.skip=new Set(t.skip??[]);s.add(void 0);let r=t.prox=ce(t.prox),a=t.bias??(t.bias=0);T.dataIdx=(f,m,w,S)=>{if(m==0)return w;let y=w,k=r(f,m,w,S)??Se,A=k>=0&&k<Se,V=E.ori==0?W:D,j=T.left,de=l[0],ue=l[m];if(s.has(ue[w])){y=null;let ae=null,$=null,N;if(a==0||a==-1)for(N=w;ae==null&&N-- >0;)s.has(ue[N])||(ae=N);if(a==0||a==1)for(N=w;$==null&&N++<ue.length;)s.has(ue[N])||($=N);if(ae!=null||$!=null)if(A){let Te=ae==null?-1/0:H(de[ae],E,V,0),Ae=$==null?1/0:H(de[$],E,V,0),Ue=j-Te,_e=Ae-j;Ue<=_e?Ue<=k&&(y=ae):_e<=k&&(y=$)}else y=$==null?ae:ae==null?$:w-ae<=$-w?ae:$}else A&&Fe(j-H(de[w],E,V,0))>k&&(y=null);return y}}const rl=t=>{T.event=t};T.idxs=Y,T._lock=!1;let Qe=T.points;Qe.show=ce(Qe.show),Qe.size=ce(Qe.size),Qe.stroke=ce(Qe.stroke),Qe.width=ce(Qe.width),Qe.fill=ce(Qe.fill);const Nt=n.focus=Ve({},e.focus||{alpha:.3},T.focus),bl=Nt.prox>=0,yl=bl&&Qe.one;let xt=[],xl=[],El=[];function $s(t,s){let r=Qe.show(n,s);if(r instanceof HTMLElement)return vt(r,oa),vt(r,t.class),Kt(r,-10,-10,W,D),R.insertBefore(r,xt[s]),r}function Ks(t,s){if(o==1||s>0){let r=o==1&&x[t.scale].time,a=t.value;t.value=r?Ui(a)?Zi(re,Ji(a,B)):a||F:a||Sc,t.label=t.label||(r?hc:fc)}if(yl||s>0){t.width=t.width==null?1:t.width,t.paths=t.paths||Vc||Ea,t.fillTo=ce(t.fillTo||Tc),t.pxAlign=+fe(t.pxAlign,M),t.pxRound=oo(t.pxAlign),t.stroke=ce(t.stroke||null),t.fill=ce(t.fill||null),t._stroke=t._fill=t._paths=t._focus=null;let r=bc(rt(1,t.width),1),a=t.points=Ve({},{size:r,width:rt(1,r*.2),stroke:t.stroke,space:r*2,paths:Hc,_stroke:null,_fill:null},t.points);a.show=ce(a.show),a.filter=ce(a.filter),a.fill=ce(a.fill),a.stroke=ce(a.stroke),a.paths=ce(a.paths),a.pxAlign=t.pxAlign}if(le){let r=ht(t,s);ve.splice(s,0,r[0]),Je.splice(s,0,r[1]),C.values.push(null)}if(ye){Y.splice(s,0,null);let r=null;yl?s==0&&(r=$s(t,s)):s>0&&(r=$s(t,s)),xt.splice(s,0,r),xl.splice(s,0,0),El.splice(s,0,0)}We("addSeries",s)}function ir(t,s){s=s??b.length,t=o==1?ks(t,s,Xi,so):ks(t,s,{},no),b.splice(s,0,t),Ks(b[s],s)}n.addSeries=ir;function or(t){if(b.splice(t,1),le){C.values.splice(t,1),Je.splice(t,1);let s=ve.splice(t,1)[0];Pt(null,s.firstChild),s.remove()}ye&&(Y.splice(t,1),xt.splice(t,1)[0].remove(),xl.splice(t,1),El.splice(t,1)),We("delSeries",t)}n.delSeries=or;const al=[!1,!1,!1,!1];function rr(t,s){if(t._show=t.show,t.show){let r=t.side%2,a=x[t.scale];a==null&&(t.scale=r?b[1].scale:L,a=x[t.scale]);let f=a.time;t.size=ce(t.size),t.space=ce(t.space),t.rotate=ce(t.rotate),il(t.incrs)&&t.incrs.forEach(w=>{!ol.has(w)&&ol.set(w,yo(w))}),t.incrs=ce(t.incrs||(a.distr==2?$a:f?U==1?qa:Za:dl)),t.splits=ce(t.splits||(f&&a.distr==1?je:a.distr==3?xs:a.distr==4?mc:dc)),t.stroke=ce(t.stroke),t.grid.stroke=ce(t.grid.stroke),t.ticks.stroke=ce(t.ticks.stroke),t.border.stroke=ce(t.border.stroke);let m=t.values;t.values=il(m)&&!il(m[0])?ce(m):f?il(m)?ji(re,qi(m,B)):Ui(m)?ec(re,m):m||z:m||pc,t.filter=ce(t.filter||(a.distr>=3&&a.log==10?wc:a.distr==3&&a.log==2?_c:So)),t.font=uo(t.font),t.labelFont=uo(t.labelFont),t._size=t.size(n,null,s,0),t._space=t._rotate=t._incrs=t._found=t._splits=t._values=null,t._size>0&&(al[s]=!0,t._el=Dt(la,v))}}function Kl(t,s,r,a){let[f,m,w,S]=r,y=s%2,k=0;return y==0&&(S||m)&&(k=s==0&&!f||s==2&&!w?ze(Qi.size/3):0),y==1&&(f||w)&&(k=s==1&&!m||s==3&&!S?ze(to.size/2):0),k}const qs=n.padding=(e.padding||[Kl,Kl,Kl,Kl]).map(t=>ce(fe(t,Kl))),el=n._padding=qs.map((t,s)=>t(n,s,al,0));let Ke,Be=null,Ne=null;const un=o==1?b[0].idxs:null;let Lt=null,ql=!1;function js(t,s){if(l=t??[],n.data=n._data=l,o==2){Ke=0;for(let r=1;r<b.length;r++)Ke+=l[r][0].length}else{l.length==0&&(n.data=n._data=l=[[]]),Lt=l[0],Ke=Lt.length;let r=l;if(Z==2){r=l.slice();let a=r[0]=Array(Ke);for(let f=0;f<Ke;f++)a[f]=f}n._data=l=r}if(Dl(!0),We("setData"),Z==2&&(Xt=!0),s!==!1){let r=E;r.auto(n,ql)?Bn():ll(L,r.min,r.max),jt=jt||T.left>=0,yt=!0,kl()}}n.setData=js;function Bn(){ql=!0;let t,s;o==1&&(Ke>0?(Be=un[0]=0,Ne=un[1]=Ke-1,t=l[0][Be],s=l[0][Ne],Z==2?(t=Be,s=Ne):t==s&&(Z==3?[t,s]=Rn(t,t,E.log,!1):Z==4?[t,s]=Vs(t,t,E.log,!1):E.time?s=t+ze(86400/U):[t,s]=Dn(t,s,Hs,!0))):(Be=un[0]=t=null,Ne=un[1]=s=null)),ll(L,t,s)}let fn,Tl,Nn,On,Gn,Wn,Un,Yn,$n,ut;function Js(t,s,r,a,f,m){t??(t=ki),r??(r=Fs),a??(a="butt"),f??(f=ki),m??(m="round"),t!=fn&&(g.strokeStyle=fn=t),f!=Tl&&(g.fillStyle=Tl=f),s!=Nn&&(g.lineWidth=Nn=s),m!=Gn&&(g.lineJoin=Gn=m),a!=Wn&&(g.lineCap=Wn=a),r!=On&&g.setLineDash(On=r)}function Zs(t,s,r,a){s!=Tl&&(g.fillStyle=Tl=s),t!=Un&&(g.font=Un=t),r!=Yn&&(g.textAlign=Yn=r),a!=$n&&(g.textBaseline=$n=a)}function Kn(t,s,r,a,f=0){if(a.length>0&&t.auto(n,ql)&&(s==null||s.min==null)){let m=fe(Be,0),w=fe(Ne,a.length-1),S=r.min==null?wa(a,m,w,f,t.distr==3):[r.min,r.max];t.min=Ft(t.min,r.min=S[0]),t.max=rt(t.max,r.max=S[1])}}const Qs={min:null,max:null};function ar(){for(let a in x){let f=x[a];G[a]==null&&(f.min==null||G[L]!=null&&f.auto(n,ql))&&(G[a]=Qs)}for(let a in x){let f=x[a];G[a]==null&&f.from!=null&&G[f.from]!=null&&(G[a]=Qs)}G[L]!=null&&Dl(!0);let t={};for(let a in G){let f=G[a];if(f!=null){let m=t[a]=Ol(x[a],ka);if(f.min!=null)Ve(m,f);else if(a!=L||o==2)if(Ke==0&&m.from==null){let w=m.range(n,null,null,a);m.min=w[0],m.max=w[1]}else m.min=Se,m.max=-Se}}if(Ke>0){b.forEach((a,f)=>{if(o==1){let m=a.scale,w=G[m];if(w==null)return;let S=t[m];if(f==0){let y=S.range(n,S.min,S.max,m);S.min=y[0],S.max=y[1],Be=zt(S.min,l[0]),Ne=zt(S.max,l[0]),Ne-Be>1&&(l[0][Be]<S.min&&Be++,l[0][Ne]>S.max&&Ne--),a.min=Lt[Be],a.max=Lt[Ne]}else a.show&&a.auto&&Kn(S,w,a,l[f],a.sorted);a.idxs[0]=Be,a.idxs[1]=Ne}else if(f>0&&a.show&&a.auto){let[m,w]=a.facets,S=m.scale,y=w.scale,[k,A]=l[f],V=t[S],j=t[y];V!=null&&Kn(V,G[S],m,k,m.sorted),j!=null&&Kn(j,G[y],w,A,w.sorted),a.min=w.min,a.max=w.max}});for(let a in t){let f=t[a],m=G[a];if(f.from==null&&(m==null||m.min==null)){let w=f.range(n,f.min==Se?null:f.min,f.max==-Se?null:f.max,a);f.min=w[0],f.max=w[1]}}}for(let a in t){let f=t[a];if(f.from!=null){let m=t[f.from];if(m.min==null)f.min=f.max=null;else{let w=f.range(n,m.min,m.max,a);f.min=w[0],f.max=w[1]}}}let s={},r=!1;for(let a in t){let f=t[a],m=x[a];if(m.min!=f.min||m.max!=f.max){m.min=f.min,m.max=f.max;let w=m.distr;m._min=w==3?Zt(m.min):w==4?hs(m.min,m.asinh):w==100?m.fwd(m.min):m.min,m._max=w==3?Zt(m.max):w==4?hs(m.max,m.asinh):w==100?m.fwd(m.max):m.max,s[a]=r=!0}}if(r){b.forEach((a,f)=>{o==2?f>0&&s.y&&(a._paths=null):s[a.scale]&&(a._paths=null)});for(let a in s)Xt=!0,We("setScale",a);ye&&T.left>=0&&(jt=yt=!0)}for(let a in G)G[a]=null}function cr(t){let s=ys(Be-1,0,Ke-1),r=ys(Ne+1,0,Ke-1);for(;t[s]==null&&s>0;)s--;for(;t[r]==null&&r<Ke-1;)r++;return[s,r]}function ur(){if(Ke>0){let t=b.some(s=>s._focus)&&ut!=Nt.alpha;t&&(g.globalAlpha=ut=Nt.alpha),b.forEach((s,r)=>{if(r>0&&s.show&&(Xs(r,!1),Xs(r,!0),s._paths==null)){let a=ut;ut!=s.alpha&&(g.globalAlpha=ut=s.alpha);let f=o==2?[0,l[r][0].length-1]:cr(l[r]);s._paths=s.paths(n,r,f[0],f[1]),ut!=a&&(g.globalAlpha=ut=a)}}),b.forEach((s,r)=>{if(r>0&&s.show){let a=ut;ut!=s.alpha&&(g.globalAlpha=ut=s.alpha),s._paths!=null&&ei(r,!1);{let f=s._paths!=null?s._paths.gaps:null,m=s.points.show(n,r,Be,Ne,f),w=s.points.filter(n,r,m,f);(m||w)&&(s.points._paths=s.points.paths(n,r,Be,Ne,w),ei(r,!0))}ut!=a&&(g.globalAlpha=ut=a),We("drawSeries",r)}}),t&&(g.globalAlpha=ut=1)}}function Xs(t,s){let r=s?b[t].points:b[t];r._stroke=r.stroke(n,t),r._fill=r.fill(n,t)}function ei(t,s){let r=s?b[t].points:b[t],{stroke:a,fill:f,clip:m,flags:w,_stroke:S=r._stroke,_fill:y=r._fill,_width:k=r.width}=r._paths;k=be(k*ge,3);let A=null,V=k%2/2;s&&y==null&&(y=k>0?"#fff":S);let j=r.pxAlign==1&&V>0;if(j&&g.translate(V,V),!s){let de=tt-k/2,ue=lt-k/2,ae=Ze+k,$=nt+k;A=new Path2D,A.rect(de,ue,ae,$)}s?qn(S,k,r.dash,r.cap,y,a,f,w,m):fr(t,S,k,r.dash,r.cap,y,a,f,w,A,m),j&&g.translate(-V,-V)}function fr(t,s,r,a,f,m,w,S,y,k,A){let V=!1;y!=0&&X.forEach((j,de)=>{if(j.series[0]==t){let ue=b[j.series[1]],ae=l[j.series[1]],$=(ue._paths||rn).band;il($)&&($=j.dir==1?$[0]:$[1]);let N,Te=null;ue.show&&$&&Sa(ae,Be,Ne)?(Te=j.fill(n,de)||m,N=ue._paths.clip):$=null,qn(s,r,a,f,Te,w,S,y,k,A,N,$),V=!0}}),V||qn(s,r,a,f,m,w,S,y,k,A)}const ti=Gl|Ts;function qn(t,s,r,a,f,m,w,S,y,k,A,V){Js(t,s,r,a,f),(y||k||V)&&(g.save(),y&&g.clip(y),k&&g.clip(k)),V?(S&ti)==ti?(g.clip(V),A&&g.clip(A),pn(f,w),hn(t,m,s)):S&Ts?(pn(f,w),g.clip(V),hn(t,m,s)):S&Gl&&(g.save(),g.clip(V),A&&g.clip(A),pn(f,w),g.restore(),hn(t,m,s)):(pn(f,w),hn(t,m,s)),(y||k||V)&&g.restore()}function hn(t,s,r){r>0&&(s instanceof Map?s.forEach((a,f)=>{g.strokeStyle=fn=f,g.stroke(a)}):s!=null&&t&&g.stroke(s))}function pn(t,s){s instanceof Map?s.forEach((r,a)=>{g.fillStyle=Tl=a,g.fill(r)}):s!=null&&t&&g.fill(s)}function hr(t,s,r,a){let f=I[t],m;if(a<=0)m=[0,0];else{let w=f._space=f.space(n,t,s,r,a),S=f._incrs=f.incrs(n,t,s,r,a,w);m=Oc(s,r,S,a,w)}return f._found=m}function jn(t,s,r,a,f,m,w,S,y,k){let A=w%2/2;M==1&&g.translate(A,A),Js(S,w,y,k,S),g.beginPath();let V,j,de,ue,ae=f+(a==0||a==3?-m:m);r==0?(j=f,ue=ae):(V=f,de=ae);for(let $=0;$<t.length;$++)s[$]!=null&&(r==0?V=de=t[$]:j=ue=t[$],g.moveTo(V,j),g.lineTo(de,ue));g.stroke(),M==1&&g.translate(-A,-A)}function pr(t){let s=!0;return I.forEach((r,a)=>{if(!r.show)return;let f=x[r.scale];if(f.min==null){r._show&&(s=!1,r._show=!1,Dl(!1));return}else r._show||(s=!1,r._show=!0,Dl(!1));let m=r.side,w=m%2,{min:S,max:y}=f,[k,A]=hr(a,S,y,w==0?W:D);if(A==0)return;let V=f.distr==2,j=r._splits=r.splits(n,a,S,y,k,A,V),de=f.distr==2?j.map(N=>Lt[N]):j,ue=f.distr==2?Lt[j[1]]-Lt[j[0]]:k,ae=r._values=r.values(n,r.filter(n,de,a,A,ue),a,A,ue);r._rotate=m==2?r.rotate(n,ae,a,A):0;let $=r._size;r._size=kt(r.size(n,ae,a,t)),$!=null&&r._size!=$&&(s=!1)}),s}function dr(t){let s=!0;return qs.forEach((r,a)=>{let f=r(n,a,al,t);f!=el[a]&&(s=!1),el[a]=f}),s}function mr(){for(let t=0;t<I.length;t++){let s=I[t];if(!s.show||!s._show)continue;let r=s.side,a=r%2,f,m,w=s.stroke(n,t),S=r==0||r==3?-1:1,[y,k]=s._found;if(s.label!=null){let it=s.labelGap*S,gt=ze((s._lpos+it)*ge);Zs(s.labelFont[0],w,"center",r==2?en:Di),g.save(),a==1?(f=m=0,g.translate(gt,ze(lt+nt/2)),g.rotate((r==3?-xn:xn)/2)):(f=ze(tt+Ze/2),m=gt);let fl=wo(s.label)?s.label(n,t,y,k):s.label;g.fillText(fl,f,m),g.restore()}if(k==0)continue;let A=x[s.scale],V=a==0?Ze:nt,j=a==0?tt:lt,de=s._splits,ue=A.distr==2?de.map(it=>Lt[it]):de,ae=A.distr==2?Lt[de[1]]-Lt[de[0]]:y,$=s.ticks,N=s.border,Te=$.show?$.size:0,Ae=ze(Te*ge),Ue=ze((s.alignTo==2?s._size-Te-s.gap:s.gap)*ge),_e=s._rotate*-xn/180,Pe=O(s._pos*ge),dt=(Ae+Ue)*S,st=Pe+dt;m=a==0?st:0,f=a==1?st:0;let Et=s.font[0],Ct=s.align==1?Hl:s.align==2?cs:_e>0?Hl:_e<0?cs:a==0?"center":r==3?cs:Hl,Wt=_e||a==1?"middle":r==2?en:Di;Zs(Et,w,Ct,Wt);let mt=s.font[1]*s.lineGap,Tt=de.map(it=>O(h(it,A,V,j))),Vt=s._values;for(let it=0;it<Vt.length;it++){let gt=Vt[it];if(gt!=null){a==0?f=Tt[it]:m=Tt[it],gt=""+gt;let fl=gt.indexOf(`
`)==-1?[gt]:gt.split(/\n/gm);for(let ot=0;ot<fl.length;ot++){let Si=fl[ot];_e?(g.save(),g.translate(f,m+ot*mt),g.rotate(_e),g.fillText(Si,0,0),g.restore()):g.fillText(Si,f,m+ot*mt)}}}$.show&&jn(Tt,$.filter(n,ue,t,k,ae),a,r,Pe,Ae,be($.width*ge,3),$.stroke(n,t),$.dash,$.cap);let Ut=s.grid;Ut.show&&jn(Tt,Ut.filter(n,ue,t,k,ae),a,a==0?2:1,a==0?lt:tt,a==0?nt:Ze,be(Ut.width*ge,3),Ut.stroke(n,t),Ut.dash,Ut.cap),N.show&&jn([Pe],[1],a==0?1:0,a==0?1:2,a==1?lt:tt,a==1?nt:Ze,be(N.width*ge,3),N.stroke(n,t),N.dash,N.cap)}We("drawAxes")}function Dl(t){b.forEach((s,r)=>{r>0&&(s._paths=null,t&&(o==1?(s.min=null,s.max=null):s.facets.forEach(a=>{a.min=null,a.max=null})))})}let dn=!1,Jn=!1,jl=[];function gr(){Jn=!1;for(let t=0;t<jl.length;t++)We(...jl[t]);jl.length=0}function kl(){dn||(Va(li),dn=!0)}function vr(t,s=!1){dn=!0,Jn=s,t(n),li(),s&&jl.length>0&&queueMicrotask(gr)}n.batch=vr;function li(){if($l&&(ar(),$l=!1),Xt&&(tr(),Xt=!1),Sl){if(De(P,Hl,he),De(P,en,pe),De(P,ln,W),De(P,nn,D),De(R,Hl,he),De(R,en,pe),De(R,ln,W),De(R,nn,D),De(v,ln,ct),De(v,nn,ke),_.width=ze(ct*ge),_.height=ze(ke*ge),I.forEach(({_el:t,_show:s,_size:r,_pos:a,side:f})=>{if(t!=null)if(s){let m=f===3||f===0?r:0,w=f%2==1;De(t,w?"left":"top",a-m),De(t,w?"width":"height",r),De(t,w?"top":"left",w?pe:he),De(t,w?"height":"width",w?D:W),Ss(t,ml)}else vt(t,ml)}),fn=Tl=Nn=Gn=Wn=Un=Yn=$n=On=null,ut=1,Ql(!0),he!=pt||pe!=Rt||W!=bt||D!=Bt){Dl(!1);let t=W/bt,s=D/Bt;if(ye&&!jt&&T.left>=0){T.left*=t,T.top*=s,Ml&&Kt(Ml,ze(T.left),0,W,D),Al&&Kt(Al,0,ze(T.top),W,D);for(let r=0;r<xt.length;r++){let a=xt[r];a!=null&&(xl[r]*=t,El[r]*=s,Kt(a,kt(xl[r]),kt(El[r]),W,D))}}if(Ee.show&&!cn&&Ee.left>=0&&Ee.width>0){Ee.left*=t,Ee.width*=t,Ee.top*=s,Ee.height*=s;for(let r in ls)De(Ll,r,Ee[r])}pt=he,Rt=pe,bt=W,Bt=D}We("setSize"),Sl=!1}ct>0&&ke>0&&(g.clearRect(0,0,_.width,_.height),We("drawClear"),J.forEach(t=>t()),We("draw")),Ee.show&&cn&&(mn(Ee),cn=!1),ye&&jt&&(ul(null,!0,!1),jt=!1),C.show&&C.live&&yt&&(es(),yt=!1),p||(p=!0,n.status=1,We("ready")),ql=!1,dn=!1}n.redraw=(t,s)=>{Xt=s||!1,t!==!1?ll(L,E.min,E.max):kl()};function Zn(t,s){let r=x[t];if(r.from==null){if(Ke==0){let a=r.range(n,s.min,s.max,t);s.min=a[0],s.max=a[1]}if(s.min>s.max){let a=s.min;s.min=s.max,s.max=a}if(Ke>1&&s.min!=null&&s.max!=null&&s.max-s.min<1e-16)return;t==L&&r.distr==2&&Ke>0&&(s.min=zt(s.min,l[0]),s.max=zt(s.max,l[0]),s.min==s.max&&s.max++),G[t]=s,$l=!0,kl()}}n.setScale=Zn;let Qn,Xn,Ml,Al,ni,si,Pl,Rl,ii,oi,xe,Me,tl=!1;const qe=T.drag;let Oe=qe.x,Ge=qe.y;ye&&(T.x&&(Qn=Dt(sa,R)),T.y&&(Xn=Dt(ia,R)),E.ori==0?(Ml=Qn,Al=Xn):(Ml=Xn,Al=Qn),xe=T.left,Me=T.top);const Ee=n.select=Ve({show:!0,over:!0,left:0,width:0,top:0,height:0},e.select),Ll=Ee.show?Dt(na,Ee.over?R:P):null;function mn(t,s){if(Ee.show){for(let r in t)Ee[r]=t[r],r in ls&&De(Ll,r,t[r]);s!==!1&&We("setSelect")}}n.setSelect=mn;function wr(t){if(b[t].show)le&&Ss(ve[t],ml);else if(le&&vt(ve[t],ml),ye){let r=yl?xt[0]:xt[t];r!=null&&Kt(r,-10,-10,W,D)}}function ll(t,s,r){Zn(t,{min:s,max:r})}function Ot(t,s,r,a){s.focus!=null&&xr(t),s.show!=null&&b.forEach((f,m)=>{m>0&&(t==m||t==null)&&(f.show=s.show,wr(m),o==2?(ll(f.facets[0].scale,null,null),ll(f.facets[1].scale,null,null)):ll(f.scale,null,null),kl())}),r!==!1&&We("setSeries",t,s),a&&Xl("setSeries",n,t,s)}n.setSeries=Ot;function _r(t,s){Ve(X[t],s)}function Sr(t,s){t.fill=ce(t.fill||null),t.dir=fe(t.dir,-1),s=s??X.length,X.splice(s,0,t)}function br(t){t==null?X.length=0:X.splice(t,1)}n.addBand=Sr,n.setBand=_r,n.delBand=br;function yr(t,s){b[t].alpha=s,ye&&xt[t]!=null&&(xt[t].style.opacity=s),le&&ve[t]&&(ve[t].style.opacity=s)}let Jt,nl,cl;const Cl={focus:!0};function xr(t){if(t!=cl){let s=t==null,r=Nt.alpha!=1;b.forEach((a,f)=>{if(o==1||f>0){let m=s||f==0||f==t;a._focus=s?null:m,r&&yr(f,m?1:Nt.alpha)}}),cl=t,r&&kl()}}le&&bl&&Re(Pi,Q,t=>{T._lock||(rl(t),cl!=null&&Ot(null,Cl,!0,Ce.setSeries))});function Gt(t,s,r){let a=x[s];r&&(t=t/ge-(a.ori==1?pe:he));let f=W;a.ori==1&&(f=D,t=f-t),a.dir==-1&&(t=f-t);let m=a._min,w=a._max,S=t/f,y=m+(w-m)*S,k=a.distr;return k==3?Bl(10,y):k==4?ya(y,a.asinh):k==100?a.bwd(y):y}function Er(t,s){let r=Gt(t,L,s);return zt(r,l[0],Be,Ne)}n.valToIdx=t=>zt(t,l[0]),n.posToIdx=Er,n.posToVal=Gt,n.valToPos=(t,s,r)=>x[s].ori==0?c(t,x[s],r?Ze:W,r?tt:0):u(t,x[s],r?nt:D,r?lt:0),n.setCursor=(t,s,r)=>{xe=t.left,Me=t.top,ul(null,s,r)};function ri(t,s){De(Ll,Hl,Ee.left=t),De(Ll,ln,Ee.width=s)}function ai(t,s){De(Ll,en,Ee.top=t),De(Ll,nn,Ee.height=s)}let Jl=E.ori==0?ri:ai,Zl=E.ori==1?ri:ai;function Tr(){if(le&&C.live)for(let t=o==2?1:0;t<b.length;t++){if(t==0&&$e)continue;let s=C.values[t],r=0;for(let a in s)Je[t][r++].firstChild.nodeValue=s[a]}}function es(t,s){if(t!=null&&(t.idxs?t.idxs.forEach((r,a)=>{Y[a]=r}):Da(t.idx)||Y.fill(t.idx),C.idx=Y[0]),le&&C.live){for(let r=0;r<b.length;r++)(r>0||o==1&&!$e)&&Dr(r,Y[r]);Tr()}yt=!1,s!==!1&&We("setLegend")}n.setLegend=es;function Dr(t,s){let r=b[t],a=t==0&&Z==2?Lt:l[t],f;$e?f=r.values(n,t,s)??at:(f=r.value(n,s==null?null:a[s],t,s),f=f==null?at:{_:f}),C.values[t]=f}function ul(t,s,r){ii=xe,oi=Me,[xe,Me]=T.move(n,xe,Me),T.left=xe,T.top=Me,ye&&(Ml&&Kt(Ml,ze(xe),0,W,D),Al&&Kt(Al,0,ze(Me),W,D));let a,f=Be>Ne;Jt=Se,nl=null;let m=E.ori==0?W:D,w=E.ori==1?W:D;if(xe<0||Ke==0||f){a=T.idx=null;for(let S=0;S<b.length;S++){let y=xt[S];y!=null&&Kt(y,-10,-10,W,D)}bl&&Ot(null,Cl,!0,t==null&&Ce.setSeries),C.live&&(Y.fill(a),yt=!0)}else{let S,y,k;o==1&&(S=E.ori==0?xe:Me,y=Gt(S,L),a=T.idx=zt(y,l[0],Be,Ne),k=H(l[0][a],E,m,0));let A=-10,V=-10,j=0,de=0,ue=!0,ae="",$="";for(let N=o==2?1:0;N<b.length;N++){let Te=b[N],Ae=Y[N],Ue=Ae==null?null:o==1?l[N][Ae]:l[N][1][Ae],_e=T.dataIdx(n,N,a,y),Pe=_e==null?null:o==1?l[N][_e]:l[N][1][_e];if(yt=yt||Pe!=Ue||_e!=Ae,Y[N]=_e,N>0&&Te.show){let dt=_e==null?-10:_e==a?k:H(o==1?l[0][_e]:l[N][0][_e],E,m,0),st=Pe==null?-10:K(Pe,o==1?x[Te.scale]:x[Te.facets[1].scale],w,0);if(bl&&Pe!=null){let Et=E.ori==1?xe:Me,Ct=Fe(Nt.dist(n,N,_e,st,Et));if(Ct<Jt){let Wt=Nt.bias;if(Wt!=0){let mt=Gt(Et,Te.scale),Tt=Pe>=0?1:-1,Vt=mt>=0?1:-1;Vt==Tt&&(Vt==1?Wt==1?Pe>=mt:Pe<=mt:Wt==1?Pe<=mt:Pe>=mt)&&(Jt=Ct,nl=N)}else Jt=Ct,nl=N}}if(yt||yl){let Et,Ct;E.ori==0?(Et=dt,Ct=st):(Et=st,Ct=dt);let Wt,mt,Tt,Vt,Ut,it,gt=!0,fl=Qe.bbox;if(fl!=null){gt=!1;let ot=fl(n,N);Tt=ot.left,Vt=ot.top,Wt=ot.width,mt=ot.height}else Tt=Et,Vt=Ct,Wt=mt=Qe.size(n,N);if(it=Qe.fill(n,N),Ut=Qe.stroke(n,N),yl)N==nl&&Jt<=Nt.prox&&(A=Tt,V=Vt,j=Wt,de=mt,ue=gt,ae=it,$=Ut);else{let ot=xt[N];ot!=null&&(xl[N]=Tt,El[N]=Vt,Fi(ot,Wt,mt,gt),Hi(ot,it,Ut),Kt(ot,kt(Tt),kt(Vt),W,D))}}}}if(yl){let N=Nt.prox,Te=cl==null?Jt<=N:Jt>N||nl!=cl;if(yt||Te){let Ae=xt[0];Ae!=null&&(xl[0]=A,El[0]=V,Fi(Ae,j,de,ue),Hi(Ae,ae,$),Kt(Ae,kt(A),kt(V),W,D))}}}if(Ee.show&&tl)if(t!=null){let[S,y]=Ce.scales,[k,A]=Ce.match,[V,j]=t.cursor.sync.scales,de=t.cursor.drag;if(Oe=de._x,Ge=de._y,Oe||Ge){let{left:ue,top:ae,width:$,height:N}=t.select,Te=t.scales[V].ori,Ae=t.posToVal,Ue,_e,Pe,dt,st,Et=S!=null&&k(S,V),Ct=y!=null&&A(y,j);Et&&Oe?(Te==0?(Ue=ue,_e=$):(Ue=ae,_e=N),Pe=x[S],dt=H(Ae(Ue,V),Pe,m,0),st=H(Ae(Ue+_e,V),Pe,m,0),Jl(Ft(dt,st),Fe(st-dt))):Jl(0,m),Ct&&Ge?(Te==1?(Ue=ue,_e=$):(Ue=ae,_e=N),Pe=x[y],dt=K(Ae(Ue,j),Pe,w,0),st=K(Ae(Ue+_e,j),Pe,w,0),Zl(Ft(dt,st),Fe(st-dt))):Zl(0,w)}else ns()}else{let S=Fe(ii-ni),y=Fe(oi-si);if(E.ori==1){let j=S;S=y,y=j}Oe=qe.x&&S>=qe.dist,Ge=qe.y&&y>=qe.dist;let k=qe.uni;k!=null?Oe&&Ge&&(Oe=S>=k,Ge=y>=k,!Oe&&!Ge&&(y>S?Ge=!0:Oe=!0)):qe.x&&qe.y&&(Oe||Ge)&&(Oe=Ge=!0);let A,V;Oe&&(E.ori==0?(A=Pl,V=xe):(A=Rl,V=Me),Jl(Ft(A,V),Fe(V-A)),Ge||Zl(0,w)),Ge&&(E.ori==1?(A=Pl,V=xe):(A=Rl,V=Me),Zl(Ft(A,V),Fe(V-A)),Oe||Jl(0,m)),!Oe&&!Ge&&(Jl(0,0),Zl(0,0))}if(qe._x=Oe,qe._y=Ge,t==null){if(r){if(_i!=null){let[S,y]=Ce.scales;Ce.values[0]=S!=null?Gt(E.ori==0?xe:Me,S):null,Ce.values[1]=y!=null?Gt(E.ori==1?xe:Me,y):null}Xl(us,n,xe,Me,W,D,a)}if(bl){let S=r&&Ce.setSeries,y=Nt.prox;cl==null?Jt<=y&&Ot(nl,Cl,!0,S):Jt>y?Ot(null,Cl,!0,S):nl!=cl&&Ot(nl,Cl,!0,S)}}yt&&(C.idx=a,es()),s!==!1&&We("setCursor")}let sl=null;Object.defineProperty(n,"rect",{get(){return sl==null&&Ql(!1),sl}});function Ql(t=!1){t?sl=null:(sl=R.getBoundingClientRect(),We("syncRect",sl))}function ci(t,s,r,a,f,m,w){T._lock||tl&&t!=null&&t.movementX==0&&t.movementY==0||(ts(t,s,r,a,f,m,w,!1,t!=null),t!=null?ul(null,!0,!0):ul(s,!0,!1))}function ts(t,s,r,a,f,m,w,S,y){if(sl==null&&Ql(!1),rl(t),t!=null)r=t.clientX-sl.left,a=t.clientY-sl.top;else{if(r<0||a<0){xe=-10,Me=-10;return}let[k,A]=Ce.scales,V=s.cursor.sync,[j,de]=V.values,[ue,ae]=V.scales,[$,N]=Ce.match,Te=s.axes[0].side%2==1,Ae=E.ori==0?W:D,Ue=E.ori==1?W:D,_e=Te?m:f,Pe=Te?f:m,dt=Te?a:r,st=Te?r:a;if(ue!=null?r=$(k,ue)?h(j,x[k],Ae,0):-10:r=Ae*(dt/_e),ae!=null?a=N(A,ae)?h(de,x[A],Ue,0):-10:a=Ue*(st/Pe),E.ori==1){let Et=r;r=a,a=Et}}y&&(s==null||s.cursor.event.type==us)&&((r<=1||r>=W-1)&&(r=pl(r,W)),(a<=1||a>=D-1)&&(a=pl(a,D))),S?(ni=r,si=a,[Pl,Rl]=T.move(n,r,a)):(xe=r,Me=a)}const ls={width:0,height:0,left:0,top:0};function ns(){mn(ls,!1)}let ui,fi,hi,pi;function di(t,s,r,a,f,m,w){tl=!0,Oe=Ge=qe._x=qe._y=!1,ts(t,s,r,a,f,m,w,!0,!1),t!=null&&(Re(fs,ws,mi,!1),Xl(Mi,n,Pl,Rl,W,D,null));let{left:S,top:y,width:k,height:A}=Ee;ui=S,fi=y,hi=k,pi=A}function mi(t,s,r,a,f,m,w){tl=qe._x=qe._y=!1,ts(t,s,r,a,f,m,w,!1,!0);let{left:S,top:y,width:k,height:A}=Ee,V=k>0||A>0,j=ui!=S||fi!=y||hi!=k||pi!=A;if(V&&j&&mn(Ee),qe.setScale&&V&&j){let de=S,ue=k,ae=y,$=A;if(E.ori==1&&(de=y,ue=A,ae=S,$=k),Oe&&ll(L,Gt(de,L),Gt(de+ue,L)),Ge)for(let N in x){let Te=x[N];N!=L&&Te.from==null&&Te.min!=Se&&ll(N,Gt(ae+$,N),Gt(ae,N))}ns()}else T.lock&&(T._lock=!T._lock,ul(s,!0,t!=null));t!=null&&(Pt(fs,ws),Xl(fs,n,xe,Me,W,D,null))}function kr(t,s,r,a,f,m,w){if(T._lock)return;rl(t);let S=tl;if(tl){let y=!0,k=!0,A=10,V,j;E.ori==0?(V=Oe,j=Ge):(V=Ge,j=Oe),V&&j&&(y=xe<=A||xe>=W-A,k=Me<=A||Me>=D-A),V&&y&&(xe=xe<Pl?0:W),j&&k&&(Me=Me<Rl?0:D),ul(null,!0,!0),tl=!1}xe=-10,Me=-10,Y.fill(null),ul(null,!0,!0),S&&(tl=S)}function gi(t,s,r,a,f,m,w){T._lock||(rl(t),Bn(),ns(),t!=null&&Xl(Ri,n,xe,Me,W,D,null))}function vi(){I.forEach(Gc),In(n.width,n.height,!0)}gl(Tn,Fl,vi);const Vl={};Vl.mousedown=di,Vl.mousemove=ci,Vl.mouseup=mi,Vl.dblclick=gi,Vl.setSeries=(t,s,r,a)=>{let f=Ce.match[2];r=f(n,s,r),r!=-1&&Ot(r,a,!0,!1)},ye&&(Re(Mi,R,di),Re(us,R,ci),Re(Ai,R,t=>{rl(t),Ql(!1)}),Re(Pi,R,kr),Re(Ri,R,gi),Ds.add(n),n.syncRect=Ql);const gn=n.hooks=e.hooks||{};function We(t,s,r){Jn?jl.push([t,s,r]):t in gn&&gn[t].forEach(a=>{a.call(null,n,s,r)})}(e.plugins||[]).forEach(t=>{for(let s in t.hooks)gn[s]=(gn[s]||[]).concat(t.hooks[s])});const wi=(t,s,r)=>r,Ce=Ve({key:null,setSeries:!1,filters:{pub:Gi,sub:Gi},scales:[L,b[1]?b[1].scale:null],match:[Wi,Wi,wi],values:[null,null]},T.sync);Ce.match.length==2&&Ce.match.push(wi),T.sync=Ce;const _i=Ce.key,ss=Go(_i);function Xl(t,s,r,a,f,m,w){Ce.filters.pub(t,s,r,a,f,m,w)&&ss.pub(t,s,r,a,f,m,w)}ss.sub(n);function Mr(t,s,r,a,f,m,w){Ce.filters.sub(t,s,r,a,f,m,w)&&Vl[t](null,s,r,a,f,m,w)}n.pub=Mr;function Ar(){ss.unsub(n),Ds.delete(n),At.clear(),bs(Tn,Fl,vi),d.remove(),Q==null||Q.remove(),We("destroy")}n.destroy=Ar;function is(){We("init",e,l),js(l||e.data,!1),G[L]?Zn(L,G[L]):Bn(),cn=Ee.show&&(Ee.width>0||Ee.height>0),jt=yt=!0,In(e.width,e.height)}return b.forEach(Ks),I.forEach(rr),i?i instanceof HTMLElement?(i.appendChild(d),is()):i(n,is):is(),n}Xe.assign=Ve;Xe.fmtNum=zs;Xe.rangeNum=Dn;Xe.rangeLog=Rn;Xe.rangeAsinh=Vs;Xe.orient=_l;Xe.pxRatio=ge;Xe.join=Ca;Xe.fmtDate=Is,Xe.tzDate=Ua;Xe.sync=Go;{Xe.addGap=Dc,Xe.clipGaps=Vn;let e=Xe.paths={points:qo};e.linear=Jo,e.stepped=Ac,e.bars=Pc,e.spline=Lc}var Wc=wl('<div class="error-message svelte-ifobs9"> </div>'),Uc=wl('<div class="compatibility-warning svelte-ifobs9"><p class="svelte-ifobs9">Bluetooth is not supported on this device.</p> <p class="svelte-ifobs9">Please use a device with Bluetooth support or the mobile app.</p></div>'),Yc=wl(`<div class="start-session svelte-ifobs9"><p class="instructions svelte-ifobs9">Connect your Polar H10 heart rate monitor to begin tracking your heart rate variability
				(HRV). This will help calculate your Vibe Score and track your physiological balance.</p> <!> <button class="start-button svelte-ifobs9">Connect to Polar H10</button> <!></div>`),$c=wl('<div class="session-active svelte-ifobs9"><div class="status-bar svelte-ifobs9"><div class="connection-status svelte-ifobs9"><span></span> <span class="svelte-ifobs9"> </span></div> <div class="session-timer svelte-ifobs9"> </div></div> <div class="session-container svelte-ifobs9"><div class="metrics-container svelte-ifobs9"><div class="metric svelte-ifobs9"><h3 class="svelte-ifobs9">Heart Rate</h3> <p class="value svelte-ifobs9"> <span class="unit svelte-ifobs9">BPM</span></p></div> <div class="metric svelte-ifobs9"><h3 class="svelte-ifobs9">Balance</h3> <p class="value svelte-ifobs9"> <span class="unit svelte-ifobs9">ms</span></p></div> <div class="metric svelte-ifobs9"><h3 class="svelte-ifobs9">Vibe Score</h3> <p class="value svelte-ifobs9"> </p></div></div> <div class="timer-container svelte-ifobs9"><p class="timer svelte-ifobs9"> </p></div> <div class="chart-section svelte-ifobs9"><h3 class="mb-2 text-xl font-semibold svelte-ifobs9">Real-time HRV Data</h3> <div class="chart-container svelte-ifobs9"></div></div> <div class="breathing-guide-section svelte-ifobs9"><h3 class="mb-4 text-xl font-semibold svelte-ifobs9">Breathing Guide</h3> <p class="mb-4 text-sm text-gray-600 svelte-ifobs9">Follow the circle - 6 breaths per minute</p> <div class="breathing-guide-container svelte-ifobs9"><div><div class="breathing-text svelte-ifobs9"> </div> <div class="breathing-timer svelte-ifobs9"> </div></div> <div class="breathing-wave svelte-ifobs9"></div></div></div> <div class="button-container svelte-ifobs9"><button class="stop-button svelte-ifobs9">Stop Session</button></div></div></div>'),Kc=wl('<div class="error-message svelte-ifobs9"> </div>'),qc=wl('<div class="modal-overlay svelte-ifobs9"><div class="summary-modal svelte-ifobs9"><h2 class="svelte-ifobs9">Session Summary</h2> <div class="summary-stats svelte-ifobs9"><div class="summary-stat svelte-ifobs9"><span class="stat-label svelte-ifobs9">Duration</span> <span class="stat-value svelte-ifobs9"> </span></div> <div class="summary-stat svelte-ifobs9"><span class="stat-label svelte-ifobs9">Avg Heart Rate</span> <span class="stat-value svelte-ifobs9"> </span></div> <div class="summary-stat svelte-ifobs9"><span class="stat-label svelte-ifobs9">Avg Balance (RMSSD)</span> <span class="stat-value svelte-ifobs9"> </span></div> <div class="summary-stat svelte-ifobs9"><span class="stat-label svelte-ifobs9">Vibe Score</span> <span class="stat-value svelte-ifobs9"> </span></div></div> <!> <div class="summary-actions svelte-ifobs9"><button class="save-button svelte-ifobs9"><!></button> <button class="discard-button svelte-ifobs9">Discard Session</button></div></div></div>'),jc=wl('<div class="hrv-session-container svelte-ifobs9"><h1 class="svelte-ifobs9">HRV Session</h1> <!> <!></div>');function uu(e,l){Pr(l,!1);const[i,n]=Fr(),o=()=>_n(An,"$hrvData",i),c=()=>_n(Il,"$sessionTimer",i),u=()=>_n(Nr,"$authStore",i),h=()=>_n(qt,"$bleConnectionStatus",i);let p=$t(),d=null,_=$t("inhale"),g=$t(0),v=null,P=$t(!1),R=$t(!1),M=$t(null),O=$t(null),U=$t(null),b=$t(!1),I=$t(!1);function x(){if(!ne(p))return console.error("Chart element not found"),null;console.log("Initializing chart with element:",ne(p));const z={width:ne(p).clientWidth,height:300,padding:[0,0,0,0],cursor:{show:!0,points:{show:!0,size:5},drag:{setScale:!1},focus:{prox:30}},legend:{show:!1},series:[{},{scale:"hr",label:"Heart Rate",value:(Y,C)=>C==null?"-":C.toFixed(0)+" bpm",stroke:"#E53935",width:3,points:{show:!1},spanGaps:!0},{scale:"rmssd",label:"Balance",value:(Y,C)=>C==null?"-":C.toFixed(1)+" ms",stroke:"#4D44B3",width:3,points:{show:!1},spanGaps:!0},{scale:"vibe",label:"Vibe Score",value:(Y,C)=>C==null?"-":C.toFixed(0),stroke:"#BF469A",width:3,points:{show:!1},spanGaps:!0}],scales:{x:{time:!0},hr:{auto:!0,range:[40,180]},rmssd:{auto:!0,range:[0,100]},vibe:{auto:!0,range:[0,100]}},axes:[{scale:"x",label:"Time",labelSize:20,grid:{show:!1},ticks:{show:!0},values:(Y,C)=>C.map(T=>new Date(T*1e3).toLocaleTimeString())}]};try{console.log("Creating uPlot instance with options:",z),d=new Xe(z,[[],[],[],[]],ne(p)),console.log("Chart created successfully:",d)}catch(Y){return console.error("Error creating chart:",Y),null}const F=new ResizeObserver(Y=>{d&&Y[0]&&d.setSize({width:Y[0].contentRect.width,height:300})});return F.observe(ne(p)),()=>{d&&(d.destroy(),d=null),F.disconnect()}}function X(){if(!d)if(console.warn("Cannot update chart: chart instance is null"),ne(p)&&!d){if(console.log("Attempting to reinitialize chart..."),x(),!d)return}else return;const z=o().chartData;if(z.length===0){console.log("No chart data available yet");return}console.log("Updating chart with data points:",z.length);const F=z.map(le=>new Date(le.timestamp).getTime()/1e3),Y=z.map(le=>le.hr),C=z.map(le=>le.rmssd),T=z.map(le=>le.vibe);try{d.setData([F,Y,C,T]),console.log("Chart updated successfully")}catch(le){console.error("Error updating chart:",le)}}function L(){let C="inhale",T=0,le=Date.now();v=setInterval(()=>{const ye=Date.now(),te=ye-le;le=ye,C==="inhale"?(T+=te/5e3*100,T>=100&&(T=0,C="exhale")):(T+=te/5e3*100,T>=100&&(T=0,C="inhale")),He(_,C),He(g,T)},50)}function ee(){v&&(clearInterval(v),v=null)}async function J(){var z;if(He(O,null),!gs()){He(O,"Bluetooth is not supported on this device. Please use a device with Bluetooth support.");return}try{const F=await Wr();F.success?(c().isRunning||ho(),L(),vs(),He(P,!0)):He(O,((z=F.error)==null?void 0:z.message)||"Failed to connect to device.")}catch(F){console.error("Error starting session:",F),He(O,F instanceof Error?F.message:"An unknown error occurred.")}}function oe(){Ps(),ee(),He(M,Kr()),He(R,!0)}async function q(){if(!(!u().user||!ne(M))){He(b,!0),He(U,null);try{const z={timestamp:new Date().toISOString(),start:ne(M).startTime,end:ne(M).endTime,duration_seconds:ne(M).durationSeconds,avg_hr:ne(M).avgHR,avg_rmssd:ne(M).avgRMSSD,vibe_score:ne(M).avgVibe,chart_data:ne(M).chartData,rr_intervals:ne(M).rrIntervals};(await Or(u().user,z)).success?(He(I,!0),setTimeout(()=>{Ei("/home")},2e3)):He(U,"Failed to save HRV session. Please try again.")}catch(z){console.error("Error saving HRV session:",z),He(U,"An unexpected error occurred. Please try again.")}finally{He(b,!1)}}}function E(){vs(),He(P,!1),He(R,!1),He(M,null),as(),Ei("/home")}function Z(z){const F=Math.floor(z/60),Y=z%60;return`${F}:${Y.toString().padStart(2,"0")}`}Ir(()=>{const z=x();return()=>{z==null||z(),ee(),as()}}),Br(()=>{v&&clearInterval(v),as()}),Rr(()=>o(),()=>{o().chartData.length>0&&(console.log("HRV data updated, chart data points:",o().chartData.length),X())}),Lr(),zr();var H=jc(),K=me(se(H),2);{var G=z=>{var F=Yc(),Y=me(se(F),2);{var C=te=>{var Q=Wc(),Ye=se(Q,!0);ie(Q),vn(()=>ft(Ye,ne(O))),Yt(te,Q)};hl(Y,te=>{ne(O)&&te(C)})}var T=me(Y,2),le=me(T,2);{var ye=te=>{var Q=Uc();Yt(te,Q)};hl(le,te=>{gs()||te(ye)})}ie(F),wn("click",T,J),Yt(z,F)},re=z=>{var F=$c(),Y=se(F),C=se(Y),T=se(C);let le;var ye=me(T,2),te=se(ye,!0);ie(ye),ie(C);var Q=me(C,2),Ye=se(Q,!0);ie(Q),ie(Y);var Le=me(Y,2),ve=se(Le),Je=se(ve),et=me(se(Je),2),$e=se(et);rs(),ie(et),ie(Je);var at=me(Je,2),St=me(se(at),2),It=se(St);rs(),ie(St),ie(at);var Mt=me(at,2),ht=me(se(Mt),2),At=se(ht,!0);ie(ht),ie(Mt),ie(ve);var Re=me(ve,2),Pt=se(Re),ct=se(Pt,!0);ie(Pt),ie(Re);var ke=me(Re,2),W=me(se(ke),2);Hr(W,nt=>He(p,nt),()=>ne(p)),ie(ke);var D=me(ke,2),he=me(se(D),4),pe=se(he);let pt;var Rt=se(pe),bt=se(Rt,!0);ie(Rt);var Bt=me(Rt,2),tt=se(Bt,!0);ie(Bt),ie(pe),rs(2),ie(he),ie(D);var lt=me(D,2),Ze=se(lt);ie(lt),ie(Le),ie(F),vn((nt,$l,Sl,Xt,jt)=>{le=xi(T,1,"status-indicator svelte-ifobs9",null,le,nt),ft(te,h().connected?`Connected to ${h().deviceName}`:"Disconnected"),ft(Ye,$l),ft($e,`${o().heartRate??""} `),ft(It,`${Sl??""} `),ft(At,o().vibeScore),ft(ct,Xt),pt=xi(pe,1,"breathing-circle svelte-ifobs9",null,pt,jt),Gr(pe,`transform: scale(${ne(_)==="inhale"?1+ne(g)/100*.5:1.5-ne(g)/100*.5})`),ft(bt,ne(_)==="inhale"?"Breathe In":"Breathe Out"),ft(tt,ne(_)==="inhale"?"5s in":"5s out")},[()=>({connected:h().connected}),()=>Z(c().elapsedSeconds),()=>o().rmssd.toFixed(1),()=>Z(c().elapsedSeconds),()=>({inhale:ne(_)==="inhale",exhale:ne(_)==="exhale"})],yi),wn("click",Ze,oe),Yt(z,F)};hl(K,z=>{ne(P)?z(re,!1):z(G)})}var B=me(K,2);{var je=z=>{var F=qc(),Y=se(F),C=me(se(Y),2),T=se(C),le=me(se(T),2),ye=se(le,!0);ie(le),ie(T);var te=me(T,2),Q=me(se(te),2),Ye=se(Q);ie(Q),ie(te);var Le=me(te,2),ve=me(se(Le),2),Je=se(ve);ie(ve),ie(Le);var et=me(Le,2),$e=me(se(et),2),at=se($e,!0);ie($e),ie(et),ie(C);var St=me(C,2);{var It=ke=>{var W=Kc(),D=se(W,!0);ie(W),vn(()=>ft(D,ne(U))),Yt(ke,W)};hl(St,ke=>{ne(U)&&ke(It)})}var Mt=me(St,2),ht=se(Mt),At=se(ht);{var Re=ke=>{var W=os("Saving...");Yt(ke,W)},Pt=(ke,W)=>{{var D=pe=>{var pt=os("Saved!");Yt(pe,pt)},he=pe=>{var pt=os("Save Session");Yt(pe,pt)};hl(ke,pe=>{ne(I)?pe(D):pe(he,!1)},W)}};hl(At,ke=>{ne(b)?ke(Re):ke(Pt,!1)})}ie(ht);var ct=me(ht,2);ie(Mt),ie(Y),ie(F),vn((ke,W)=>{ft(ye,ke),ft(Ye,`${ne(M).avgHR??""} bpm`),ft(Je,`${W??""} ms`),ft(at,ne(M).avgVibe),ht.disabled=ne(b)||ne(I),ct.disabled=ne(b)||ne(I)},[()=>Z(ne(M).durationSeconds),()=>ne(M).avgRMSSD.toFixed(1)],yi),wn("click",ht,q),wn("click",ct,E),Yt(z,F)};hl(B,z=>{ne(R)&&ne(M)&&z(je)})}ie(H),Yt(e,H),Cr(),n()}export{uu as component};
